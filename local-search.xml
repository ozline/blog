<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>CMU-15-418 Assignment1 - Performance Analysis on a Quad-Core CPU</title>
    <link href="/f92dfd8d9bc2/"/>
    <url>/f92dfd8d9bc2/</url>
    
    <content type="html"><![CDATA[<h1>Assignment 1 - Performance Analysis on a Quad-Core CPU</h1><p>我学习的是<a href="https://www.cs.cmu.edu/afs/cs/academic/class/15418-s22/www/index.html">Spring 2022</a>的版本，作业仓库<a href="https://github.com/cmu15418s22/Assignment-1">在这里</a>，下文是我的作业报告。</p><p>这个课程的作业感觉都蛮硬核的，然而网上并没有标准答案，我的这份答案也仅供参考</p><h2 id="Problem-1-Parallel-Fractal-Generation-Using-Threads">Problem 1 - Parallel Fractal Generation Using Threads</h2><ol><li class="lvl-3"><p>修改<code>mandelbrot.cpp</code>中的代码以实现并行计算</p></li><li class="lvl-3"><p>修改<code>workerThreadStart</code>的代码以实现</p></li><li class="lvl-3"><p>研究针对不同图像的每个线程耗时，并解释原因</p></li><li class="lvl-3"><p>实现一个8x的并行程序</p></li></ol><h3 id="Q-A">Q&amp;A</h3><blockquote><p>Is speedup linear in the number of cores used? In your writeup hypothesize why this is (or is not) the case?</p></blockquote><p>我们针对<code>view1</code>进行测试</p><table><thead><tr><th style="text-align:center">线程</th><th style="text-align:center">耗时 /ms</th><th style="text-align:center">加速比</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">74.321</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">37.048</td><td style="text-align:center">2.01</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">24.824</td><td style="text-align:center">2.99</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">18.942</td><td style="text-align:center">3.92</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">16.844</td><td style="text-align:center">4.41</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">14.119</td><td style="text-align:center">5.26</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">12.197</td><td style="text-align:center">6.093</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">10.648</td><td style="text-align:center">6.979</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">17.736</td><td style="text-align:center">4.19</td></tr></tbody></table><p>这不是线性的，随着线程数增加，加速比增长速度逐渐下降。一直到9线程（本机CPU是8线程）时加速比降低。</p><p>按照理论，如果是线性关系，那么到达8线程的时候应该加速比接近8。考虑到我的本机CPU只有4核心，我不认为在5线程后每个线程性能是一致的。因此我们可以观察4线程时，可以注意到加速比为3.92，是比较接近4x加速的。</p><p>我个人认为，在5-8线程中，加速比增速下降的主要原因是cpu调度，cpu任务分配的耗时占了大头。</p><p>查阅了一些资料，是因为intel的超线程技术中，单线程性能不及一般线程，这也就解释了为什么5-8线程的时候加速比增速下滑了。</p><blockquote><p>To confirm (or disprove) your hypothesis, measure the amount of time each thread requires to complete its work by inserting timing code at the beginning and end of workerThreadStart(). How do your measurements explain the speedup graph you previously created?</p></blockquote><p>在这个问题中，我给每个核心都开了性能模式，因此速度会快一点</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">❯ ./mandelbrot --view 1 --threads 4<br>[mandelbrot serial]:            [71.300] ms<br>Wrote image file mandelbrot-v1-serial.ppm<br>[thread 3]: [18.512] ms<br>[thread 2]: [18.527] ms<br>[thread 1]: [18.593] ms<br>[thread 0]: [18.725] ms<br>[thread 2]: [18.523] ms<br>[thread 1]: [18.584] ms<br>[thread 3]: [18.573] ms<br>[thread 0]: [18.591] ms<br>[thread 3]: [18.553] ms<br>[thread 2]: [18.577] ms<br>[thread 1]: [18.655] ms<br>[thread 0]: [18.670] ms<br>[mandelbrot thread]:            [18.669] ms<br>Wrote image file mandelbrot-v1-thread-4.ppm<br>++++                            (3.82x speedup from 4 threads)<br><br>❯ ./mandelbrot --view 2 --threads 4<br>[mandelbrot serial]:            [42.205] ms<br>Wrote image file mandelbrot-v2-serial.ppm<br>[thread 3]: [11.019] ms<br>[thread 2]: [11.066] ms<br>[thread 0]: [11.096] ms<br>[thread 1]: [11.224] ms<br>[thread 2]: [11.047] ms<br>[thread 3]: [11.029] ms<br>[thread 1]: [11.075] ms<br>[thread 0]: [11.124] ms<br>[thread 1]: [11.076] ms<br>[thread 2]: [11.236] ms<br>[thread 3]: [12.659] ms<br>[thread 0]: [12.844] ms<br>[mandelbrot thread]:            [11.173] ms<br>Wrote image file mandelbrot-v2-thread-4.ppm<br>++++                            (3.78x speedup from 4 threads)<br></code></pre></td></tr></table></figure><p>其实不明白为何验证非线性结论要求我计算每个线程的耗时</p><p>但是我发现了一个新问题：我开了4 threads,但是无论怎么改都有12个输出</p><p>后面改了不同的线程，1threads有3个输出，2就有6个，3就有9个，神奇啊（大雾）</p><blockquote><p>Modify the mapping of work to threads to improve speedup to 8× on view 0 and almost 8× on views 1 and 2. In your writeup, describe your approach and report the final 16-thread 3 speedup obtained. Also comment on the difference in scaling behavior from 4 to 8 threads versus 8 to 16 threads.</p></blockquote><p>就是让我们改程序，以让它可以实现8x速度，但是cmu的高端电脑似乎是8核心16线程的，我的老破小是4核心8线程的，应该只要实现4x速度吧（大雾）</p><p>但是似乎已经改不到更快了，3.92x已经是极限了（悲）</p><h3 id="Code">Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// Line 109-128</span><br><span class="hljs-function"><span class="hljs-type">void</span> *<span class="hljs-title">workerThreadStart</span><span class="hljs-params">(<span class="hljs-type">void</span> *threadArgs)</span> </span>&#123;<br>    WorkerArgs *args = <span class="hljs-built_in">static_cast</span>&lt;WorkerArgs *&gt;(threadArgs);<br><br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Implement worker thread here.</span><br>    <span class="hljs-type">int</span> threadNumRows = args-&gt;height / args-&gt;numThreads;<br>    <span class="hljs-keyword">if</span>(args-&gt;height % args-&gt;numThreads != <span class="hljs-number">0</span>) &#123;<br>        threadNumRows++;<br>    &#125;<br>    <span class="hljs-comment">// int threadStartRow = args-&gt;threadId * threadNumRows;</span><br>    <span class="hljs-comment">// int threadTotalRows = threadNumRows;</span><br><br>    <span class="hljs-comment">// mandelbrotSerial(args-&gt;x0, args-&gt;y0, args-&gt;x1, args-&gt;y1, args-&gt;width, args-&gt;height, threadStartRow, threadTotalRows, args-&gt;maxIterations, args-&gt;output);</span><br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; threadNumRows; i++) &#123;<br>        <span class="hljs-type">int</span> threadStartRow = i * args-&gt;numThreads + args-&gt;threadId;<br>        <span class="hljs-keyword">if</span>(threadStartRow &lt; args-&gt;height) &#123;<br>            <span class="hljs-built_in">mandelbrotSerial</span> (args-&gt;x0, args-&gt;y0, args-&gt;x1, args-&gt;y1, args-&gt;width, args-&gt;height, threadStartRow, <span class="hljs-number">1</span>, args-&gt;maxIterations, args-&gt;output);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>&#125;<br><br><span class="hljs-comment">// Line 147 - 159</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; numThreads; i++) &#123;<br>    args[i].threadId = i;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Set thread arguments here</span><br>    args[i].x0 = x0, args[i].y0 = y0;<br>    args[i].x1 = x1, args[i].y1 = y1;<br>    args[i].width = width;<br>    args[i].height = height;<br>    args[i].maxIterations = maxIterations;<br>    args[i].output = output;<br>    args[i].numThreads = numThreads;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Problem-2-Vectorizing-Code-Using-SIMD-Intrinsics">Problem 2 - Vectorizing Code Using SIMD Intrinsics</h2><ol><li class="lvl-3"><p>修改<code>functions.cpp</code>中的<code>clampedExpVector()</code>以实现并行快速幂</p></li><li class="lvl-3"><p>修改<code>functions.cpp</code>中的<code>arraySumVector()</code>以实现并行数组求和</p></li></ol><h3 id="Q-A-2">Q&amp;A</h3><blockquote><p>How much does the vector utilization change as W changes? Explain the reason for these changes and the degree of sensitivity the uti-lization has on the vector width. Explain how the total number of vector instructions varies with W .</p></blockquote><p>我们运行参数为<code>./vrun -s 10000</code></p><table><thead><tr><th>Vector Width</th><th>Vector Utilization</th><th>Total Vector Instructions</th></tr></thead><tbody><tr><td>2</td><td>92.980082%</td><td>383929</td></tr><tr><td>4</td><td>92.812667%</td><td>196495</td></tr><tr><td>8</td><td>92.777550%</td><td>98739</td></tr><tr><td>16</td><td>92.776768%</td><td>49378</td></tr><tr><td>32</td><td>92.778057%</td><td>24651</td></tr></tbody></table><p>我们可以发现的，在误差范围内，当向量宽度逐渐变大时，我们向量利用率是逐步下降的，但是下降速率逐渐降低</p><p>利用率下降的主要原因应该是，代码中我对余数部分的数组线性处理，而当宽度变大时，线性处理的部分也会增加</p><h3 id="Code-2">Code</h3><p>我一开始是直接把上面的快速幂改成向量的，只处理了除不尽的情况，然后当s 为奇数的时候会Fail</p><p>后面忘记看了什么资料发现别人的代码中是移走if(result &gt; 4.18f)的代码到while结束，手动改了一下就过了</p><p>2023-03-31：重新回顾了一下这个代码，发现我们不需要线性处理，我们只需要设置一下掩码即可，修改后效率可以达到<code>94.207317%</code>，提升2%</p><p>下面这份是修改后的代码，修改前的话则是对余数部分线性处理</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">clampedExpVector</span><span class="hljs-params">(<span class="hljs-type">float</span> *values, <span class="hljs-type">int</span> *exponents, <span class="hljs-type">float</span> *output, <span class="hljs-type">int</span> N)</span> </span>&#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Implement your vectorized version of clampedExpSerial here</span><br>    __cmu418_vec_float x, result, xpower;<br>    __cmu418_vec_int y, tmp_y; <span class="hljs-comment">// tmp_y stores y &amp; 0x1</span><br><br>    __cmu418_vec_float exp = _cmu418_vset_float(<span class="hljs-number">4.18f</span>);<br>    __cmu418_vec_int zero = _cmu418_vset_int(<span class="hljs-number">0</span>);<br>    __cmu418_vec_int one = _cmu418_vset_int(<span class="hljs-number">1</span>);<br><br>    __cmu418_mask maskAll, maskIsNegative, maskIsNotNegative, maskResultIsClamped;<br><br>    <span class="hljs-type">int</span> cnt = N % VECTOR_WIDTH;<br>    <span class="hljs-comment">// if(cnt) clampedExpSerial(values, exponents, output, cnt); // Serial Solve</span><br><br>    <span class="hljs-comment">// Vector Solve</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i += VECTOR_WIDTH) &#123;<br>        maskAll = (i == <span class="hljs-number">0</span> &amp;&amp; cnt) ? _cmu418_init_ones(cnt) : _cmu418_init_ones();<br>        maskIsNegative = _cmu418_init_ones(<span class="hljs-number">0</span>);<br><br>        _cmu418_vload_float(x, values + i, maskAll);                    <span class="hljs-comment">// x = values[i];</span><br>        _cmu418_vset_float(result, <span class="hljs-number">1.f</span>, maskAll);                       <span class="hljs-comment">// result = 1.f;</span><br>        _cmu418_vload_int(y, exponents + i, maskAll);                   <span class="hljs-comment">// y = exponents[i];</span><br>        _cmu418_vmove_float(xpower, x, maskAll);                        <span class="hljs-comment">// xpower = x;</span><br><br>        <span class="hljs-keyword">while</span>(_cmu418_vgt_int(maskIsNegative, y, zero, maskAll), _cmu418_cntbits(maskIsNegative)) <span class="hljs-comment">// while(y &gt; 0)</span><br>        &#123;<br>            _cmu418_vbitand_int(tmp_y, y, one, maskAll);                        <span class="hljs-comment">// tmp_y = y &amp; 0x1</span><br>            _cmu418_vgt_int(maskIsNegative, tmp_y, zero, maskAll);              <span class="hljs-comment">// if(tmp_y) &#123;</span><br>            _cmu418_vmult_float(result, result, xpower, maskIsNegative);        <span class="hljs-comment">//  result *= xpower</span><br>                                                                                <span class="hljs-comment">// &#125;</span><br>            _cmu418_vmult_float(xpower, xpower, xpower, maskAll);               <span class="hljs-comment">// xpower *= xpower</span><br>            _cmu418_vshiftright_int(y, y, one, maskAll);                        <span class="hljs-comment">// y &gt;&gt;= 1</span><br>        &#125;<br><br>        _cmu418_vgt_float(maskResultIsClamped, result, exp, maskAll);   <span class="hljs-comment">//  if(result &gt; 4.18f) &#123;</span><br>        _cmu418_vmove_float(result, exp, maskResultIsClamped);          <span class="hljs-comment">//      result = 4.18f</span><br>                                                                        <span class="hljs-comment">//  &#125;</span><br>        _cmu418_vstore_float(output + i, result, maskAll);              <span class="hljs-comment">// output[i] = result</span><br><br>        <span class="hljs-keyword">if</span>(i == <span class="hljs-number">0</span> &amp;&amp; cnt) i -= VECTOR_WIDTH;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>这里有个未解之谜，关于Bonus的</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">float</span> <span class="hljs-title">arraySumVector</span><span class="hljs-params">(<span class="hljs-type">float</span> *values, <span class="hljs-type">int</span> N)</span> </span>&#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Implement your vectorized version here</span><br><br>    __cmu418_vec_float x, result;<br>    __cmu418_vec_float zero = _cmu418_vset_float(<span class="hljs-number">0.f</span>);<br>    __cmu418_mask maskAll, maskIsNegative, maskIsNotNegative;<br><br>    <span class="hljs-type">float</span> sum[VECTOR_WIDTH];<br>    <span class="hljs-type">float</span> ans = <span class="hljs-number">0.f</span>;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; VECTOR_WIDTH; i++)<br>    &#123;<br>        sum[i] = <span class="hljs-number">0.f</span>;<br>        <span class="hljs-comment">// printf(&quot;sum[%d] = %f\n&quot;, i, sum[i]);</span><br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i += VECTOR_WIDTH)<br>    &#123;<br>        maskAll = _cmu418_init_ones();<br>        maskIsNegative = _cmu418_init_ones(<span class="hljs-number">0</span>);<br><br>        _cmu418_vload_float(x, values + i, maskAll);                        <span class="hljs-comment">// x = values[i];</span><br>        _cmu418_vadd_float(result, result, x, maskAll);                     <span class="hljs-comment">// result += x;</span><br>        _cmu418_vstore_float(sum + (i % VECTOR_WIDTH), result, maskAll);    <span class="hljs-comment">// sum[i] = result;</span><br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; VECTOR_WIDTH; i++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;sum[%d] = %f\n&quot;</span>, i, sum[i]), ans += sum[i];<br><br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br></code></pre></td></tr></table></figure><p>这是我的这份代码，可以注意到我有一个printf的输出，当我注释掉输出时，会输出如下</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">ARRAY <span class="hljs-title">SUM</span> <span class="hljs-params">(bonus)</span></span><br><span class="hljs-function">sum[0] </span>= <span class="hljs-number">-1.010000</span><br>sum[<span class="hljs-number">1</span>] = <span class="hljs-number">-1.007556</span><br>sum[<span class="hljs-number">2</span>] = <span class="hljs-number">-1.005328</span><br>sum[<span class="hljs-number">3</span>] = <span class="hljs-number">-1.000470</span><br>sum[<span class="hljs-number">4</span>] = <span class="hljs-number">-1.006793</span><br>sum[<span class="hljs-number">5</span>] = <span class="hljs-number">-1.003835</span><br>sum[<span class="hljs-number">6</span>] = <span class="hljs-number">-256138150223410355193484371034112.000000</span><br>sum[<span class="hljs-number">7</span>] = <span class="hljs-number">-1.000535</span><br>Expected <span class="hljs-number">-8.032826</span>, got <span class="hljs-number">-256138150223410355193484371034112.000000</span><br>.@@@ Failed!!!<br></code></pre></td></tr></table></figure><p>当我没有注释输出时，会输出如下</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">ARRAY <span class="hljs-title">SUM</span> <span class="hljs-params">(bonus)</span></span><br><span class="hljs-function">sum[0] </span>= <span class="hljs-number">0.000000</span><br>sum[<span class="hljs-number">1</span>] = <span class="hljs-number">0.000000</span><br>sum[<span class="hljs-number">2</span>] = <span class="hljs-number">0.000000</span><br>sum[<span class="hljs-number">3</span>] = <span class="hljs-number">0.000000</span><br>sum[<span class="hljs-number">4</span>] = <span class="hljs-number">0.000000</span><br>sum[<span class="hljs-number">5</span>] = <span class="hljs-number">0.000000</span><br>sum[<span class="hljs-number">6</span>] = <span class="hljs-number">0.000000</span><br>sum[<span class="hljs-number">7</span>] = <span class="hljs-number">0.000000</span><br>sum[<span class="hljs-number">0</span>] = <span class="hljs-number">-1.000000</span><br>sum[<span class="hljs-number">1</span>] = <span class="hljs-number">-1.007556</span><br>sum[<span class="hljs-number">2</span>] = <span class="hljs-number">-1.015328</span><br>sum[<span class="hljs-number">3</span>] = <span class="hljs-number">-1.000470</span><br>sum[<span class="hljs-number">4</span>] = <span class="hljs-number">-1.006793</span><br>sum[<span class="hljs-number">5</span>] = <span class="hljs-number">-1.003835</span><br>sum[<span class="hljs-number">6</span>] = <span class="hljs-number">-1.008310</span><br>sum[<span class="hljs-number">7</span>] = <span class="hljs-number">-1.000535</span><br>Expected <span class="hljs-number">-8.032826</span>, got <span class="hljs-number">-8.042827</span><br>.@@@ Failed!!!<br></code></pre></td></tr></table></figure><p>？？？多一个printf会有这么大的影响嘛，不过最终答案的确也是错的，不知道发生了什么。太玄学了！</p><p>看了一下<code>CMU418intrin.h</code>，我们肯定是要用上<code>_cmu418_hadd_float()</code>和<code>_cmu418_interleave_float()</code>的，因为这两个很突兀。第一个是实现[0 1 2 3] -&gt; [0+1 0+1 2+3 2+3]，不好描述，就是按pair相加，第二个是实现把一个数组的奇数下标移到前半部分，偶数下标移动到后半部分</p><p>很明显嘛，就是循环使用这两个函数，类似二分，每次都会折半，题目中说了VECTOR_WIDTH是2的倍数，那么我们可以按位处理。</p><p>然后同时还发现了这行代码<code>template &lt;typename T&gt; struct __cmu418_vec &#123; T value[VECTOR_WIDTH]; &#125;;</code>，原来可以直接输出向量的某一个下标</p><p>那就好办了，不需要sum了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">float</span> <span class="hljs-title">arraySumVector</span><span class="hljs-params">(<span class="hljs-type">float</span> *values, <span class="hljs-type">int</span> N)</span> </span>&#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Implement your vectorized version here</span><br><br>    __cmu418_vec_float x, result = _cmu418_vset_float(<span class="hljs-number">0.f</span>);<br>    __cmu418_mask maskAll = _cmu418_init_ones();<br>    <span class="hljs-type">int</span> cnt = VECTOR_WIDTH;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i += VECTOR_WIDTH)<br>    &#123;<br>        _cmu418_vload_float(x, values + i, maskAll);                        <span class="hljs-comment">// x = values[i];</span><br>        _cmu418_vadd_float(result, result, x, maskAll);                     <span class="hljs-comment">// result += x;</span><br>    &#125;<br><br>    <span class="hljs-keyword">while</span>(cnt &gt;&gt;= <span class="hljs-number">1</span>)<br>    &#123;<br>        _cmu418_hadd_float(result, result);<br>        _cmu418_interleave_float(result, result);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> result.value[<span class="hljs-number">0</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p>最终结果</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">❯ ./vrun -s 8<br>CLAMPED EXPONENT (required)<br>Results matched with answer!<br>****************** Printing Vector Unit Statistics *******************<br>Vector Width:              8<br>Total Vector Instructions: 82<br>Vector Utilization:        93.140244%<br>Utilized Vector Lanes:     611<br>Total Vector Lanes:        656<br>************************ Result Verification *************************<br>Passed!!!<br><br>ARRAY SUM (bonus)<br>Passed!!!<br></code></pre></td></tr></table></figure><h2 id="Problem-3-Using-Instruction-level-Parallelism-in-Fractal-Generation">Problem 3 - Using Instruction-level Parallelism in Fractal Generation</h2><ol><li class="lvl-3"><p>理解并注释<code>mandelbrot_ref_loop.s</code>中的代码</p></li></ol><h3 id="Q-A-3">Q&amp;A</h3><blockquote><p>An annotated  version of the assembly code for the main loop of mandel ref</p></blockquote><p>我们可以在这里查询汇编指令：<a href="https://www.felixcloutier.com/x86/index.html">x86 and amd64 instruction reference</a></p><p>我们可以在这里查询一些其他资料：<a href="https://zhuanlan.zhihu.com/p/566499032">并发原理 — CPU原子性指令（一）</a></p><p>那么其实就是查询汇编的答案了，但是还是有点不会。</p><p>要知道一些基本信息，例如x86-64的16个64位寄存器</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>%xmmi</td><td>128位寄存器，i为编号</td></tr><tr><td>%rip</td><td>指向下一条要执行的指令</td></tr><tr><td>%eax</td><td>accumulator, 加乘法指令缺省寄存器</td></tr><tr><td>%edi</td><td>destination indexm, 目标索引寄存器</td></tr></tbody></table><blockquote><p>An analysis of the latency bound of mandel ref and how the measured performance compares.</p></blockquote><p>主要是提交一份Mandel Ref的延迟分析</p><p>这份代码中我觉得比较多的是xmm寄存器的操作，查看Assignments的介绍中有提及：U0可以执行加乘除、U1可以执行加乘、U5可以做浮点加法，但是只能使用x87浮点指令。U0/U1有4个时钟周期，U5有3个时钟周期。</p><p>但是我没有在<a href="https://agner.org/optimize/microarchitecture.pdf">The microarchitecture of Intel and AMD CPUs</a>中对应页面找到解释（？）难道是更新了，似乎是在P155</p><p>这部分很薄弱，我的分析可能存在问题：</p><p>整个loop中涉及到了4次寄存器乘法，5次寄存器加法，还有2次jmp，latency至少是4 * 4 + 5 * 3 + 1 * 2 = 26时钟周期</p><blockquote><p>Considering the floating-point operations, what is the highest throughput bound imposed by the functional units?</p></blockquote><p>考虑浮点运算，功能单元所施加的最高吞吐量是多少</p><p>这个超纲了啊！！！</p><h3 id="Code-3">Code</h3><p>以下给出这份代码的注释版本，但是我感觉没有写好</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs assembly">        # This is the inner loop of mandel_ref<br>        # Parameters are passed to the function as follows:<br>        #   %xmm0: c_re<br>        #   %xmm1: c_im<br>        #   %edi:  count<br>        # Before entering the loop, the function sets registers<br># to initialize local variables:<br>        #   %xmm2: z_re = c_re<br>        #   %xmm3: z_im = c_im<br>        #   %eax:  i = 0<br>.L123:<br>        vmulss  %xmm2, %xmm2, %xmm4# xmm2 *= xmm4<br>        vmulss  %xmm3, %xmm3, %xmm5# xmm3 *= xmm5<br>        vaddss  %xmm5, %xmm4, %xmm6# xmm5 = xmm4 * xmm6<br>        vucomiss        .LC0(%rip), %xmm6# Compare xmm1 and xmm6 and set the EFLAGS flags accordingly.<br>        ja      .L126# if larger, jump to .L126<br>        vaddss  %xmm2, %xmm2, %xmm2# xmm2 += xmm2<br>        addl    $1, %eax# count++<br>        cmpl    %edi, %eax   # Set condition codes for jne below<br>        vmulss  %xmm3, %xmm2, %xmm3# xmm3 *= xmm2<br>        vsubss  %xmm5, %xmm4, %xmm2# xmm5 = xmm4 - xmm2<br>        vaddss  %xmm3, %xmm1, %xmm3# xmm3 += xmm1<br>        vaddss  %xmm2, %xmm0, %xmm2# xmm2 += xmm0<br>        jne     .L123<br></code></pre></td></tr></table></figure><h2 id="Problem-4-Parallel-Fractal-Generation-Using-ISPC">Problem 4 - Parallel Fractal Generation Using ISPC</h2><p>出了点小插曲，我的电脑中因为更新已经删除了<code>sys/sysctl.h</code>，不过似乎注释掉<code>common/tasksys.h</code>中的include就可以编译了，那导入这个库干嘛…</p><h3 id="Problem-4-Part-1-A-Few-ISPC-Basics">Problem 4, Part 1. A Few ISPC Basics</h3><ol><li class="lvl-3"><p>编译程序，并提出自己认为的理论值</p></li></ol><h4 id="Q-A-4">Q&amp;A</h4><blockquote><p>What is the maximum speedup you expect given what you know about these CPUs? Why might the number you observe be less than this ideal?</p></blockquote><p>首先，既然是 8-wide AVX vector instructions，那理论加速比应当为8x，但是实际上我跑的理论加速比只有4.48x</p><p>我认为没有达到实际加速比是因为调度问题，毕竟不可能直接到8x，但是4.48x的差距还是太大了，说明不止是调度问题</p><p>查阅了网上<s>的标准答案</s>他人的想法， 负载不均衡的问题可能是比较正确的，我们实际上跑的这个图不是均匀的，那么就会造成有的快有的慢。</p><h3 id="Problem-4-Part-2-Combining-instruction-level-and-SIMD-parallelism">Problem 4, Part 2. Combining instruction-level and SIMD parallelism</h3><h4 id="Q-A-5">Q&amp;A</h4><blockquote><p>How much speedup does this two-way parallelism give over the regular ISPC version? Does it vary across different inputs (i.e., different --views)? When is it worth the effort?</p></blockquote><p>这道题做崩了，反向加速了，但是可以注意到在视图不同的时候，反向加速效果也是不一样的，但是我感觉我的代码没有很大的问题，实在是不知道为啥反向加速了，难道是自己电脑CPU太古早了？</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">❯ ./mandelbrot_ispc -v 1<br>[mandelbrot serial]:            [183.684] ms<br>Wrote image file mandelbrot-1-serial.ppm<br>[mandelbrot ispc]:              [44.045] ms<br>Wrote image file mandelbrot-1-ispc.ppm<br>[mandelbrot ispc parallel]:             [66.698] ms<br>Wrote image file mandelbrot-1-ispc-par.ppm<br>                                (4.17x speedup from ISPC)<br>                                (2.75x speedup from ISPC+parallelism)<br>❯ ./mandelbrot_ispc -v 2<br>[mandelbrot serial]:            [107.956] ms<br>Wrote image file mandelbrot-2-serial.ppm<br>[mandelbrot ispc]:              [30.914] ms<br>Wrote image file mandelbrot-2-ispc.ppm<br>[mandelbrot ispc parallel]:             [43.129] ms<br>Wrote image file mandelbrot-2-ispc-par.ppm<br>                                (3.49x speedup from ISPC)<br>                                (2.50x speedup from ISPC+parallelism)<br>❯ ./mandelbrot_ispc -v 3<br>[mandelbrot serial]:            [260.036] ms<br>Wrote image file mandelbrot-3-serial.ppm<br>[mandelbrot ispc]:              [65.158] ms<br>Wrote image file mandelbrot-3-ispc.ppm<br>[mandelbrot ispc parallel]:             [89.083] ms<br>Wrote image file mandelbrot-3-ispc-par.ppm<br>                                (3.99x speedup from ISPC)<br>                                (2.92x speedup from ISPC+parallelism)<br>❯ ./mandelbrot_ispc -v 4<br>[mandelbrot serial]:            [257.352] ms<br>Wrote image file mandelbrot-4-serial.ppm<br>[mandelbrot ispc]:              [64.656] ms<br>Wrote image file mandelbrot-4-ispc.ppm<br>[mandelbrot ispc parallel]:             [88.640] ms<br>Wrote image file mandelbrot-4-ispc-par.ppm<br>                                (3.98x speedup from ISPC)<br>                                (2.90x speedup from ISPC+parallelism)<br></code></pre></td></tr></table></figure><h4 id="Code-4">Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">export</span> <span class="hljs-type">void</span> <span class="hljs-title">mandelbrot_ispc_par2</span><span class="hljs-params">(uniform <span class="hljs-type">float</span> x0, uniform <span class="hljs-type">float</span> y0,</span></span><br><span class="hljs-params"><span class="hljs-function">                                 uniform <span class="hljs-type">float</span> x1, uniform <span class="hljs-type">float</span> y1,</span></span><br><span class="hljs-params"><span class="hljs-function">                                 uniform <span class="hljs-type">int</span> width, uniform <span class="hljs-type">int</span> height,</span></span><br><span class="hljs-params"><span class="hljs-function">                                 uniform <span class="hljs-type">int</span> maxIterations,</span></span><br><span class="hljs-params"><span class="hljs-function">                                 uniform <span class="hljs-type">int</span> output[])</span> </span>&#123;<br>    uniform <span class="hljs-type">float</span> dx = (x1 - x0) / width;<br>    uniform <span class="hljs-type">float</span> dy = (y1 - y0) / height;<br><br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Write ISPC code that will use function mandel_par2 to process</span><br>    <span class="hljs-comment">// two rows on each pass.</span><br>    <span class="hljs-comment">// You should use the foreach construct.</span><br>    <span class="hljs-comment">// You should handle the case where the height is not a multiple</span><br>    <span class="hljs-comment">// of 2.</span><br><br>    uniform <span class="hljs-type">int</span> numRowsPerPass = (height + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;<br><br>    foreach (i = <span class="hljs-number">0</span> ... numRowsPerPass, j = <span class="hljs-number">0</span> ... width) &#123;<br>        <span class="hljs-type">int</span> row0 = i * <span class="hljs-number">2</span>;<br>        <span class="hljs-type">int</span> row1 = <span class="hljs-built_in">min</span>(row0 + <span class="hljs-number">1</span>, height - <span class="hljs-number">1</span>);<br><br>        <span class="hljs-type">float</span> c_re0 = x0 + j * dx;<br>        <span class="hljs-type">float</span> c_im0 = y0 + row0 * dy;<br>        <span class="hljs-type">float</span> c_re1 = x0 + j * dx;<br>        <span class="hljs-type">float</span> c_im1 = y0 + row1 * dy;<br><br>        <span class="hljs-built_in">mandel_par2</span>(c_re0, c_im0, c_re1, c_im1, maxIterations, output + row0 * width + j, output + row1 * width + j);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Problem-4-Part-3-ISPC-Tasks">Problem 4, Part 3: ISPC Tasks</h3><ol><li class="lvl-3"><p>尝试不同的BLOCK大小与TASK数量，以超过20x加速</p></li></ol><p>最终是<code>20.99x</code>加速，参数是</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> BLOCK_WIDTH 400</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> BLOCK_HEIGHT 200</span><br>uniform <span class="hljs-type">int</span> taskCount = <span class="hljs-number">16</span>;<br></code></pre></td></tr></table></figure><p>不过这个20.99x也蛮极限的，可能原因是CPU是4核心8线程的，16task其实是有点高了</p><p>有一个问题是说</p><h2 id="Problem-5-Iterative-Cubic-Root">Problem 5 - Iterative Cubic Root</h2><ol><li class="lvl-3"><p>运行迭代立方根程序，看结果</p></li><li class="lvl-3"><p>修改<code>data.cpp</code>中的内容，调优</p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">❯ ./cuberoot<br>[cuberoot serial]:              [3658.882] ms<br>[cuberoot ispc]:                [884.804] ms<br>[cuberoot task ispc]:   [134.455] ms<br>                                (4.14x speedup from ISPC)<br>                                (27.21x speedup from task ISPC)<br></code></pre></td></tr></table></figure><h3 id="Q-A-6">Q&amp;A</h3><blockquote><p>Modify the function initGood/initBad() in the file data.cpp to generate data that will yield a very high relative speedup of the ISPC implementations.</p><p>Does your modification improve SIMD speedup? Does it improve multi-core speedup? Please explain why.</p></blockquote><p>我最多可以跑到40x左右的加速，这时候<code>value[i] = 1.9999999</code>，似乎可以无限逼近2</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">❯ ./cuberoot -d g<br>[cuberoot serial]:              [7345.921] ms<br>[cuberoot ispc]:                [1190.029] ms<br>[cuberoot task ispc]:   [178.646] ms<br>                                (6.17x speedup from ISPC)<br>                                (41.12x speedup from task ISPC)<br></code></pre></td></tr></table></figure><p>最慢可以达到2.3x的加速，这时候<code>value[i] = 1.0</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">[cuberoot serial]:              [80.059] ms<br>[cuberoot ispc]:                [43.914] ms<br>[cuberoot task ispc]:   [34.633] ms<br>                                (1.82x speedup from ISPC)<br>                                (2.31x speedup from task ISPC)<br></code></pre></td></tr></table></figure><p>实际上修改为1就可以实现最慢了，-1应该也可以，可以观察给的图形，在正负1.0处迭代最少，在无限逼近2的时候迭代次数徒增</p><p>要解释的话，我们可以说明ispc可以更好的处理数学计算？加速数学计算的过程吧。</p><p>这个问题5似乎比前面几个来的简单多啊。。这个看起来得放在第一问（）</p>]]></content>
    
    
    <categories>
      
      <category>超算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HPC</tag>
      
      <tag>cmu15418</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HPL本机性能调优分析</title>
    <link href="/e4edabdd2525/"/>
    <url>/e4edabdd2525/</url>
    
    <content type="html"><![CDATA[<h1>HPL性能调优</h1><h2 id="环境">环境</h2><p>Ubuntu22.04 插电状态</p><p>笔记本关闭显示,不进入休眠,注销用户,在其他电脑上利用ssh连接</p><p>RAM:16G DDR3</p><p>CPU: i7-4980HQ 2.8Ghz 核心数:4 线程数:8</p><h2 id="性能影响">性能影响</h2><ul class="lvl-0"><li class="lvl-2"><p>vscode-server的ssh远程编程进程可能会对性能有影响</p></li><li class="lvl-2"><p>ssh的连接会影响性能</p></li><li class="lvl-2"><p>实验过程中,开启NextSSH软件中的数据监看功能,实时监测cpu、内存、网络波动</p></li><li class="lvl-2"><p>实验时开启了Wi-Fi功能</p></li><li class="lvl-2"><p>内存</p></li><li class="lvl-2"><p>笔记本发热降频</p></li></ul><h2 id="参考">参考</h2><ul class="lvl-0"><li class="lvl-2"><p><a href="https://github.com/yunzhongOvO/Linpack-HPL">https://github.com/yunzhongOvO/Linpack-HPL</a></p></li><li class="lvl-2"><p><a href="https://www.intel.com/content/www/us/en/products/sku/83503/intel-core-i74980hq-processor-6m-cache-up-to-4-00-ghz/specifications.html">https://www.intel.com/content/www/us/en/products/sku/83503/intel-core-i74980hq-processor-6m-cache-up-to-4-00-ghz/specifications.html</a></p></li><li class="lvl-2"><p><a href="https://www.intel.com/content/www/us/en/products/sku/75789/intel-xeon-processor-e52620-v2-15m-cache-2-10-ghz/specifications.html">https://www.intel.com/content/www/us/en/products/sku/75789/intel-xeon-processor-e52620-v2-15m-cache-2-10-ghz/specifications.html</a></p></li></ul><h2 id="理论峰值">理论峰值</h2><p>$$ Gfloat理论峰值 = 核心数 * 主频 * 每时钟周期浮点运算次数 $$</p><p>本机CPU：Intel Core i7-4980HQ</p><p>CPU主频：2.8GHz<br>每时钟周期浮点运算次数：8<br>所以本机理论峰值为<br>$$ 4* 2.8GHz * 8 = 89.6 Gflops $$</p><p>这部分网上资料搜索有难度,4980HQ使用了avx256指令集,同时有2个FMA,每时钟周期浮点运算次数应当是8*2=16</p><p>但是不确定FMA是否需要加入,这里只考虑了*8的情况</p><p>根据后续实际测试结果,应该是乘以8的</p><h2 id="测试方式">测试方式</h2><ul class="lvl-0"><li class="lvl-2"><p>局域网远程连接测试电脑,启用vscode-server</p></li><li class="lvl-2"><p>先行跑一些数据,预热机器</p></li><li class="lvl-2"><p><code>mpirun -np 8 ./xhpl </code></p></li><li class="lvl-2"><p>开始测试,直接将测试结果输出到<code>result.txt</code>文件</p></li><li class="lvl-2"><p>利用命令<code>cat result.txt | grep WC00L2L2</code>获取答案</p></li></ul><p>测试例图:</p><p><img src="https://files.ozline.icu/images/blog/picgo/202211100119771.png" alt="image-20221110011916737"></p><h2 id="默认测试">默认测试</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">HPLinpack benchmark input file<br>Innovative Computing Laboratory, University of Tennessee<br>HPL.out      output file name <span class="hljs-params">(if any)</span><br>6            device out <span class="hljs-params">(<span class="hljs-attr">6</span>=stdout,<span class="hljs-attr">7</span>=stderr,file)</span><br>1            <span class="hljs-comment"># of problems sizes (N)</span><br>5000         Ns<br>1            <span class="hljs-comment"># of NBs</span><br>1            NBs<br>0            PMAP process mapping <span class="hljs-params">(<span class="hljs-attr">0</span>=Row-,<span class="hljs-attr">1</span>=Column-major)</span><br>1            <span class="hljs-comment"># of process grids (P x Q)</span><br>2            Ps<br>2            Qs<br>16.0         threshold<br>1            <span class="hljs-comment"># of panel fact</span><br>0            PFACTs <span class="hljs-params">(<span class="hljs-attr">0</span>=left, <span class="hljs-attr">1</span>=Crout, <span class="hljs-attr">2</span>=Right)</span><br>1            <span class="hljs-comment"># of recursive stopping criterium</span><br>2            NBMINs <span class="hljs-params">(&gt;= 1)</span><br>1            <span class="hljs-comment"># of panels in recursion</span><br>2            NDIVs<br>1            <span class="hljs-comment"># of recursive panel fact.</span><br>0            RFACTs <span class="hljs-params">(<span class="hljs-attr">0</span>=left, <span class="hljs-attr">1</span>=Crout, <span class="hljs-attr">2</span>=Right)</span><br>1            <span class="hljs-comment"># of broadcast</span><br>0            BCASTs <span class="hljs-params">(<span class="hljs-attr">0</span>=1rg,<span class="hljs-attr">1</span>=1rM,<span class="hljs-attr">2</span>=2rg,<span class="hljs-attr">3</span>=2rM,<span class="hljs-attr">4</span>=Lng,<span class="hljs-attr">5</span>=LnM)</span><br>1            <span class="hljs-comment"># of lookahead depth</span><br>0            DEPTHs <span class="hljs-params">(&gt;=0)</span><br>2            SWAP <span class="hljs-params">(<span class="hljs-attr">0</span>=bin-exch,<span class="hljs-attr">1</span>=long,<span class="hljs-attr">2</span>=mix)</span><br>64           swapping threshold<br>0            L1 in <span class="hljs-params">(<span class="hljs-attr">0</span>=transposed,<span class="hljs-attr">1</span>=no-transposed)</span> form<br>0            U  in <span class="hljs-params">(<span class="hljs-attr">0</span>=transposed,<span class="hljs-attr">1</span>=no-transposed)</span> form<br>1            Equilibration <span class="hljs-params">(<span class="hljs-attr">0</span>=no,<span class="hljs-attr">1</span>=yes)</span><br>8            memory alignment in double <span class="hljs-params">(&gt; 0)</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">➜  <span class="hljs-built_in">test</span> mpirun -np 8 ./xhpl<br></code></pre></td></tr></table></figure><p>测试过程中电脑数据情况如图所示</p><p><img src="https://files.ozline.icu/images/blog/picgo/202211100119020.png" alt="image-20221110011929988"></p><p>测试结果</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown">================================================================================<br><span class="hljs-section">T/V                N    NB     P     Q               Time                 Gflops</span><br><span class="hljs-section">--------------------------------------------------------------------------------</span><br>WR00L2L2        5000     1     2     2              27.06             3.0806e+00<br></code></pre></td></tr></table></figure><p>不知道是理论出错还是什么原因,的确是只有3.08Gflops…</p><p>实际理论比值约为1.76%,考虑到可能是NB值过小原因</p><h2 id="参数优化">参数优化</h2><h3 id="矩阵规模N">矩阵规模N</h3><p>根据公式 $$ N * N * 8 = 物理内存容量 * 0.8 $$</p><p>这里物理内存容量单位是bytes,这台机子的内存为16G,那么我们经过计算需要的N值大约为41448.6</p><p>考虑到我们实际上是取了80%,而可以考虑取到80-85%,再根据经验贴考虑384的倍数</p><p>那么我们可以确定N值为<strong>41472</strong>,也就是说要在这个范围内测试</p><p>这里考虑暂时以n=5000为测试</p><p>疑问:这里的公式似乎有错?我认为取不到41472</p><p>参考的一篇文档,47G内存N可以到52900,类比一下16G内存应该只能到三分之一甚至更低?</p><p>后续的数据也可以看出,实际上N的取值范围对于本机来说大约在10000左右</p><h3 id="二维处理器网格P-Q">二维处理器网格P*Q</h3><p>根据公式:$$ P*Q = 进程数 = 系统CPU数 $$</p><p>一般来说一个进程对于一个CPU可以得到最佳性能</p><p>一般情况下,P应当略小于Q,因为列向通信量的通信次数和通信数据量大于横向通信.</p><p>HPL中，L分解的列向通信采用二元交换法（Binary Exchange），当列向处理器个数P为2的幂时，性能最优</p><p>综上,确定<code>P=2 Q=2</code>和<code>P=1 Q=4</code>两组数据</p><h3 id="矩阵分块NB">矩阵分块NB</h3><p>HPL 使用块大小 NB 进行数据分布和计算粒度。从数据分布的角度来看，NB越小，负载平衡越好。从计算的角度来看，NB 值太小可能会限制计算性能，消息的数量将增加。NB的选择和软硬件许多因素密切相关。</p><p>NB一般在256以下，NB的最优值主要通过实际测试来得到。</p><p>本实验中选取<code>32、64、128、256</code>五组数据</p><h3 id="PMAP-process-mapping">PMAP process mapping</h3><p>HPL文档中介绍，按列的排列方式适用于节点数较多、每个节点内CPU数较少的系统；按行的排列方式适用于节点数较少、每个节点内CPU数较多的大规模系统。在机群系统上，按列的排列方式的性能远好于按行的排列方式，此处一般选择1。</p><p>测试中选择<code>1</code></p><h2 id="第一次测试">第一次测试</h2><p>单个测试ID测试约10次,数据取平均值</p><h3 id="N-5000">N=5000</h3><table><thead><tr><th>ID</th><th>N</th><th>P*Q</th><th>NB</th><th>PMAP process mapping</th><th>耗时/s</th><th>测试结果/Gflops</th><th>理论实际比值</th></tr></thead><tbody><tr><td>1</td><td>5000</td><td>2*2</td><td>32</td><td>1</td><td>1.51</td><td>5.5114e+01</td><td>61.51%</td></tr><tr><td>2</td><td>5000</td><td>2*2</td><td>64</td><td>1</td><td>1.50</td><td>5.5686e+01</td><td>62.15%</td></tr><tr><td>3</td><td>5000</td><td>2*2</td><td>128</td><td>1</td><td>1.57</td><td>5.2981e+01</td><td>59.13%</td></tr><tr><td>4</td><td>5000</td><td>2*2</td><td>256</td><td>1</td><td>1.91</td><td>4.3722e+01</td><td>48.80%</td></tr><tr><td>5</td><td>5000</td><td>1*4</td><td>32</td><td>1</td><td>1.62</td><td>5.1491e+01</td><td>57.47%</td></tr><tr><td>6</td><td>5000</td><td>1*4</td><td>64</td><td>1</td><td>1.55</td><td>5.3885e+01</td><td>60.14%</td></tr><tr><td>7</td><td>5000</td><td>1*4</td><td>128</td><td>1</td><td>1.58</td><td>5.2606e+01</td><td>58.71%</td></tr><tr><td>8</td><td>5000</td><td>1*4</td><td>256</td><td>1</td><td>2.05</td><td>4.0587e+01</td><td>45.30%</td></tr></tbody></table><p>第一轮测试数据如表,效果最好的是2号数据</p><h3 id="N-10000">N=10000</h3><table><thead><tr><th>ID</th><th>N</th><th>P*Q</th><th>NB</th><th>PMAP process mapping</th><th>耗时/s</th><th>测试结果/Gflops</th><th>理论实际比值</th></tr></thead><tbody><tr><td>1</td><td>10000</td><td>2*2</td><td>32</td><td>1</td><td>13.87</td><td>4.8061e+01</td><td>53.64%</td></tr><tr><td>2</td><td>10000</td><td>2*2</td><td>64</td><td>1</td><td>10.96</td><td>6.0826e+01</td><td>67.89%</td></tr><tr><td>3</td><td>10000</td><td>2*2</td><td>128</td><td>1</td><td>10.44</td><td>6.3850e+01</td><td>71.26%</td></tr><tr><td>4</td><td>10000</td><td>2*2</td><td>256</td><td>1</td><td>11.90</td><td>5.6054e+01</td><td>62.56%</td></tr><tr><td>5</td><td>10000</td><td>1*4</td><td>32</td><td>1</td><td>13.83</td><td>4.8225e+01</td><td>53.82%</td></tr><tr><td>6</td><td>10000</td><td>1*4</td><td>64</td><td>1</td><td>10.08</td><td>6.1314e+01</td><td>68.43%</td></tr><tr><td>7</td><td>10000</td><td>1*4</td><td>128</td><td>1</td><td>10.91</td><td>6.1104e+01</td><td>68.20%</td></tr><tr><td>8</td><td>10000</td><td>1*4</td><td>256</td><td>1</td><td>11.94</td><td>5.5839e+01</td><td>62.32%</td></tr></tbody></table><p>第二轮测试数据如表,效果最好为3号数据</p><h3 id="N-15000">N=15000</h3><table><thead><tr><th>ID</th><th>N</th><th>P*Q</th><th>NB</th><th>PMAP process mapping</th><th>耗时/s</th><th>测试结果/Gflops</th><th>理论实际比值</th></tr></thead><tbody><tr><td>1</td><td>15000</td><td>2*2</td><td>32</td><td>1</td><td>52.85</td><td>4.2578e+01</td><td>47.52%</td></tr><tr><td>2</td><td>15000</td><td>2*2</td><td>64</td><td>1</td><td>45.03</td><td>4.9978e+01</td><td>55.78%</td></tr><tr><td>3</td><td>15000</td><td>2*2</td><td>128</td><td>1</td><td>41.98</td><td>5.3607e+01</td><td>59.83%</td></tr><tr><td>4</td><td>15000</td><td>2*2</td><td>256</td><td>1</td><td>48.16</td><td>4.6725e+01</td><td>52.15%</td></tr><tr><td>5</td><td>15000</td><td>1*4</td><td>32</td><td>1</td><td>73.10</td><td>3.0786e+01</td><td>34.36%</td></tr><tr><td>6</td><td>15000</td><td>1*4</td><td>64</td><td>1</td><td>55.96</td><td>4.0213e+01</td><td>44.88%</td></tr><tr><td>7</td><td>15000</td><td>1*4</td><td>128</td><td>1</td><td>53.44</td><td>4.2106e+01</td><td>46.99%</td></tr><tr><td>8</td><td>15000</td><td>1*4</td><td>256</td><td>1</td><td>52.82</td><td>4.2603e+01</td><td>47.55%</td></tr></tbody></table><p>第三轮测试数据如表,效果最好为3号数据</p><h3 id="N-20000">N=20000</h3><table><thead><tr><th>ID</th><th>N</th><th>P*Q</th><th>NB</th><th>PMAP process mapping</th><th>耗时/s</th><th>测试结果/Gflops</th><th>理论实际比值</th></tr></thead><tbody><tr><td>1</td><td>20000</td><td>2*2</td><td>32</td><td>1</td><td>138.93</td><td>3.8393e+01</td><td>42.85%</td></tr><tr><td>2</td><td>20000</td><td>2*2</td><td>64</td><td>1</td><td>130.79</td><td>4.0783e+01</td><td>45.52%</td></tr><tr><td>3</td><td>20000</td><td>2*2</td><td>128</td><td>1</td><td>123.08</td><td>4.3337e+01</td><td>48.37%</td></tr><tr><td>4</td><td>20000</td><td>2*2</td><td>256</td><td>1</td><td>129.60</td><td>4.1156e+01</td><td>45.93%</td></tr><tr><td>5</td><td>20000</td><td>1*4</td><td>32</td><td>1</td><td>178.66</td><td>2.9855e+01</td><td>33.32%</td></tr><tr><td>6</td><td>20000</td><td>1*4</td><td>64</td><td>1</td><td>152.13</td><td>3.5061e+01</td><td>39.13%</td></tr><tr><td>7</td><td>20000</td><td>1*4</td><td>128</td><td>1</td><td>141.92</td><td>3.7583e+01</td><td>41.95%</td></tr><tr><td>8</td><td>20000</td><td>1*4</td><td>256</td><td>1</td><td>131.40</td><td>4.0594e+01</td><td>45.31%</td></tr></tbody></table><p>第四轮测试数据如表,效果最好的仍为3号数据</p><h3 id="小结">小结</h3><p>可以发现,这四组数据中</p><ul class="lvl-0"><li class="lvl-2"><p>关于N的甜点值大约在10000附近</p></li><li class="lvl-2"><p>效果最好的除了N=5000的情况,其余均为3号数据,而N=5000的情况下,2号数据和3号数据差异不大</p></li></ul><p>在后续测试中,将会以三号数据的情况为基准,N=10000开始测试</p><h2 id="第二次测试">第二次测试</h2><h3 id="N-8192">N=8192</h3><table><thead><tr><th style="text-align:center">ID</th><th>N</th><th>P*Q</th><th>NB</th><th style="text-align:center">PMAP process mapping</th><th style="text-align:center">耗时/s</th><th style="text-align:center">测试结果/Gflops</th><th style="text-align:center">理论实际比值</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td>8192</td><td>2*2</td><td>96</td><td style="text-align:center">1</td><td style="text-align:center">5.84</td><td style="text-align:center">6.2826e+01</td><td style="text-align:center">70.12%</td></tr><tr><td style="text-align:center">2</td><td>8192</td><td>2*2</td><td>128</td><td style="text-align:center">1</td><td style="text-align:center">6.31</td><td style="text-align:center">5.8132e+01</td><td style="text-align:center">64.88%</td></tr><tr><td style="text-align:center">3</td><td>8192</td><td>2*2</td><td>160</td><td style="text-align:center">1</td><td style="text-align:center">7.16</td><td style="text-align:center">5.3695e+01</td><td style="text-align:center">59.83%</td></tr><tr><td style="text-align:center">4</td><td>8192</td><td>2*2</td><td>96</td><td style="text-align:center">0</td><td style="text-align:center">6.24</td><td style="text-align:center">5.8795e+01</td><td style="text-align:center">65.62%</td></tr><tr><td style="text-align:center">5</td><td>8192</td><td>2*2</td><td>128</td><td style="text-align:center">0</td><td style="text-align:center">6.71</td><td style="text-align:center">5.4660e+01</td><td style="text-align:center">61.00%</td></tr><tr><td style="text-align:center">6</td><td>8192</td><td>2*2</td><td>160</td><td style="text-align:center">0</td><td style="text-align:center">6.78</td><td style="text-align:center">5.4043e+01</td><td style="text-align:center">60.32%</td></tr></tbody></table><p>PMAP process mapping=1时效果最好</p><p>NB=96时的效果最好</p><h3 id="N-10240">N=10240</h3><table><thead><tr><th style="text-align:center">ID</th><th>N</th><th>P*Q</th><th>NB</th><th style="text-align:center">PMAP process mapping</th><th style="text-align:center">耗时/s</th><th style="text-align:center">测试结果/Gflops</th><th style="text-align:center">理论实际比值</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td>10240</td><td>2*2</td><td>96</td><td style="text-align:center">1</td><td style="text-align:center">11.10</td><td style="text-align:center">6.4515e+01</td><td style="text-align:center">72.00%</td></tr><tr><td style="text-align:center">2</td><td>10240</td><td>2*2</td><td>128</td><td style="text-align:center">1</td><td style="text-align:center">12.80</td><td style="text-align:center">5.8132e+01</td><td style="text-align:center">62.43%</td></tr><tr><td style="text-align:center">3</td><td>10240</td><td>2*2</td><td>160</td><td style="text-align:center">1</td><td style="text-align:center">14.19</td><td style="text-align:center">5.0474e+01</td><td style="text-align:center">56.33%</td></tr><tr><td style="text-align:center">4</td><td>10240</td><td>2*2</td><td>96</td><td style="text-align:center">0</td><td style="text-align:center">11.54</td><td style="text-align:center">6.2030e+01</td><td style="text-align:center">69.23%</td></tr><tr><td style="text-align:center">5</td><td>10240</td><td>2*2</td><td>128</td><td style="text-align:center">0</td><td style="text-align:center">15.31</td><td style="text-align:center">4.6761e+01</td><td style="text-align:center">52.19%</td></tr><tr><td style="text-align:center">6</td><td>10240</td><td>2*2</td><td>160</td><td style="text-align:center">0</td><td style="text-align:center">16.91</td><td style="text-align:center">4.2343e+01</td><td style="text-align:center">47.26%</td></tr></tbody></table><p>PMAP process mapping=1时效果最好</p><p>NB=96时的效果最好</p><h3 id="N-12288">N=12288</h3><table><thead><tr><th style="text-align:center">ID</th><th>N</th><th>P*Q</th><th>NB</th><th style="text-align:center">PMAP process mapping</th><th style="text-align:center">耗时/s</th><th style="text-align:center">测试结果/Gflops</th><th style="text-align:center">理论实际比值</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td>12288</td><td>2*2</td><td>96</td><td style="text-align:center">1</td><td style="text-align:center">19.83</td><td style="text-align:center">6.2392e+01</td><td style="text-align:center">69.63%</td></tr><tr><td style="text-align:center">2</td><td>12288</td><td>2*2</td><td>128</td><td style="text-align:center">1</td><td style="text-align:center">25.31</td><td style="text-align:center">5.8132e+01</td><td style="text-align:center">54.55%</td></tr><tr><td style="text-align:center">3</td><td>12288</td><td>2*2</td><td>160</td><td style="text-align:center">1</td><td style="text-align:center">20.94</td><td style="text-align:center">5.9075e+01</td><td style="text-align:center">65.93%</td></tr><tr><td style="text-align:center">4</td><td>12288</td><td>2*2</td><td>96</td><td style="text-align:center">0</td><td style="text-align:center">26.67</td><td style="text-align:center">6.1447e+01</td><td style="text-align:center">68.58%</td></tr><tr><td style="text-align:center">5</td><td>12288</td><td>2*2</td><td>128</td><td style="text-align:center">0</td><td style="text-align:center">23.10</td><td style="text-align:center">5.3557e+01</td><td style="text-align:center">59.77%</td></tr><tr><td style="text-align:center">6</td><td>12288</td><td>2*2</td><td>160</td><td style="text-align:center">0</td><td style="text-align:center">26.67</td><td style="text-align:center">4.6387e+01</td><td style="text-align:center">51.77%</td></tr></tbody></table><p>PMAP process mapping=1时效果最好</p><p>NB=96时的效果最好</p><p><strong>需要注意:</strong></p><p>经过多轮测试,只改变NB值,理论实际比值在这一组测试中并非递减,<mark>存疑</mark></p><h3 id="小结-2">小结</h3><ul class="lvl-0"><li class="lvl-2"><p>PMAPprocess mapping = 1</p></li><li class="lvl-2"><p>P*Q = 2</p></li><li class="lvl-2"><p>NB范围中值更新为96</p></li><li class="lvl-2"><p>N范围中值更新为10240,缩小区间</p></li></ul><h2 id="第三次测试">第三次测试</h2><h3 id="新的测试方法">新的测试方法</h3><ul class="lvl-0"><li class="lvl-2"><p>使用命令<code>hpl-test &gt; result.txt &amp;&amp; cat result.txt | grep WR00L2L2</code>,其中<code>hpl-test</code>对应上文的测试命令</p></li><li class="lvl-2"><p>对于9组测试,均取10次结果的平均值作为数据.在这里我使用了word的文本转表格、再将表格导入excel,excel自动计算十次答案的平均值</p></li></ul><h3 id="数据结果">数据结果</h3><table><thead><tr><th style="text-align:center">ID</th><th style="text-align:center">N</th><th style="text-align:center">P*Q</th><th style="text-align:center">NB</th><th style="text-align:center">平均耗时/s</th><th style="text-align:center">平均测试结果/Gflops</th><th style="text-align:center">理论实际比值</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">9216</td><td style="text-align:center">2*2</td><td style="text-align:center">80</td><td style="text-align:center">9.221</td><td style="text-align:center">5.7660E+01</td><td style="text-align:center">64.35%</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">9216</td><td style="text-align:center">2*2</td><td style="text-align:center">96</td><td style="text-align:center">9.834</td><td style="text-align:center">5.3615E+01</td><td style="text-align:center">59.84%</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">9216</td><td style="text-align:center">2*2</td><td style="text-align:center">112</td><td style="text-align:center">10.26</td><td style="text-align:center">5.1499E+01</td><td style="text-align:center">57.48%</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">10240</td><td style="text-align:center">2*2</td><td style="text-align:center">80</td><td style="text-align:center">16.027</td><td style="text-align:center">4.4861E+01</td><td style="text-align:center">50.07%</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">10240</td><td style="text-align:center">2*2</td><td style="text-align:center">96</td><td style="text-align:center">13.957</td><td style="text-align:center">5.1972E+01</td><td style="text-align:center">58.00%</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">10240</td><td style="text-align:center">2*2</td><td style="text-align:center">112</td><td style="text-align:center">14.394</td><td style="text-align:center">5.0079E+01</td><td style="text-align:center">55.89%</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">11264</td><td style="text-align:center">2*2</td><td style="text-align:center">80</td><td style="text-align:center">19.781</td><td style="text-align:center">4.8580E+01</td><td style="text-align:center">54.22%</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">11264</td><td style="text-align:center">2*2</td><td style="text-align:center">96</td><td style="text-align:center">19.373</td><td style="text-align:center">4.9618E+01</td><td style="text-align:center">55.38%</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">11264</td><td style="text-align:center">2*2</td><td style="text-align:center">112</td><td style="text-align:center">19.591</td><td style="text-align:center">4.9121E+01</td><td style="text-align:center">54.82%</td></tr></tbody></table><h3 id="小结-3">小结</h3><ul class="lvl-0"><li class="lvl-2"><p>N范围以9216为基础值</p></li><li class="lvl-2"><p>NB范围以80为基础值</p></li><li class="lvl-2"><p>在测试过程中,发现由于电脑散热原因部分测试结果数据整体较低,但个人认为不影响理论实际比值</p></li><li class="lvl-2"><p>在测试过程中,单次测试获得的最高理论实际比值为71.09%,发生在一号数据中</p></li></ul><h2 id="第四次测试">第四次测试</h2><h3 id="新的测试方法-2">新的测试方法</h3><ul class="lvl-0"><li class="lvl-2"><p>关闭NextSSH的数据监看</p></li><li class="lvl-2"><p>关闭vscode-server连接</p></li><li class="lvl-2"><p>编写shell脚本自动化实现测试</p></li><li class="lvl-2"><p>只取十次测试中最好结果(考虑发热问题)</p></li></ul><h3 id="shell脚本">shell脚本</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br>cat /dev/null &gt; result.txt<br>for i in &#123;1..10&#125;;<br>do<br>    echo &quot;Solving process : $i&quot;<br>    mpirun -np 8 ./xhpl | grep WR00L2L2 &gt;&gt; result.txt<br>done<br></code></pre></td></tr></table></figure><h3 id="测试参数">测试参数</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">HPLinpack</span> benchmark input file<br><span class="hljs-attribute">Innovative</span> Computing Laboratory, University of Tennessee<br><span class="hljs-attribute">HPL</span>.out      output file name (if any)<br><span class="hljs-attribute">6</span>            device out (<span class="hljs-number">6</span>=stdout,<span class="hljs-number">7</span>=stderr,file)<br><span class="hljs-attribute">3</span>            # of problems sizes (N)<br><span class="hljs-attribute">8704</span> <span class="hljs-number">9216</span> <span class="hljs-number">9728</span>          Ns<br><span class="hljs-attribute">3</span>            # of NBs<br><span class="hljs-attribute">72</span> <span class="hljs-number">80</span> <span class="hljs-number">88</span>    NBs<br><span class="hljs-attribute">0</span>            PMAP process mapping (<span class="hljs-number">0</span>=Row-,<span class="hljs-number">1</span>=Column-major)<br><span class="hljs-attribute">1</span>            # of process grids (P x Q)<br><span class="hljs-attribute">2</span>            Ps<br><span class="hljs-attribute">2</span>            Qs<br><span class="hljs-attribute">16</span>.<span class="hljs-number">0</span>         threshold<br><span class="hljs-attribute">1</span>            # of panel fact<br><span class="hljs-attribute">0</span>            PFACTs (<span class="hljs-number">0</span>=left, <span class="hljs-number">1</span>=Crout, <span class="hljs-number">2</span>=Right)<br><span class="hljs-attribute">1</span>            # of recursive stopping criterium<br><span class="hljs-attribute">2</span>            NBMINs (&gt;= <span class="hljs-number">1</span>)<br><span class="hljs-attribute">1</span>            # of panels in recursion<br><span class="hljs-attribute">2</span>            NDIVs<br><span class="hljs-attribute">1</span>            # of recursive panel fact.<br><span class="hljs-attribute">0</span>            RFACTs (<span class="hljs-number">0</span>=left, <span class="hljs-number">1</span>=Crout, <span class="hljs-number">2</span>=Right)<br><span class="hljs-attribute">1</span>            # of broadcast<br><span class="hljs-attribute">0</span>            BCASTs (<span class="hljs-number">0</span>=<span class="hljs-number">1</span>rg,<span class="hljs-number">1</span>=<span class="hljs-number">1</span>rM,<span class="hljs-number">2</span>=<span class="hljs-number">2</span>rg,<span class="hljs-number">3</span>=<span class="hljs-number">2</span>rM,<span class="hljs-number">4</span>=Lng,<span class="hljs-number">5</span>=LnM)<br><span class="hljs-attribute">1</span>            # of lookahead depth<br><span class="hljs-attribute">0</span>            DEPTHs (&gt;=<span class="hljs-number">0</span>)<br><span class="hljs-attribute">2</span>            SWAP (<span class="hljs-number">0</span>=bin-exch,<span class="hljs-number">1</span>=long,<span class="hljs-number">2</span>=mix)<br><span class="hljs-attribute">64</span>           swapping threshold<br><span class="hljs-attribute">0</span>            L1 in (<span class="hljs-number">0</span>=transposed,<span class="hljs-number">1</span>=no-transposed) form<br><span class="hljs-attribute">0</span>            U  in (<span class="hljs-number">0</span>=transposed,<span class="hljs-number">1</span>=no-transposed) form<br><span class="hljs-attribute">1</span>            Equilibration (<span class="hljs-number">0</span>=no,<span class="hljs-number">1</span>=yes)<br><span class="hljs-attribute">8</span>            memory alignment in double (&gt; <span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><h3 id="数据结果-只取各个参数最好成绩">数据结果(只取各个参数最好成绩)</h3><table><thead><tr><th style="text-align:center">ID</th><th style="text-align:center">N</th><th style="text-align:center">P*Q</th><th style="text-align:center">NB</th><th style="text-align:center">耗时/s</th><th style="text-align:center">测试结果/Gflops</th><th style="text-align:center">理论实际比值</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">8704</td><td style="text-align:center">2*2</td><td style="text-align:center">72</td><td style="text-align:center">7.19</td><td style="text-align:center">6.1133e+01</td><td style="text-align:center">68.23%</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">8704</td><td style="text-align:center">2*2</td><td style="text-align:center">80</td><td style="text-align:center">7.58</td><td style="text-align:center">5.8030e+01</td><td style="text-align:center">64.77%</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">8704</td><td style="text-align:center">2*2</td><td style="text-align:center">88</td><td style="text-align:center">8.38</td><td style="text-align:center">5.2490e+01</td><td style="text-align:center">58.58%</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">9216</td><td style="text-align:center">2*2</td><td style="text-align:center">72</td><td style="text-align:center">9.10</td><td style="text-align:center">5.7354e+01</td><td style="text-align:center">64.01%</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">9216</td><td style="text-align:center">2*2</td><td style="text-align:center">80</td><td style="text-align:center">9.43</td><td style="text-align:center">5.5361e+01</td><td style="text-align:center">61.79%</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">9216</td><td style="text-align:center">2*2</td><td style="text-align:center">88</td><td style="text-align:center">10.78</td><td style="text-align:center">4.8403e+01</td><td style="text-align:center">54.02%</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">9728</td><td style="text-align:center">2*2</td><td style="text-align:center">72</td><td style="text-align:center">12.92</td><td style="text-align:center">4.7531e+01</td><td style="text-align:center">53.05%</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">9728</td><td style="text-align:center">2*2</td><td style="text-align:center">80</td><td style="text-align:center">10.41</td><td style="text-align:center">5.8965e+01</td><td style="text-align:center">65.81%</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">9728</td><td style="text-align:center">2*2</td><td style="text-align:center">88</td><td style="text-align:center">10.97</td><td style="text-align:center">5.5965e+01</td><td style="text-align:center">62.46%</td></tr></tbody></table><h3 id="性能损失">性能损失</h3><p>根据<code>lm-sensors</code>提供的数据,测试结束一段时间后cpu温度仍然在50多度</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Adapter</span>: ISA adapter<br><span class="hljs-attribute">Package</span> id <span class="hljs-number">0</span>:  +<span class="hljs-number">55</span>.<span class="hljs-number">0</span>°C  (high = +<span class="hljs-number">84</span>.<span class="hljs-number">0</span>°C, crit = +<span class="hljs-number">100</span>.<span class="hljs-number">0</span>°C)<br><span class="hljs-attribute">Core</span> <span class="hljs-number">0</span>:        +<span class="hljs-number">51</span>.<span class="hljs-number">0</span>°C  (high = +<span class="hljs-number">84</span>.<span class="hljs-number">0</span>°C, crit = +<span class="hljs-number">100</span>.<span class="hljs-number">0</span>°C)<br><span class="hljs-attribute">Core</span> <span class="hljs-number">1</span>:        +<span class="hljs-number">50</span>.<span class="hljs-number">0</span>°C  (high = +<span class="hljs-number">84</span>.<span class="hljs-number">0</span>°C, crit = +<span class="hljs-number">100</span>.<span class="hljs-number">0</span>°C)<br><span class="hljs-attribute">Core</span> <span class="hljs-number">2</span>:        +<span class="hljs-number">52</span>.<span class="hljs-number">0</span>°C  (high = +<span class="hljs-number">84</span>.<span class="hljs-number">0</span>°C, crit = +<span class="hljs-number">100</span>.<span class="hljs-number">0</span>°C)<br><span class="hljs-attribute">Core</span> <span class="hljs-number">3</span>:        +<span class="hljs-number">50</span>.<span class="hljs-number">0</span>°C  (high = +<span class="hljs-number">84</span>.<span class="hljs-number">0</span>°C, crit = +<span class="hljs-number">100</span>.<span class="hljs-number">0</span>°C)<br></code></pre></td></tr></table></figure><p>应该是撞温度墙了,导致频率下降,所以后续测试并不准确,各个数据之间拉不开差距</p><h3 id="小结-4">小结</h3><ul class="lvl-0"><li class="lvl-2"><p>发现一些问题所在:温度、功耗、连续测试变为压测</p></li><li class="lvl-2"><p>后面测试不应该安排这么紧密</p></li></ul><h3 id="其他">其他</h3><p>本次测试数据保留在result.txt里,可以参考</p><h2 id="第五次测试">第五次测试</h2><h3 id="新的测试方法-3">新的测试方法</h3><ul class="lvl-0"><li class="lvl-2"><p>利用<code>cpufrequtils</code>开启cpu高性能模式</p></li><li class="lvl-2"><p>将电脑移动至开阔地带</p></li><li class="lvl-2"><p>利用风扇辅助散热</p></li><li class="lvl-2"><p>只测试4次,每次只测试一组数据,取最高值</p></li><li class="lvl-2"><p>监控CPU温度,到45度左右在开始测试</p></li></ul><h3 id="shell脚本-2">shell脚本</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br>cat /dev/null &gt; result.txt<br>echo &quot;launch performance mode&quot;<br>for i in &#123;0..7&#125;<br>do<br>    sudo cpufreq-set -g performance -c $i<br>done<br>for i in &#123;1..4&#125;;<br>do<br>    echo &quot;Solving process : $i&quot;<br>    mpirun -np 8 ./xhpl | grep WR00L2L2 &gt;&gt; result.txt<br>done<br></code></pre></td></tr></table></figure><h3 id="数据">数据</h3><table><thead><tr><th style="text-align:center">ID</th><th>N</th><th>P*Q</th><th>NB</th><th style="text-align:center">耗时/s</th><th style="text-align:center">测试结果/Gflops</th><th style="text-align:center">理论实际比值</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td>10240</td><td>2*2</td><td>96</td><td style="text-align:center">11.28</td><td style="text-align:center">6.3468e+01</td><td style="text-align:center">70.83%</td></tr><tr><td style="text-align:center">2</td><td>10240</td><td>2*2</td><td>128</td><td style="text-align:center">11.53</td><td style="text-align:center">6.2105e+01</td><td style="text-align:center">69.31%</td></tr><tr><td style="text-align:center">3</td><td>9216</td><td>2*2</td><td>96</td><td style="text-align:center">8.94</td><td style="text-align:center">5.8401e+01</td><td style="text-align:center">65.18%</td></tr><tr><td style="text-align:center">4</td><td>9216</td><td>2*2</td><td>128</td><td style="text-align:center">8.42</td><td style="text-align:center">6.1987e+01</td><td style="text-align:center">69.18%</td></tr><tr><td style="text-align:center">5</td><td>8704</td><td>2*2</td><td>96</td><td style="text-align:center">6.69</td><td style="text-align:center">6.5727e+01</td><td style="text-align:center">73.36%</td></tr><tr><td style="text-align:center">6</td><td>8704</td><td>2*2</td><td>128</td><td style="text-align:center">7.63</td><td style="text-align:center">5.7631e+01</td><td style="text-align:center">64.32%</td></tr></tbody></table><h3 id="结论">结论</h3><p>有突破点了,1号和5号数据都超过了70!还刷新到了73.36%!</p><h2 id="第六次测试">第六次测试</h2><h3 id="从内存确定N的值">从内存确定N的值</h3><p>根据<code>free -g</code>获取到的数据</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs tap">           total        used        free      shared  buff/cache   available<br>内存：        <span class="hljs-number"> 15 </span>         <span class="hljs-number"> 1 </span>        <span class="hljs-number"> 10 </span>         <span class="hljs-number"> 0 </span>         <span class="hljs-number"> 3 </span>         13<br>交换：         <span class="hljs-number"> 1 </span>         <span class="hljs-number"> 0 </span>          1<br></code></pre></td></tr></table></figure><p>我们注意到实际上可用空间是10g,那么重新计算的出的N的值为35895左右,离他最近的384的倍数是35712</p><p>分别试试这两个</p><h3 id="N-35895">N=35895</h3><p>可以看见这里面的物理内存剩余稳定在3.7g可用,说明还没压榨完,可以考虑继续提高n的值</p><p>测试得出Gflops = 6.1495e+01, 理论实际比值为68.63%</p><h3 id="N-38400">N=38400</h3><p>考虑到还有内存剩余,我们尝试N=38400</p><p>测试得出:Gflops = 6.1320e+01, 理论实际比值为68.44%</p><h2 id="总结">总结</h2><h3 id="最好成绩">最好成绩</h3><p>实际/理论*100% = 73.36%</p><p>参数如下</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">HPLinpack benchmark input file<br>Innovative Computing Laboratory, University of Tennessee<br>HPL.out      output file name <span class="hljs-params">(if any)</span><br>6            device out <span class="hljs-params">(<span class="hljs-attr">6</span>=stdout,<span class="hljs-attr">7</span>=stderr,file)</span><br>1            <span class="hljs-comment"># of problems sizes (N)</span><br>8704         Ns<br>1            <span class="hljs-comment"># of NBs</span><br>96           NBs<br>0            PMAP process mapping <span class="hljs-params">(<span class="hljs-attr">0</span>=Row-,<span class="hljs-attr">1</span>=Column-major)</span><br>1            <span class="hljs-comment"># of process grids (P x Q)</span><br>2            Ps<br>2            Qs<br>16.0         threshold<br>1            <span class="hljs-comment"># of panel fact</span><br>0            PFACTs <span class="hljs-params">(<span class="hljs-attr">0</span>=left, <span class="hljs-attr">1</span>=Crout, <span class="hljs-attr">2</span>=Right)</span><br>1            <span class="hljs-comment"># of recursive stopping criterium</span><br>2            NBMINs <span class="hljs-params">(&gt;= 1)</span><br>1            <span class="hljs-comment"># of panels in recursion</span><br>2            NDIVs<br>1            <span class="hljs-comment"># of recursive panel fact.</span><br>0            RFACTs <span class="hljs-params">(<span class="hljs-attr">0</span>=left, <span class="hljs-attr">1</span>=Crout, <span class="hljs-attr">2</span>=Right)</span><br>1            <span class="hljs-comment"># of broadcast</span><br>0            BCASTs <span class="hljs-params">(<span class="hljs-attr">0</span>=1rg,<span class="hljs-attr">1</span>=1rM,<span class="hljs-attr">2</span>=2rg,<span class="hljs-attr">3</span>=2rM,<span class="hljs-attr">4</span>=Lng,<span class="hljs-attr">5</span>=LnM)</span><br>1            <span class="hljs-comment"># of lookahead depth</span><br>0            DEPTHs <span class="hljs-params">(&gt;=0)</span><br>2            SWAP <span class="hljs-params">(<span class="hljs-attr">0</span>=bin-exch,<span class="hljs-attr">1</span>=long,<span class="hljs-attr">2</span>=mix)</span><br>64           swapping threshold<br>0            L1 in <span class="hljs-params">(<span class="hljs-attr">0</span>=transposed,<span class="hljs-attr">1</span>=no-transposed)</span> form<br>0            U  in <span class="hljs-params">(<span class="hljs-attr">0</span>=transposed,<span class="hljs-attr">1</span>=no-transposed)</span> form<br>1            Equilibration <span class="hljs-params">(<span class="hljs-attr">0</span>=no,<span class="hljs-attr">1</span>=yes)</span><br>8            memory alignment in double <span class="hljs-params">(&gt; 0)</span><br></code></pre></td></tr></table></figure><h3 id="优化方向">优化方向</h3><ul class="lvl-0"><li class="lvl-2"><p>经过前期摸爬滚打,优化方向大致在N、NB、P、Q上</p></li><li class="lvl-2"><p>需要考虑CPU散热问题</p></li><li class="lvl-2"><p>通常以2的整数倍效果好,尤其是2的幂</p></li></ul><h3 id="标准成绩">标准成绩</h3><p>在笔记本上,经过优化,可以跑到70%以上的实际理论比值,本次测试的73.36%属于测试优化成功了</p><p>在服务器上可以跑到80%以上的实际理论比值,考虑到可能是散热、降频导致比值上不去</p><p>总而言之,在本机上的HPL优化调优获得一个大成功!</p>]]></content>
    
    
    <categories>
      
      <category>超算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HPC</tag>
      
      <tag>性能优化</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OneAPI HPL HPCG的安装与部分Linux笔记</title>
    <link href="/a332e471e29e/"/>
    <url>/a332e471e29e/</url>
    
    <content type="html"><![CDATA[<h1>OneAPI HPL HPCG的安装与部分Linux笔记</h1><p>当然要记录下来啦，下回重装的时候还能照着自己写的来装回去呢！</p><p>Docker、Vim和Git就不记录啦，这个已经很熟练了，已经在easyhpc上全过一遍啦</p><h1>本机信息</h1><p>Linux ozline 5.15.0-48-generic #54-Ubuntu SMP Fri Aug 26 13:26:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux</p><p>Ubuntu 22.04.1 LTS</p><p>Apple Inc. MacbookPro11,5</p><p>Intel Core i7-4980HQ CPU @ 2.80GHz × 8</p><h1>OneAPI</h1><h2 id="下载包">下载包</h2><p><code>https://www.intel.cn/content/www/cn/zh/developer/tools/oneapi/toolkits.html</code></p><p>找到<code>Intel oneAPI Base Toolkit</code>和<code>Intel® oneAPI HPC Toolkit</code>，进入下载页面</p><p>操作系统选择Linux，分发选APT软件包管理器</p><h2 id="安装">安装</h2><ul class="lvl-0"><li class="lvl-2"><p>按上述说明下载后安装，已经是图形界面了，跟着一步一步来就行啦，只需要注意一下</p><ul class="lvl-2"><li class="lvl-4">选推荐安装<code>Recommended Installation</code></li><li class="lvl-4">不使用已有配置<code>Skip Eclipse IDE configuration</code></li></ul></li><li class="lvl-2"><p>最后会提示<code>Installization location: </code>这里表示我们文件存放的位置，后续路径都和这个有关</p></li><li class="lvl-2"><p>安装好后，编辑<code>vim ~/.zshrc</code></p></li><li class="lvl-2"><p>添加命令<code>source /opt/intel/oneapi/setvars.sh intel64</code></p></li><li class="lvl-2"><p>应用<code>source ~/.zshrc</code>，可以重启一下终端</p></li><li class="lvl-2"><p>会跳出一堆信息，这时候就需要我们手动更改<code>setvars.sh</code>里的内容了（谁喜欢每次打开终端的时候跳出一堆东西呢）</p></li><li class="lvl-2"><p>编辑<code>sudo vim /opt/intel/oneapi/setvars.sh</code></p><ul class="lvl-2"><li class="lvl-5">首先，在第一行插入<code># USING #| EXPLAIN MY MODIFICATION</code>，对于自行更改的内容要随时做好注释</li><li class="lvl-5">搜索关键字<code>initializing oneAPI environment ...</code>，把这四行全部注释，注意，要用<code>#|</code>，便于后续定位更改</li><li class="lvl-5">搜索关键字<code>:: $arg_base -- $arg_verz</code>，注释</li><li class="lvl-5">搜索关键字<code>:: oneAPI environment initialized </code>，把这两行都注释掉</li><li class="lvl-5">重新打开终端</li></ul></li><li class="lvl-2"><p>如果一切都没问题，重新打开终端后不会跳出输出的信息，我们可以随便输入一个例如<code>ifort -v</code>测试是否成功</p></li></ul><h2 id="成果图">成果图</h2><p>无，因为有输出的都被我注释掉了~</p><h1>HPL</h1><h2 id="下载包-2">下载包</h2><p>校园网一直连不上，不知道为何安装了Clash也提示502，后面直接电脑下载传阿里云OSS再在物理机上从OSS下载，曲线救国了</p><h2 id="安装-2">安装</h2><h3 id="流程">流程</h3><ul class="lvl-0"><li class="lvl-2"><p>下载<code>wget http://www.netlib.org/benchmark/hpl/hpl-2.3.tar.gz</code></p></li><li class="lvl-2"><p>解压并重命名<code>tar -xzf hpl-2.3.tar.gz &amp;&amp; mv hpl-2.3 hpl</code></p></li><li class="lvl-2"><p>复制<code>cp setup/Make.Linux_Intel64 Make.test</code></p></li><li class="lvl-2"><p>编辑<code>Make.test</code></p><ul class="lvl-2"><li class="lvl-4"><mark>TOPdir</mark>修改为hpl文件夹路径</li><li class="lvl-4"><mark>ARCH</mark>修改为test</li><li class="lvl-4"><mark>OMP_DEFS</mark>修改为<code>-qopenmp</code></li></ul></li><li class="lvl-2"><p>编译<code>make arch=test</code></p></li><li class="lvl-2"><p>测试<code>cd /bin/test</code>，如果前面步骤无误这里会出现一个<code>HPL.dat</code>和<code>xhpl</code>的二进制文件</p></li><li class="lvl-2"><p>运行<code>mpirun ./xhpl</code></p></li></ul><h3 id="重点分析">重点分析</h3><p>在编辑<code>Make.test</code>文件上花了较多时间</p><ul class="lvl-0"><li class="lvl-2"><p>第一次，在<code>Make.test</code>文件中只修改了<code>arch=test</code>，导致编译过程中遇上链接错误，检查后发现是硬连接地址错误，原因分析后，首先是意识到自己的用户并非root，其次是发现还需要修改<code>Make.test</code>中的<code>TOPdir</code>，遂更改并重新make</p></li><li class="lvl-2"><p>make后发现还是不行，在这一步选择了把文件夹直接删去，重新解压缩再make</p></li><li class="lvl-2"><p>第二次，make后没有出现硬链接错误，但是提示<code>-openmp is not supported</code>，考虑到自己的物理机系统版本是Ubuntu22.04，同时查证发现这一步需要修改参数<code>-openmp</code>为<code>-qopenmp</code>，在<code>Make.test</code>中将<code>OMP_DEFS</code>的参数更改为<code>-qopenmp</code>，通过编译</p></li></ul><h2 id="成果图-2">成果图</h2><p><img src="https://files.ozline.icu/images/blog/hpc/IMG_9736.jpeg" alt="IMG_9736"></p><h1>HPCG</h1><h2 id="下载包-3">下载包</h2><p>过程顺畅，联系到先前HPL一直无法下载，可能是那个域名并不是proxy名单里的，导致没有走代理</p><h2 id="安装-3">安装</h2><ul class="lvl-0"><li class="lvl-2"><p>下载<code>git clone https://github.com/hpcg-benchmark/hpcg.git</code></p></li><li class="lvl-2"><p>进入目录<code>cd /hpcg/setup/</code></p></li><li class="lvl-2"><p>修改<code>Make.Linux_MPI</code></p><ul class="lvl-2"><li class="lvl-4"><mark>TOPdir</mark>考虑到我们是在home目录下clone的仓库，于是我们修改成<code>$(HOME)/hpcg</code></li><li class="lvl-4"><mark>MPdir</mark>，这里要定位到oneapi的mpi目录，我这里是<code>/opt/intel/oneapi/mpi/2021.6.0</code></li><li class="lvl-4"><mark>MPinc</mark>，修改为<code>-I $(MPDir)/include</code>，利用到了前面我们设定的MPdir</li><li class="lvl-4"><mark>MPlib</mark>，修改为<code>$(MPdir)/lib/release/libmpi.a</code></li></ul></li><li class="lvl-2"><p>建目录并进入<code>mkdir build &amp;&amp; cd build</code></p></li><li class="lvl-2"><p>设置环境<code>/home/ozline/hpcg/configure Linux_MPI</code>，注意，这里的<code>configure</code>就是hpcg文件夹根目录的那个，因此这句命令的configure路径需要你自己确定</p></li><li class="lvl-2"><p>安装<code>make</code></p></li><li class="lvl-2"><p>测试<code>cd bin</code>，如果成功，会有一个<code>hpcg.dat</code>和<code>xhpcg</code>文件</p></li><li class="lvl-2"><p>运行<code>./xhpcg</code>，如果没有报出什么error就是跑通了</p></li></ul><h2 id="成果图-3">成果图</h2><p>展示的是文件<code>HPGC-Benchmark_3.1_&#123;time&#125;.txt</code>的部分内容</p><p><img src="https://files.ozline.icu/images/blog/hpc/IMG_9738.jpeg" alt="IMG_9738"></p><h1>Linux</h1><h2 id="Linux基础">Linux基础</h2><h3 id="快捷键">快捷键</h3><ul class="lvl-0"><li class="lvl-2"><p>Tab : 命令补全</p></li><li class="lvl-2"><p>Ctrl+D ： 键盘输入结束或退出终端。</p></li><li class="lvl-2"><p>Ctrl+S ： 暂停当前程序，暂停后按下任意键恢复运行。</p></li><li class="lvl-2"><p>Ctrl+Z ： 将当前程序放到后台运行，恢复到前台为命令fg。</p></li><li class="lvl-2"><p>Ctrl+A ： 将光标移至输入行头，相当于Home键。</p></li><li class="lvl-2"><p>Ctrl+E ： 将光标移至输入行末，相当于End键。</p></li><li class="lvl-2"><p>Ctrl+K ： 删除从光标所在位置到行末。</p></li><li class="lvl-2"><p>Alt+Backspace ： 向前删除一个单词。</p></li><li class="lvl-2"><p>Shift+PgUp ： 将终端显示向上滚动。</p></li><li class="lvl-2"><p>Shift+PgDn ： 将终端显示向下滚动。</p></li></ul><h3 id="APT">APT</h3><ul class="lvl-0"><li class="lvl-2"><p>apt-cache search &lt;<em>software</em>&gt; ： 查询软件库是否有这个软件</p></li><li class="lvl-2"><p>apt-get -reinstall install &lt;<em>software</em>&gt; ： 在软件被破坏时重新安装这个软件</p></li><li class="lvl-2"><p>apt-get purge &lt;<em>software</em>&gt; ： 卸载软件，连同配置文件</p></li></ul><h3 id="用户">用户</h3><ul class="lvl-0"><li class="lvl-2"><p>whoami ： 输出当前终端的用户名</p></li><li class="lvl-2"><p>adduser &lt;<em>username</em>&gt; ： 创建用户</p></li><li class="lvl-2"><p>su &lt;<em>username</em>&gt; ： 切换到user</p></li><li class="lvl-2"><p>su - &lt;<em>username</em>&gt; ： 切换到user，同时环境变量也切换到目标用户的</p></li><li class="lvl-2"><p>groups &lt;<em>username</em>&gt; ： 输出用户和用户组</p><ul class="lvl-2"><li class="lvl-4">样例输出： <code>ozline : ozline adm cdrom sudo dip plugedv lpadmin lxd sambashare</code></li></ul></li><li class="lvl-2"><p>deluser &lt;user_name&gt;  --remove-home ：删除用户</p></li></ul><h3 id="文件">文件</h3><ul class="lvl-0"><li class="lvl-2"><p>chown &lt;<em>newowner</em>&gt; &lt;<em>filename</em>&gt; ：变更文件所有者</p></li><li class="lvl-2"><p>chmod &lt;<em>permissions</em>&gt; &lt;<em>filename</em>&gt; ：变更文件权限</p><ul class="lvl-2"><li class="lvl-4">第一种方式：二进制数字表示。每个文件的三组权限对应一个 “rwx”，每一位可以用 0 或 1 表示是否有权限，例如只有读和写权限的话就是 “rw-” - “110”，所以&quot;rwx&quot;对应的二进制&quot;111&quot;就是十进制的7。</li><li class="lvl-4"><code>chmod 700 &lt;filename&gt;</code>·</li><li class="lvl-4">第二种方式：加减赋值表示。假设一开始 file 文件的权限是 “rwxr–r–” 完成上述同样的效果，还可以：</li><li class="lvl-4"><code>chmod go-rr &lt;filename&gt;</code></li></ul></li><li class="lvl-2"><p>find [path] [option] [action]</p><ul class="lvl-2"><li class="lvl-4">find /usr/ -name myfile ：在 /usr/ 下搜索 名为myfile的文件或目录</li></ul></li><li class="lvl-2"><p>locate：</p><ul class="lvl-2"><li class="lvl-4">locate /usr/a ： 查找 /user和它的子目录下所有 a 开头的文件</li></ul></li></ul><h3 id="解压缩">解压缩</h3><h4 id="RAR">RAR</h4><ul class="lvl-0"><li class="lvl-2"><p>rar a &lt;<em>filename</em>&gt; &lt;<em>dirname_or_filename</em>&gt; ：把目录/文件添加进压缩包</p></li><li class="lvl-2"><p>rar d &lt;<em>filename</em>&gt; &lt;<em>filename</em>&gt; ： 从压缩包内删除文件</p></li><li class="lvl-2"><p>rar l &lt;<em>filename</em>&gt; ： 查看压缩包内容</p></li><li class="lvl-2"><p>unrar x &lt;<em>filename</em>&gt; ： 保持压缩文件的目录结构解压缩</p></li><li class="lvl-2"><p>unrar e &lt;<em>filename</em>&gt; ： 将所有文件解压到当前目录</p></li></ul><h4 id="ZIP">ZIP</h4><ul class="lvl-0"><li class="lvl-2"><p>zip -r -o &lt;<em>filename</em>&gt;  &lt;<em>dirname</em>&gt; ： 把目录打包成压缩包，其中<code>-r</code>表示递归，<code>-o</code>表示输出到，还可额外添加<code>-e</code>进行加密，如果期望Linux压缩文件在Windows下正常解压，可以加上<code>-l</code>参数</p></li><li class="lvl-2"><p>unzip &lt;<em>filename</em>&gt; ：解压，若加上<code>-l</code>则不解压只查看</p></li></ul><h4 id="TAR">TAR</h4><ul class="lvl-0"><li class="lvl-2"><p>tar -cf &lt;<em>filename</em>&gt; &lt;<em>dirname</em>&gt; ： 打包，其中<code>-c</code>表示创建，<code>-f</code>表示指定文件名</p></li><li class="lvl-2"><p>tar -tf &lt;<em>filename</em>&gt; ： 查看包内文件</p></li><li class="lvl-2"><p>tar -xf &lt;<em>filename</em>&gt; -C &lt;<em>dirname</em>&gt; ： 解包到指定目录</p></li><li class="lvl-2"><p>tar -czf &lt;<em>filename</em>&gt; &lt;<em>dirname</em>&gt; ：打包并压缩，这里用到了gzip</p></li><li class="lvl-2"><p>tar -xzf &lt;<em>targz_name</em>&gt; ： 解压缩.tar.gz文件</p></li></ul><h3 id="管道与文本处理">管道与文本处理</h3><ul class="lvl-0"><li class="lvl-2"><p>&amp;&amp; 表示如果前一个命令返回的状态为0（这些状态码有一套默认的规定），则执行后一个命令，否则不执行。而 || 则与之相反。</p></li><li class="lvl-2"><p>在命令行中使用匿名管道，通常用<code>|</code>来表示，以<code>ls -a | grep mysql</code>为例，先执行了<code>ls -a</code>，然后把输出结果作为输入执行<code>grep mysql</code>命令，在输入中查找包含<code>mysql</code>关键字的文件</p></li><li class="lvl-2"><p>grep</p><ul class="lvl-2"><li class="lvl-4">grep -r &lt;<em>keywords</em>&gt; &lt;<em>dirname</em>&gt; ：搜索目录下所有包含关键字的文件</li></ul></li><li class="lvl-2"><p>wc ： 统计并输出一个文件中行、字节等数据的数目，其中<code>-l</code>表示行数，<code>-c</code>表示字节数</p><ul class="lvl-2"><li class="lvl-4">ls -a | wc -l ：统计文件个数</li></ul></li><li class="lvl-2"><p>uniq： 去重</p><ul class="lvl-2"><li class="lvl-4">cat words | uniq ：除去一些重复行，但是uniq只能去除连续重复的行，所以我们一般要先用一个sort，也就是<code>cat words | sort | uniq</code></li></ul></li><li class="lvl-2"><p>sort： 排序</p><ul class="lvl-2"><li class="lvl-4">ls -a | sort：字典排序</li><li class="lvl-4">ls -a | sort -r ：反转排序</li></ul></li><li class="lvl-2"><p>col：tab转空格</p><ul class="lvl-2"><li class="lvl-4">例：cat &lt;<em>filename</em>&gt; | col -x | cat -A ：把文件的tab转成空格</li></ul></li><li class="lvl-2"><p>tr：替换</p><ul class="lvl-2"><li class="lvl-4">echo “Hello World” | tr -d “el”：删去文本中的所有e和l（不是el）</li><li class="lvl-4">echo “Hello World” | tr ‘[a-z]’ ‘[A-Z]：支持正则表达式，把小写转大写’</li></ul></li></ul><h3 id="重定向">重定向</h3><ul class="lvl-0"><li class="lvl-2"><p>在Linux中，标准输入、标准输出、标准错误的文件描述符为0、1、2</p></li><li class="lvl-2"><p>cat words | sort | uniq 1&gt;/dev/null 2&gt;&amp;1：输出到/dev/null的表示丢弃输出</p></li></ul><h3 id="前后台切换">前后台切换</h3><ul class="lvl-0"><li class="lvl-2"><p>可以利用<code>&amp;</code>这个符号，让命令在后台中运行，例如<code>ls &amp;</code></p></li><li class="lvl-2"><p>jobs：查看后台的工作，可以看到类似于<code>[1] + suspended ...(command)</code>，分别为编号，状态和命令本身，这里面的<code>+</code>号表示的是最后一个被转入后台的工作，而<code>-</code>号表示倒数第二个， 其余的不会显示</p></li><li class="lvl-2"><p>fg %<jobid>：把后台工作拿回前台，例如<code>fg %1</code></p></li></ul><h2 id="GCC">GCC</h2><h3 id="编译参数">编译参数</h3><p>这里还参考了这篇文章:<a href="https://www.jianshu.com/p/fc8ca10971ed">https://www.jianshu.com/p/fc8ca10971ed</a></p><p>补充了一些觉得经常用的</p><ul class="lvl-0"><li class="lvl-2"><p><code>-c</code>：只编译，不链接，生成<code>.o</code>文件，通常用于编译不包含主程序的子程序文件（只激活预处理、编译、汇编）</p></li><li class="lvl-2"><p><code>-o &lt;filename&gt;</code>：指定输出文件名，否则gcc将会给出预设可执行文件<code>a.out</code></p></li><li class="lvl-2"><p><code>-g</code>：生成测试信息，调试需要加入这个选项</p></li><li class="lvl-2"><p><code>-O</code>：对程序优化编译链接，O0、O、O2、O3优化递增</p></li><li class="lvl-2"><p><code>-Idirname</code>：将dirname所指出的目录加入到程序头文件目录列表中，是在预编译过程中使用的参数</p></li><li class="lvl-2"><p><code>-x &lt;language&gt; &lt;filename&gt;</code>：指定编译语言编译</p></li><li class="lvl-2"><p><code>-S</code>：只激活预处理和编译，变为汇编代码</p></li><li class="lvl-2"><p><code>-E</code>：只激活预处理</p></li><li class="lvl-2"><p><code>-shaer</code>：尽量使用动态库，使得生成文件较小</p></li><li class="lvl-2"><p><code>-static</code>：不使用动态库，生成可以直接运行不需要任何依赖的静态库</p></li><li class="lvl-2"><p><code>-Wall</code>：生成所有警告信息</p></li><li class="lvl-2"><p><code>-w</code>：不生成任何警告</p></li><li class="lvl-2"><p><code>-m486</code>：针对486进行代码优化</p></li><li class="lvl-2"><p><code>-nostdinc</code>：不在系统默认的头文件目录里找头文件，一般和<code>-I</code>一起用，指定头文件位置</p></li></ul><h2 id="GDB">GDB</h2><ul class="lvl-0"><li class="lvl-2"><p>输入<code>gdb</code>就可以与deb进行交互，使用<code>gdb -tui</code>则可以将屏幕分成两个部分，上方显示源代码，后续内容全部为在gdb环境内的操作</p></li><li class="lvl-2"><p><code>help</code>：输出帮助文档</p></li><li class="lvl-2"><p><code>file &lt;filename&gt;</code>：载入可执行程序</p></li><li class="lvl-2"><p><code>set args</code>：命令修改发送给程序的参数</p></li><li class="lvl-2"><p><code>list &lt;line&gt; </code>：列出行号附近的代码</p></li><li class="lvl-2"><p><code>next &lt;N&gt;</code>：执行N次下一步，可以省略N，表示执行1次，这不会进入函数内部</p></li><li class="lvl-2"><p><code>step &lt;N&gt;</code>：执行N次下一步，可以进入函数内部</p></li><li class="lvl-2"><p><code>call &lt;funcname&gt;</code>：调用函数</p></li><li class="lvl-2"><p><code>break &lt;line&gt;</code>：设置某一行断点</p></li><li class="lvl-2"><p><code>info &lt;things&gt;</code>：获取信息，things指代下述命令</p><ul class="lvl-2"><li class="lvl-4"><code>breakpoints</code>：查询断点信息，会列出一个表格，从左到右分别表示<code>序号</code>，<code>类型</code>，<code>断点命中后，该断点是保留、删除还是关闭</code>、<code>可用状态</code>、<code>虚拟内存地址</code>、<code>源文件信息(包括行数)</code></li><li class="lvl-4"><code>local</code>：获取变量信息（不包括全局变量）</li></ul></li><li class="lvl-2"><p><code>delete &lt;number&gt;</code>：删除指定序号的断点</p></li><li class="lvl-2"><p><code>enable/disable &lt;number&gt;</code>：启用/关闭断点</p></li><li class="lvl-2"><p><code>run</code>：开始调试</p></li><li class="lvl-2"><p><code>print &lt;args&gt;</code> ：输出指定变量名当前信息</p></li><li class="lvl-2"><p><code>finish</code>：执行程序到当前函数结束</p></li><li class="lvl-2"><p><code>continue</code>：到下一个断点</p></li><li class="lvl-2"><p><code>until &lt;line&gt;</code>：执行到代码的某一行</p></li></ul><h2 id="Shell基础">Shell基础</h2><ul class="lvl-0"><li class="lvl-2"><p>第一行通常有一个<code>#!/bin/bash</code>，头两个字符代表一个标记，表示后面的脚本所使用的解释器</p></li><li class="lvl-2"><p>设定一个变量，注意是变量名与等号之间不能有空格，命名只能使用英文字母、数字、下划线，不能使用特殊关键字</p></li><li class="lvl-2"><p>我们利用<code>&gt;</code>输出重定向，例如我们使用<code>date &gt; date.txt</code>来输出到txt文件</p></li><li class="lvl-2"><p>所以，我们可以用<code>&lt;</code>表示输入重定向</p></li></ul><h3 id="运算符">运算符</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br>a=5<br>b=10<br><br>val=`expr $a + $b`<br>echo &quot;a + b : $val&quot;<br><br>val=`expr $a - $b`<br>echo &quot;a - b : $val&quot;<br><br>val=`expr $a \* $b`<br>echo &quot;a * b : $val&quot;<br><br>val=`expr $b / $a`<br>echo &quot;b / a : $val&quot;<br><br>val=`expr $b % $a`<br>echo &quot;b % a : $val&quot;<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>expr是一个表达式计算工具，注意使用的是<mark>反引号</mark></p></li></ul><h3 id="输出">输出</h3><ul class="lvl-0"><li class="lvl-2"><p>基本和c++的printf一样</p></li><li class="lvl-2"><p>输出命令：使用反引号，实际上涉及到与命令相关的，基本上都是反引号（？）</p></li><li class="lvl-2"><p>输出数组</p><ul class="lvl-2"><li class="lvl-4">首先，我们需要定义一个数组<code>array_list = (E H P C)</code></li><li class="lvl-4">在echo中，我们使用<code>$&#123;array_list[0]&#125;</code>来输出，类似php（？）</li></ul></li></ul><h3 id="if-else">if-else</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/sh</span><br>a=5<br>b=6<br>if [ $a == $b ]<br>then<br>   echo &quot;a == b&quot;<br>else<br>   echo &quot;a !=b&quot;<br>fi<br></code></pre></td></tr></table></figure><h3 id="while">while</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/sh</span><br>count=1<br>while(( $count&lt;=3 ))<br>do<br>    echo $count<br>    let &quot;count++&quot;<br>done<br></code></pre></td></tr></table></figure><h3 id="for">for</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/sh</span><br>for str in &#x27;ehpc is easy hpc&#x27;<br>do<br>    echo $str<br>done<br></code></pre></td></tr></table></figure><h3 id="until">until</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br>val=0<br>until [ ! $val -lt 5 ]<br>do<br>   echo $val<br>   val=`expr $val + 1`<br>done<br></code></pre></td></tr></table></figure><h3 id="function">function</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">! /bin/bash</span><br>function echo_hello()<br>&#123;<br>  echo &quot;hello world&quot;<br>&#125;<br>echo_hello<br></code></pre></td></tr></table></figure><p>其实就是一种格式啦，这边直接贴代码方便忘记的时候回来查，就像Java、Go和JavaScript的for都长得不尽相同一样</p>]]></content>
    
    
    
    <tags>
      
      <tag>大学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021，我的大一年终总结</title>
    <link href="/076f5190990a/"/>
    <url>/076f5190990a/</url>
    
    <content type="html"><![CDATA[<h1>2021，我的大一年终总结</h1><p>本来是打算9月8号早上8点发到博客上的，结果这段时间一堆的事情拖着，一直到今晚才有空认真写一下</p><h2 id="简单概括">简单概括</h2><p>进了西二工作室、超算实验室，家教做的风生水起，转专业到了软件工程，又辅修了个金融学（哈哈，大学还没过半，就已经体验过三个专业的课程了），生活质量大改善，换了新电脑，其他设备几乎全数更新，技术水平进一步上升，终于成为一名相对合格的技术宅了，总体稳中向好</p><p>技术栈细节就不说了，这个总结不是技术总结啦</p><h2 id="从2021-09-08到2022-09-08">从2021.09.08到2022.09.08</h2><h3 id="西二在线工作室">西二在线工作室</h3><p>变成西二E届的一员了，也兼职做一些纳新的考核组长啦、服务器运维啦、项目维护开发啦之类的事情，那天面试的时候前端组长问我未来有啥打算，我嘴瓢说我想继续Golang和iOS（因为前面问了很多关于我三个方向三开的问题），忘记说前端要怎么继续努力了，然后回去就看到文档上我的那一栏标了句“以Go和iOS为主”。我一想完蛋，要寄！前端可能进不去了，不过最后进还是进了。</p><p>iOS摸鱼摸着摸着，就要开始尝试维护福大助手了呢，学长都要考研去了，也不好意思天天去问人家，感觉是一个不小的担子</p><p>其实一直打算是重构一下福大助手，几年来这个软件的代码已经慢慢有点屎山的感觉（这是我能说的吗，草）</p><p>最终轮的项目其实并没有写完，因为我项目设计上设计的相对复杂，并没有考虑到我一个人要负责三个方向，同时要在一个月内开发完毕，最终导致iOS App需要继续开发，也挺好的，一个月本身就有点赶工的意思，现在可以静下心来慢慢的打磨软件了，嗯，go和web端也要慢慢打磨，好在这个项目我前期花了很多时间进行架构和设计，最终是在设计和项目架构上拿到了入场门票</p><p>计划是最终轮，也就是Hollow这个项目，用大二上一学期的时间来打磨完，中间还是继续巩固一下一些知识，这个项目吧，考核结束前，有些curd的内容没时间去复制粘贴，有些技术半知不解，单纯为了交作业的话就太没意思了，我一定要把细节给他处理好</p><p>想写的还是蛮多的，不过到写的时候又憋不出来什么，大一参加西二的考核也只是机缘巧合（因为他们的宣传海报刚好贴在了宿舍楼下），真正让我喜欢并且有意愿冲西二，是在圣诞节那段时间，西二送了一张明信片，上面是手写的一句话：</p><p><strong>尊重所有声音，但只成为自己</strong></p><p>比起其他实验室或者工作室，西二才是我最喜欢的地方，因为他天生自带自由的气息，也很酷（字面意义上）</p><h3 id="ACM集训队">ACM集训队</h3><p>收益不好，这两天有个学弟一直来找我问工作室啦实验室啦之类的问题，我总是跟他说acm要好好努力，享受过程，不要追逐名利，结果自己还是有近一个月的时间没有缓过神来（）</p><p>大一的确是懈怠了，而且方向跑偏了，嗯，认真反思吧，后面继续认真写题解，总结算法</p><p>刷题！刷题！刷题！落谷刷500题！CF上橙名！</p><p>虽然中学阶段水过一个省二，不过现在系统的学起来，还是能感觉到差距不少，NOIP可以凭借自己高超的剪枝优化技巧浑水摸鱼，但ACM它只有满分和零分，所以说，学了很多啦</p><p>什么AC自动机fail树上dfs序建可持久化线段树啦，也慢慢的知道内涵了</p><p>总体来说是一个稳中向好的状态，嗯，继续加油！</p><h3 id="超算实验室">超算实验室</h3><p>这两天才面试，不过面试水过了，因为是21级所以就省略了一些流程。</p><p>想报这个实验室首先是因为去年的时候压根没听过这个实验室（转专业的弊端吧，还有SRTP这种东西），再加上他们发布的方向里面有一个系统架构方向，也就是跟运维差不多的意思，嗯，挺符合我的吧，从小就喜欢折腾一些电子垃圾（bushi）</p><p>其实感觉超算才是更加适合我的一条路，我对系统底层的兴趣相较于算法还是更高一些的，同时我个人本身就有长时间的类Unix和Linux系统的使用经历，融入超算不算太难，而且相对于ACM实验室，超算实验室更加的贴近科研论文（？）</p><p>总之，大二还是要努努力学一下超算啦</p><p>说起来，感觉超算莫名亲切（？）</p><h3 id="家教">家教</h3><p>从一开始进中介群（当时才20多个人），到现在已经完整教了2个初三学生毕业，一个一类校一个头部老八所，还是挺满意的，其他的话也断断续续的教了蛮多的学生，不过只带了一段时间，成绩没有什么参考意义，当时仅20多人的中介群发展到现在500人满了又开了一个二群的大群，一年真的能变很多</p><p>而我也很久没有在这个中介群里接单了，后面都是家长帮我带口碑啦，家长传家长什么的，我也就不缺学生了，不过哪天如果又缺的话，我还是会回到中介群接单的</p><p>家教这一块吧，的确赚了蛮多的，生活什么的也改善了非常多，最直观的就是帮我补全了宿舍的智能家居啦，还有Apple全家桶，也算是劳有所获吧</p><p>不过现在已经大二了，马上就要大三了，最多到大三上吧，后面就要准备考研了</p><p>家教给我带来了还是蛮多的，首先是真的很大程度上提升了我的交流水平，最直观的就是现在已经没那么腼腆啦（谁还没有个腼腆的过去？），以及做presentation的时候可以讲得很好（同学反馈，我也不知道好不好，但肯定比没做家教的时候好的多），最主要的是，可以赚钱的同时，重新回忆一下我并不完美的中学生涯。</p><p>还有一个好处，就是加强了我的时间规划啦，还有和长辈的沟通技巧，算是个社畜选修课？稍微讲一下就知道了，早上六点半下床把闹钟摁掉，然后七点起床，洗漱开车到东门进地铁，确保在7点25前，在地铁上备课，然后到树兜后到地铁站旁边的麦当劳吃早餐继续备课，到八点四十坐公交车到学生家里，上到12点后冲到地铁站坐到紫阳给下午一点的学生上课，三点后地铁坐回学校参加4点的见面会。晚上六点半再到宿舍楼隔壁参加一个面试。对于这样一个星期六来说，是非常充实啊…（也不是什么值得骄傲的，有钱的话不是直接滴滴飞来飞去了？）</p><h3 id="生活">生活</h3><p>认识了超多nice的人，自己也在慢慢向nice靠近，情绪上稳定了很多，肯定也开朗多了</p><p>大一的生活在铜盘，基本上过的跟大四一样，有事没事就跑到校外，探一下咖啡店，清吧，或者就坐在便利店里看人来人往，当然海优肯德基疯狂星期四！</p><p>游戏是少打了，csgo基本上是戒掉了，可怜了1400小时的游戏时长。。现在每天在群里侃大山的时候看到他们又在csgo集结或者apex集结什么的，手还是会痒，但是手痒归手痒，每次都说想打，甚至都说要打，但还是挤不出时间了，时间他就算是个海绵，他也不能无穷的挤吧</p><p>打了原神，被舍友带入坑的，不过只氪月卡，纯纯的月卡党，但是最近也没打了，各种事情压着忙不过来，是在没时间继续打了，不过也算小毕业了</p><p>来了旗山后，我时常会骑着电动车去兜风，也经常绕着学校右下角的科技园边开边发呆，落差还是很大的，明明一年零三个月前，还是我，还是这个科技园，我来是为了参加港中深的校考，结果校考过了高考炸了，真的是一个遗憾，可能会很长时间挥之不去了，也就只能绕着圈子发呆</p><p>不过西二和超算最近都在科技园租了个办公场地，以后去科技园应该会更频繁了</p><p>喜欢去科技园也不止是因为上面这些原因，福大的建筑整体还是20年前的，但是科技园是新修的，可以让我有一种错觉，哦，我考上了港中深（），反正我是喜欢这种新的大楼啦，至少设计风格很前沿</p><p>其他的话也没有了，其实我觉得生活这块的篇幅应该比超算还少，我不知道为什么大一这一年我比往年都卷，准备完转专业就直接继续接入工作室和家教什么的安排，我的生活应该就是几个点之间的往返吧（），其实没啥好说的</p><p>哦，还有一个，我经历了一段短暂的实习，是我一个好朋友兼我高中老师推的，就在软件园里面，短短的几十天真的学到了很多，感觉真的自己一瞬间长大了一样，不过这种道不明说不清的感受我也写不出来，就好像一个大一的学生突然悟到大四的感受吧，本来实习应该会继续持续一整个暑假的，可惜后面ACM集训队集训不能请假，只好把实习辞了，不过还是很感谢钟老师给我提供这样一个机会的！</p><h3 id="课业">课业</h3><p>把课业放在最后来讲其实已经说明一些问题啦，没错，GPA没有很高，甚至感觉属于低了。不过这不是我的主攻方向，并没有很难受</p><p>其实大一一进来就没有打算冲课业这方向，因为我觉得计算机这块，卷GPA感觉就很迂腐，你明明可以以其他技术本科工作，何必卷GPA再读个研究生最后发现本硕同薪呢？不过说是这么说，我倒是也没有把专业课和专业基础课丢掉，没错，我没提公共硬课（）</p><p>纵观大一绩点，可以看到是一个两极分化的状态，高的可以和卷王肩并肩，甚至能比他们还高，这些课程主要都是专业课或者专业基础课</p><p>低的话又能很低，什么缺考啦，挂科啦都有过，缺考是因为转了专业后有门课我下学期不用了，懒得去，挂科的课的确是平常没听，然后期末那段时间不能合理的管理好自己的时间，然后没时间预习（就预习了一晚上…），寄了也是理所当然吧，好在都是公共课什么的</p><p>课业这块吧，我还是秉承着大一还没开学的规划，408、854、912规定的科目和书本还是要精读，然后数1、英1在大二和大三上相继完成，然后就是考研啦</p><p>其实保研也蛮香的？大四一年都放假诶（不过听说研0的通常会被拉去实验室打黑工），但是我们学校软件工程保研率差不多在8-10%左右，去年13个名额，7个本校，4个省内985，最好的一个到了华南理工？？emm，考研上限高的确是这么说的，考研数据比保研数据好看了很多</p><p><strong>不过还是懈怠了，毋庸置疑，还是要努力，这学期也做了保证了，绩点必须高，尤其是408的课</strong></p><h2 id="对未来的打算">对未来的打算</h2><p>嗯，没有对未来的打算，我只想脚踏实地，一步一步来，规划什么的，对我这种ddl战士来说，根本不存在</p><p>不过还是有一些中短期内的目标的：</p><ul class="lvl-0"><li class="lvl-2"><p>CET6刷个高分</p></li><li class="lvl-2"><p>过很水的计算机二级</p></li><li class="lvl-2"><p>普通话等级考试拿个甲</p></li><li class="lvl-2"><p>算法题刷题量学期内突破300题</p></li><li class="lvl-2"><p>这学期专业课多，绩点必须给我高</p></li><li class="lvl-2"><p>辅修认真坚持下去</p></li><li class="lvl-2"><p>生活精彩一些，至少有的记录吧~</p></li></ul><p>本来以为工作室和实验室考核都结束了，现在应该已经没什么事了，不过又有一堆考试和事情等着我去做，果然一刻也不能停，<strong>谁让我这学期选了20门课呢</strong> ，每天过的和高四似得，晚上还得加班加点</p><p>现在是2022年9月17日早上1：30，总结完毕，大二继续加油呀</p>]]></content>
    
    
    
    <tags>
      
      <tag>大学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022近代史重点题目-陈亮</title>
    <link href="/c1c2b5eab2ee/"/>
    <url>/c1c2b5eab2ee/</url>
    
    <content type="html"><![CDATA[<h1>近代史</h1><h2 id="如何理解近代中国的基本国情？-如何认识近代史的主流、本质？">如何理解近代中国的基本国情？ / 如何认识近代史的主流、本质？</h2><ol><li class="lvl-3"><p>鸦片战争以来，中国受到资本-帝国主义的侵略，开始沦为半封建半殖民地社会</p></li><li class="lvl-3"><p>随着第二次鸦片战争、甲午中日战争、八国联军侵华战争，中国半殖民地半封建化的程度进一步加深</p></li><li class="lvl-3"><p>为了解决帝国主义与中华民族的矛盾、封建主义和人民大众的矛盾，中国人民不断进行着反帝反封建的革命斗争</p></li></ol><h2 id="近代中国社会的主要矛盾及历史任务">近代中国社会的主要矛盾及历史任务</h2><h3 id="一、两对主要矛盾及其关系：">一、两对主要矛盾及其关系：</h3><ol><li class="lvl-3"><p>帝国主义与中华民族的矛盾</p></li><li class="lvl-3"><p>封建主义和人民大众的矛盾</p></li></ol><p>关系：<code>互相交织</code>，前者是最主要的矛盾。</p><h3 id="二、两大历史任务及其关系：">二、两大历史任务及其关系：</h3><ol><li class="lvl-3"><p>争取民族独立、人民解放的任务</p></li><li class="lvl-3"><p>实现国家爱富强、人民富裕的任务</p></li></ol><p>关系：<code>互相区别又紧密联系</code>，前者是后者的前提和基础</p><h2 id="简述近代中国反侵略战争-旧民主主义革命一再失败的内因">简述近代中国反侵略战争/旧民主主义革命一再失败的内因</h2><ol><li class="lvl-3"><p><code>社会制度的腐败</code>是反侵略战争失败的根本原因</p></li><li class="lvl-3"><p><code>经济技术的落后</code>是反侵略战争失败的另一个重要原因</p></li><li class="lvl-3"><p><code>没能发动广大人民群众</code>进行抗争</p></li></ol><h2 id="结合史实论述外国资本-帝国主义的入侵对中国社会产生的影响">结合史实论述外国资本-帝国主义的入侵对中国社会产生的影响</h2><ol><li class="lvl-3"><p>资本-帝国主义的入侵给中国人民<code>带来了深重的灾难</code></p></li><li class="lvl-3"><p>资本-帝国主义的侵略客观上也多少<code>促进了中国资本主义因素的发展</code>，但仅仅充当了历史的不自觉的工具</p></li></ol><h2 id="简述旧民主主义革命阶段中国各阶级提出的救国主张">简述旧民主主义革命阶段中国各阶级提出的救国主张</h2><ol><li class="lvl-3"><p>地主阶级改革派——经世致用，师夷长技以制夷</p></li><li class="lvl-3"><p>农民阶级——平均平等，耕者有其田</p></li><li class="lvl-3"><p>地主阶级洋务派——中学为体，西学为用</p></li><li class="lvl-3"><p>资产阶级改良派——维新变法，君主立宪</p></li><li class="lvl-3"><p>资产阶级革命派——推翻专制，创建共和</p></li></ol><h2 id="如何理解辛亥革命是一次比较完全意义上的资产阶级民主革命">如何理解辛亥革命是一次比较完全意义上的资产阶级民主革命</h2><ol><li class="lvl-3"><p>辛亥革命推翻了封建势力的代表和帝国主义的代理人清王朝</p></li><li class="lvl-3"><p>辛亥革命结束了两千多年的君主专制，建立了中国历史上第一个资产阶级共和国政府</p></li><li class="lvl-3"><p>辛亥革命推动了中国人民的思想解放，民主共和观念深入人心</p></li><li class="lvl-3"><p>辛亥革命推动了中国的社会变革</p></li><li class="lvl-3"><p>辛亥革命推动了亚洲各国民族解放运动的高涨</p></li></ol><p><code>推翻封建势力和帝国主义代表，结束君主专制，建立共和政府，推动思想解放、社会变革、各国民族解放运动</code></p><h2 id="比较新旧三民主义的异同">比较新旧三民主义的异同</h2><table><thead><tr><th></th><th>旧三民主义</th><th>新三民主义</th></tr></thead><tbody><tr><td><strong>民族</strong></td><td>反满</td><td>反帝</td></tr><tr><td><strong>民权</strong></td><td>推翻帝制，创立民国</td><td>民主权利为一般平民共有，不应为少数人所私</td></tr><tr><td><strong>民生</strong></td><td>核定地价，现有地价归原主，革命增价归国家</td><td>耕者有其田，节制资本</td></tr></tbody></table><p>民族：形成了明确的反帝纲领</p><p>民权：强调普遍平等的民权</p><p>民生：增加节制资本的内容</p><h2 id="五四运动的意义">五四运动的意义</h2><ol><li class="lvl-3"><p>五四运动是<code>一场伟大的爱国革命运、社会革命运动、思想启蒙运动和新文化运动</code></p></li><li class="lvl-3"><p>五四运动是<code>旧民主主义革命走向新民主主义革命的转折点</code></p></li><li class="lvl-3"><p>五四运动<code>孕育了以爱国、进步、民主、科学为主要内容的伟大五四精神</code>，其核心是爱国主义</p></li><li class="lvl-3"><p>五四运动<code>改变了</code>以往<code>只有</code>觉悟的<code>革命者</code>而<code>缺少</code>觉醒的<code>人民大众的斗争情况</code>，<code>实现了</code>中国人民和中华民族自鸦片战争以来的<code>第一次全面觉醒</code></p></li></ol><h2 id="为什么说中国共产党成立是“开天辟地的大事变”？">为什么说中国共产党成立是“开天辟地的大事变”？</h2><ol><li class="lvl-3"><p>中国从此有了先进的坚强的政党作为凝聚力量的领导核心</p></li><li class="lvl-3"><p>中国人民从此踏上了争取民族独立、自身解放的光明道路，开启了实现国家富强、人民富裕的历史征程</p></li><li class="lvl-3"><p>深刻改变了近代以后中华民族发展的方向和进程，深刻改变了中国人民和中华民族的前途和命运，深刻改变了世界发展的趋势和格局</p></li></ol><h2 id="论述五四时期中国先进分子为什么和怎么样选择了马克思主义">论述五四时期中国先进分子为什么和怎么样选择了马克思主义</h2><ol><li class="lvl-3"><p>历史昭示，为了争取民族独立和人民解放，必须运用新的思想武器。旧民主主义革命的实践证明（太平填过、洋务派、维新派、资产阶级革命派），各个阶级的政治主张都没有也不可能为中国人民找到一条真正的出路，中国人民<code>需要运用新的革命理论与方法</code>把中华民族引向复兴和富强</p></li><li class="lvl-3"><p>马克思主义<code>满足了中国革命既要反帝又要反封建的双重诉求。</code>中国先进分子经过比较、探求（巴黎和会与五四运动的刺激；三次论战），在形形色色的主义中选择了马克思主义</p></li><li class="lvl-3"><p>马克思主义作为一种外来文化<code>与中国传统文化具有一定的相融性</code>。（社会理想：大同思想与共产主义；政治观念：民本思想与无产阶级专政；历史观：勇于斗争和阶级斗争；价值观：家族本位与集体主义）</p></li></ol><h2 id="八七会议的内容及其历史意义-1927-08-07">八七会议的内容及其历史意义(1927.08.07)</h2><h3 id="内容">内容</h3><p>​1927年8月7日，中共中央在汉口秘密召开紧急会议，会议：</p><ol><li class="lvl-3"><p>彻底清算了陈独秀右倾机会主义的错误</p></li><li class="lvl-3"><p>确定了土地革命和武装反抗国民党的总方针</p></li><li class="lvl-3"><p>毛泽东在会上着重阐述了<code>党必须依靠农民和掌握枪杆子</code>的思想</p></li></ol><h3 id="意义">意义</h3><p>​使中国共产党在政治上大大前进了一步，开始了从大革命失败到土地革命战争兴起的转折</p><h2 id="古田会议的内容及其历史意义-1929-12">古田会议的内容及其历史意义(1929.12)</h2><p>​1929年12月，红四军党的第九次代表会议在福建上杭县古田村召开</p><ol><li class="lvl-3"><p><code>古田会议决议</code>是中国共产党和红军建设的纲领性文献，是党和人民军队建设史上的重要里程碑</p></li><li class="lvl-3"><p>古田会议确立了<code>马克思主义建党建军原则</code>，创造性地解决了在农村环境中，在党组织和军队以农民为主要成分的条件下，如何保持党的无产阶级先锋队性质和建设党领导的新型人民军队的重大问题</p></li><li class="lvl-3"><p><code>党对军队的绝对领导</code>，是人民军队区别于一切旧军队的政治特质和根本优势，对中国革命新道路的开辟和坚持具有重要意义</p></li></ol><h2 id="遵义会议的内容及其历史意义-1935-01">遵义会议的内容及其历史意义(1935.01)</h2><h3 id="内容：">内容：</h3><p>​1935年1月遵义会议的召开：</p><ol><li class="lvl-3"><p><code>集中解决了当时具有决定意义的军事问题和组织问题</code>，批评了博古、李德在第五次反“围剿”中的错误</p></li><li class="lvl-3"><p><code>成立了由周恩来、毛泽东、王稼祥组成的新的三人团</code>、全权负责红军的军事行动</p></li><li class="lvl-3"><p>开始<code>确立以毛泽东为代表的马克思主义的正确路线在中共中央的领导地位</code>，在极其危险的情况下挽救了中国共产党、挽救了中国工农红军、挽救了中国革命</p></li></ol><h3 id="意义：">意义：</h3><p>​会议的一系列重大决策，是在中国共产党同共产国际的联系中断的情况下独立自主地作出的，<code>标志着党由幼稚走向成熟</code></p><h2 id="中国国民党性质的转变">中国国民党性质的转变</h2><ol><li class="lvl-3"><p>第一次国共合作期间，国民党是<code>工人、农民、城市小资产阶级和民族阶级的革命联盟</code></p></li><li class="lvl-3"><p>大革命失败以后，国民党成为了一个<code>代表地主阶级为和买办性的大资产阶级所控制的政党</code></p></li></ol><h2 id="二十世纪20、30年代中国共产党内连续出现三次左倾错误的原因">二十世纪20、30年代中国共产党内连续出现三次左倾错误的原因</h2><ol><li class="lvl-3"><p>社会原因：处于半殖民地半封建社会的中国共产党长期处于小资产阶级的包围之中，并且党内小资产阶级出身的党员也占很大比重</p></li><li class="lvl-3"><p>主观原因：当时全党的马克思理论准备不足，理论素养不高，实践经验也很缺乏</p></li><li class="lvl-3"><p>国际原因：共产国际对中国共产党内部事务的错误干预和不当指挥</p></li><li class="lvl-3"><p>历史原因：八七会议以后党内一直存在着的浓厚的左倾情绪始终没有得到认真的清理</p></li></ol><h2 id="如何认识中国革命新道路">如何认识中国革命新道路</h2><ol><li class="lvl-3"><p>大革命失败后，为了坚持中国革命，中国共产党独自探索革命新道路</p></li><li class="lvl-3"><p>井冈山根据地的建立，点燃了工农武装割据的星星之火，开辟了<code>农村包围城市、武装夺取政权的正确道路</code></p></li><li class="lvl-3"><p>正是沿着这条独特的道路，中国共产党领导革命走向复兴并逐步赢得胜利</p></li><li class="lvl-3"><p>采取“<code>发展进步势力、争取中间势力、孤立顽固势力</code>”的策略方针，<code>坚持、巩固和扩大了抗日民族统一战线</code>，为坚持抗战、争取胜利提供了重要的政治基础</p></li><li class="lvl-3"><p><code>对抗日民主根据地的建设</code>（三三制民主政权建设、减租减息发展生产，文化教育建设）<code>以及加强中国共产党的自身建设</code>（提出马克思主义中国化的命题、延安整风运动在全党确立了实事求是的思想路线），勾画了未来新中国的蓝图</p></li></ol><h2 id="论述国民党在抗战中的地位和作用">论述国民党在抗战中的地位和作用</h2><p>国民党在其正面战场对抗战的胜利做出了重要贡献：</p><ol><li class="lvl-3"><p>国民党接受团结抗战的主张，使全民族抗战得以实现</p></li><li class="lvl-3"><p>抗战初期国民党在正面战场积极作战</p></li><li class="lvl-3"><p>抗战中后期国民党实行“消极抗日、积极反共”的方针</p></li></ol><h2 id="论述共产党在抗战中的地位和作用">论述共产党在抗战中的地位和作用</h2><p>中国共产党是全民族抗战的中流砥柱：</p><ol><li class="lvl-3"><p>率先举起武装抗日的旗帜，<code>制定全面的全民族抗战的路线</code>（人民战争路线和持久战的战略方针），为坚持抗战，争取胜利指明了方向</p></li><li class="lvl-3"><p>开展独立自主的<code>敌后游击战争</code>，开辟和巩固、扩大了<code>抗日根据地</code>，对坚持抗战、争取胜利发挥了伟大的战略作用</p></li><li class="lvl-3"><p>组织和推动<code>国民党统治区的抗日民主运动</code>，对于激发大后方人民的爱国热情、坚持国共合作抗日的局面和支援抗战前线等发挥了重要作用</p></li></ol><h2 id="简述《论持久战》的内容和意义（P146）（1935-5-1935-6）">简述《论持久战》的内容和意义（P146）（1935.5-1935.6）</h2><h3 id="内容-2">内容</h3><p>​1935年5月-6月间毛泽东发表《论持久战》的讲演，总结全民族抗战10个月来的经验，批驳了“亡国论”“速胜论”等错误观点，系统地阐明了持久战方针</p><ol><li class="lvl-3"><p>中日战争是半殖民地半封建的中国和帝国主义的日本之间于20世纪30年代进行的一个决死的战争。</p></li><li class="lvl-3"><p>日本强中国弱，决定了抗日战争只能是持久战</p></li><li class="lvl-3"><p>日本小国发动进攻，国际上失道寡助；中国大国进行反侵略战争，国际上得道多助</p></li><li class="lvl-3"><p>中国已经有了代表民族和人民根本利益，政治上成熟的中国共产党及其领导的抗日根据地和人民军队</p></li><li class="lvl-3"><p>最后中国会胜</p></li><li class="lvl-3"><p><code>兵民是胜利之本</code>。战胜日本侵略，必须进行人民战争</p></li><li class="lvl-3"><p>抗日战争将经过<code>战略防御、战略相持、战略反攻三阶段</code>。战略相持阶段最为关键</p></li></ol><h2 id="意义-2">意义</h2><p>​系统阐明了抗日战争的发展规律和坚持抗战、争取抗战胜利必须实行的战略总方针，是中国共产党领导抗日战争的纲领性文献，对全国抗战的战略指导产生了积极影响</p><h2 id="简述敌后战场-游击战争的战略地位和作用">简述敌后战场/游击战争的战略地位和作用</h2><ol><li class="lvl-3"><p><code>战略防御阶段</code>，敌后战场/游击战争迫使敌人把用于进攻的兵力调回来保守其占领区，<code>减轻正面战场压力</code></p></li><li class="lvl-3"><p><code>战略相持阶段</code>，敌后战场/游击战争成为主要的抗日作战空间/方式，逐步改变了敌强我弱的态势，<code>为战略反攻创造条件</code></p></li></ol><h2 id="如何理解没有共产党就没有新中国（P186）">如何理解没有共产党就没有新中国（P186）</h2><h2 id="简述一化三改造-过渡时期总路线的主要内容">简述一化三改造/过渡时期总路线的主要内容</h2><ol><li class="lvl-3"><p>1953年提出过渡时期总路线：要在一个相当长的时间内，逐步实现<code>社会主义工业化</code>，逐步实现<code>对农业、手工业和资本主义工商业的社会主义改造</code></p></li><li class="lvl-3"><p>一化三改造互相联系，互相促进，互相制约，<code>体现了发展生产力和改革生产关系的有机统一</code>，是一条社会主义建设和社会主义改造同时并举的路线</p></li></ol><h2 id="如何认识社会主义制度建立的重大意义（P211）">如何认识社会主义制度建立的重大意义（P211）</h2><p>​中华人民共和国成立、社会主义制度的确立，是中华民族有史以来最为广泛而深刻的社会变革，为当代中国一切发展进步奠定了根本政治前提和制度基础，为中国发展富强、中国人民生活富裕奠定了坚实基础，实现了中华民族由不断衰落到根本扭转命运、持续走向繁荣富强的伟大飞跃。</p><ol><li class="lvl-3"><p>社会主义基本制度的确立极大提高了工人阶级和广大劳动人民的积极性、创造性，<code>为社会生产力的大发展开辟了广阔道路</code></p></li><li class="lvl-3"><p>社会主义基本制度的确立<code>为当代中国一切发展进步提供了根本政治保障</code></p></li><li class="lvl-3"><p>社会主义基本制度的确立<code>为社会主义先进文化的发展指明了前进方向</code></p></li></ol><h2 id="为什么说中共十一届三中全会是新中国成立以来的伟大历史转折-1978-12">为什么说中共十一届三中全会是新中国成立以来的伟大历史转折(1978.12)</h2><p>​1978年12月召开的中共十一届三中全会是新中国成立以阿里的伟大历史转折，因为它：</p><ol><li class="lvl-3"><p>彻底否定了“两个凡是”错误方针，果断停用“以阶级斗争为纲”的口号，作出了把工作重点转移到社会主义现代化建设上来和实行改革开放的战略决策，恢复了民主集中制的优良传统</p></li><li class="lvl-3"><p>标志着中国共产党<code>重新确立了马克思主义的思想路线、政治路线、组织路线</code>，开始了在思想、政治、组织等领域的全面拨乱反正</p></li><li class="lvl-3"><p>实际形成了以邓小平为核心的党的中央领导集体，<code>中国开始进入改革开放和社会主义现代化建设的历史新时期</code></p></li></ol><h2 id="如何认识改革开放前30年和后40年之间的关系？">如何认识改革开放前30年和后40年之间的关系？</h2><ol><li class="lvl-3"><p>一脉相承：<code>本质上都是党领导人民进行社会主义建设的实践探索</code>，前30年建立起社会主义基本制度，后40年开创了中国特色社会主义历史新时期</p></li><li class="lvl-3"><p>辩证统一：不能用改革开放后的历史时期否定改革开放前的历史时期，也不能用改革开放前的历史时期否定改革开放后的历史时期（<code>不能否定二者</code>）</p></li><li class="lvl-3"><p>两个时期<code>相互联系又有重大区别</code>，共同构筑了新中国70年的道路</p></li></ol><h2 id="为什么要改革开放，怎么理解？">为什么要改革开放，怎么理解？</h2><ol><li class="lvl-3"><p>文革后生产力发展缓慢、人民温饱难以解决、科技教育落后的局面需要改变</p></li><li class="lvl-3"><p>高度集中的计划经济体制已经成为生产力发展的严重阻碍</p></li><li class="lvl-3"><p>社会主义制度需要自我完善和发展</p></li></ol><h2 id="简述近代以来中国社会主要矛盾的演变">简述近代以来中国社会主要矛盾的演变</h2><ol><li class="lvl-3"><p>1840-1949年，中国社会的主要矛盾是<code>帝国主义与中华民族的矛盾和封建主义同人民大众的矛盾</code></p></li><li class="lvl-3"><p>1949-1956年过渡时期，主要矛盾转变为<code>工人阶级与资产阶级、社会主义道路与资本主义道路之间的矛盾</code></p></li><li class="lvl-3"><p>1956年社会主义改造完成之后，主要矛盾是<code>人民对于经济文化迅速发展的需要同当前经济文化不能满足人民需要的状况之间的矛盾</code></p></li><li class="lvl-3"><p>改革开放以来，我国所要解决的主要矛盾是<code>日益增长的物质文化需要同落后的社会生产之间的矛盾</code></p></li><li class="lvl-3"><p>2017年十九大报告指出，中国特色社会主义进入新时代，我国社会主要矛盾已经转化为<code>人民日益增长的美好生活需要和不平衡不充分的发展之间的矛盾</code></p></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>大学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】HDU-1846 Brave Game</title>
    <link href="/72a5f259e3aa/"/>
    <url>/72a5f259e3aa/</url>
    
    <content type="html"><![CDATA[<h1>HDU-1846 Brave Game</h1><p>HDU：<a href="https://acm.hdu.edu.cn/showproblem.php?pid=1846">https://acm.hdu.edu.cn/showproblem.php?pid=1846</a></p><h2 id="题目">题目</h2><blockquote><p>十年前读大学的时候，中国每年都要从国外引进一些电影大片，其中有一部电影就叫《勇敢者的游戏》（英文名称：Zathura），一直到现在，我依然对于电影中的部分电脑特技印象深刻。今天，大家选择上机考试，就是一种勇敢（brave）的选择；这个短学期，我们讲的是博弈（game）专题；所以，大家现在玩的也是“勇敢者的游戏”，这也是我命名这个题目的原因。当然，除了“勇敢”，我还希望看到“诚信”，无论考试成绩如何，希望看到的都是一个真实的结果，我也相信大家一定能做到的~</p><p>各位勇敢者要玩的第一个游戏是什么呢？很简单，它是这样定义的：<br>1、 本游戏是一个二人游戏;<br>2、 有一堆石子一共有n个；<br>3、 两人轮流进行;<br>4、 每走一步可以取走1…m个石子；<br>5、 最先取光石子的一方为胜；</p><p>如果游戏的双方使用的都是最优策略，请输出哪个人能赢。</p></blockquote><h2 id="思路">思路</h2><p>巴什博奕例题，结论如下</p><p>$$ n%(m+1)==0 $$</p><p>其中n是这一堆石子的个数，m是最多可以取的石子数，<strong>当满足上述公式时，先手必败</strong></p><h2 id="分析">分析</h2><p>这一部分摘自文章结尾Ref里ACMBook关于巴什博弈的分析，我觉得写的非常棒啊！！</p><p>我们称先进行游戏的人为先手，另一个人为后手。</p><p>1.若</p><p>$$ n=m+1 $$</p><p>由于一次最多只能拿m个，因此不论先手怎么拿（甚至拿1个），后手永远都能全部拿走剩下的内容，后者必赢</p><p>2.若</p><p>$$ n=(m+1)*r+s $$</p><p>其中<code>r为任意自然数，s&lt;=m</code>先手拿走s个物品，若后手拿走<code>k(k&lt;=m)</code>个，那么先手再拿走<code>m+1-k</code>个，结果又剩下了<code>(m+1)*(r-1)</code>个，回到最初的起点！因此如果出现上述公式情形，先手是必赢的。</p><p>因此，<strong>只要给对手留下(m+1)的倍数，那么我们必定会赢</strong></p><p>最近好累啊。。</p><h2 id="代码">代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief HDU - 1846 Brave Game Bash博弈</span><br><span class="hljs-comment"> * @date 2022-05-07</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 200001</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">int</span> c;<br><span class="hljs-type">int</span> m, n;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;c);<br>    <span class="hljs-keyword">while</span> (c-- &amp;&amp; ~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;n, &amp;m))<br>        <span class="hljs-built_in">puts</span>(n % (m + <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;second&quot;</span> : <span class="hljs-string">&quot;first&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="References">References</h2><p><a href="https://hrbust-acm-team.gitbooks.io/acm-book/content/game_theory/ba_shi_bo_yi.html">https://hrbust-acm-team.gitbooks.io/acm-book/content/game_theory/ba_shi_bo_yi.html</a></p>]]></content>
    
    
    <categories>
      
      <category>HDU题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>博弈论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】HDU-2176 取(m堆)石子游戏</title>
    <link href="/c233f4c322d4/"/>
    <url>/c233f4c322d4/</url>
    
    <content type="html"><![CDATA[<h1>HDU-2176 HDU-1850 取(m堆)石子游戏</h1><p>【HDU-2176】HDU：<a href="https://acm.hdu.edu.cn/showproblem.php?pid=2176">https://acm.hdu.edu.cn/showproblem.php?pid=2176</a><br>【HDU-1850】HDU：<a href="https://acm.hdu.edu.cn/showproblem.php?pid=1850">https://acm.hdu.edu.cn/showproblem.php?pid=1850</a></p><h2 id="题目（HDU-2176）">题目（HDU-2176）</h2><blockquote><p>m堆石子,两人轮流取.只能在1堆中取.取完者胜.先取者负输出No.先取者胜输出Yes,然后输出怎样取子.例如5堆 5,7,8,9,10先取者胜,先取者第1次取时可以从有8个的那一堆取走7个剩下1个,也可以从有9个的中那一堆取走9个剩下0个,也可以从有10个的中那一堆取走7个剩下3个.</p></blockquote><h2 id="思路">思路</h2><p>首先是，HDU-2176和HDU-1850这两题本质是一样的（包括代码）</p><p>Nim游戏<strong>先手必败</strong>条件：</p><p>$$ a_1 \oplus a_2 \oplus a_3 \oplus a_4 \oplus … \oplus a_n = 0 $$</p><p>具体过程在Ref里写的很棒啦</p><p>而不论是HDU-2176还是HDU-1850，都要求如果先手必胜，那么输出怎样取石子（或者说是输出获胜的情况）</p><p>注意，这时候我们已经拿到ANS的值了（而且必定不为0），我们需要做的是，改变某一堆的数量<code>ai</code>为<code>ai'</code>，使得先手必胜变为先手必败（注意，之所以要让先手必胜局面变成先手必败局面，因为第二次是对方取石子，要让对方处于必败局面才可以），也就是说，改变这堆石头后，再进行异或运算，得出的ANS是0</p><p>而我们知道，异或同一个数字，答案是0</p><p>$$ ans \oplus ans = 0 $$</p><p>因此我们只需要作出如下更改：</p><p>$$ ai’=ai \oplus ans $$</p><p>代入原公式，答案就是0了，同时我们保证<code>ai'&lt;ai</code>，因为我们是拿走石头</p><p>这样，代码就不难了</p><h2 id="代码">代码</h2><h3 id="HDU-2176">HDU-2176</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief HDU - 2176  取(m堆)石子游戏 Nim游戏</span><br><span class="hljs-comment"> * @date 2022-05-06</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 200001</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">int</span> m;<br><span class="hljs-type">int</span> list[MAXN]; <span class="hljs-comment">// list[MAXN] 表示石头堆</span><br><span class="hljs-type">int</span> ans;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">while</span> (~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;m) &amp;&amp; m)<br>    &#123;<br>        ans = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> tmp;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>        &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;list[i]);<br>            ans ^= list[i];<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (!ans)<br>        &#123;<br>            <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes&quot;</span>);<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>        &#123;<br>            tmp = ans ^ list[i];<br>            <span class="hljs-keyword">if</span> (list[i] &gt; tmp)<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d\n&quot;</span>, list[i], tmp);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="HDU-1850">HDU-1850</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief HDU - 1850 Being a Good Boy in Spring Festival Nim游戏</span><br><span class="hljs-comment"> * @date 2022-05-07</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 200001</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">int</span> m;<br><span class="hljs-type">int</span> list[MAXN]; <span class="hljs-comment">// list[MAXN] 表示石头堆</span><br><span class="hljs-type">int</span> ans;<br><span class="hljs-type">int</span> ansNum;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">while</span> (~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;m) &amp;&amp; m)<br>    &#123;<br>        ans = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> tmp;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>        &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;list[i]);<br>            ans ^= list[i];<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (!ans)<br>        &#123;<br>            <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;0&quot;</span>);<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        ansNum=<span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>        &#123;<br>            tmp = ans ^ list[i];<br>            <span class="hljs-keyword">if</span> (list[i] &gt; tmp)<br>                ansNum++;<br>        &#125;<br><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,ansNum);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="References">References</h2><p><a href="https://zh.wikipedia.org/zh-sg/%E5%B0%BC%E5%A7%86%E6%B8%B8%E6%88%8F">https://zh.wikipedia.org/zh-sg/尼姆游戏</a><br><a href="https://blog.csdn.net/qq_45458915/article/details/102693126">https://blog.csdn.net/qq_45458915/article/details/102693126</a></p>]]></content>
    
    
    <categories>
      
      <category>HDU题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>博弈论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】HDU-2516 取石子游戏</title>
    <link href="/7e25f67522dc/"/>
    <url>/7e25f67522dc/</url>
    
    <content type="html"><![CDATA[<h1>HDU-2516 取石子游戏</h1><p>HDU：<a href="https://acm.hdu.edu.cn/showproblem.php?pid=2516">https://acm.hdu.edu.cn/showproblem.php?pid=2516</a></p><h2 id="题目">题目</h2><blockquote><p>1堆石子有n个,两人轮流取.先取者第1次可以取任意多个，但不能全部取完.以后每次取的石子数不能超过上次取子数的2倍。取完者胜.先取者负输出&quot;Second win&quot;.先取者胜输出&quot;First win&quot;.</p></blockquote><h2 id="思路">思路</h2><p>这是关于<strong>斐波那契博弈</strong>的题，结论是：</p><blockquote><p>若N为Fibonacci数，则先手必胜</p></blockquote><p>可以直接用结论做题，没有代码含量</p><h2 id="证明">证明</h2><p>首先需要有一个数论基础</p><blockquote><p>任何正整数都可以表示为若干个不连续的Fibonacci数之和</p><p>Fibonacci性质：</p><ol><li class="lvl-3"><p>$$ f(n) = f(n-2)+f(n-1) $$</p></li><li class="lvl-3"><p>$$ 2f(n)&gt;f(n+1) $$</p></li><li class="lvl-3"><p>$$ 4f(n)&lt;3f(n+1) $$</p></li></ol></blockquote><h3 id="若N为Fibonacci数">若N为Fibonacci数</h3><p>当<code>n=1</code>时，<code>f(n)</code>=2，无论怎么拿，先拿的必定输</p><p>当<code>n=2</code>时，<code>f(n)</code>=3，无论怎么拿，先拿的必定输</p><p>现在假设当<code>n=k</code>时满足结论（结论在前面），则当<code>n=k+1</code>时，我们可以由性质得出</p><p>$$ f(k+1)=f(k-1)+f(k)&lt;f(k-1)+2f(k-1) = 3f(k-1) $$</p><p>也就是</p><p>$$ f(k+1)&lt;3f(k-1) $$</p><p>这时候，如果先手直接拿走<code>f(k-1)</code>个，那么这一堆剩下的就没比<code>2f(k-1)</code>个少，后手可以直接拿走，因此先手的如果要赢，必须拿少于<code>f(k-1)</code>个，而因为这个假设已经是<code>n=k</code>的情况了，那么<code>n=k-1</code>是已经被证明满足结论的了，因此，如果先拿<code>f(k-1)</code>个的话，先手必定输，这个推导过程同样适用于<code>f(k)</code>的情况。</p><h3 id="若N不为Fibonacci数">若N不为Fibonacci数</h3><p>由先前的数论基础我们可以知道，任何正整数均可以表示为若干个不连续的Fibonacci数之和。也就是说，对于这样的n，我们可以把它改成：</p><p>$$ n=f(a_n)+f(a_{n-1})+…+f(a_1) $$</p><p>假设先手拿走了<code>f(a1)</code>这一堆。由于Fibonacci数不连续，则</p><p>$$ f(a_2)&gt;f(a_1)+1 $$</p><p>也就是说</p><p>$$ f(a_2)&gt;2f(a_1) $$</p><p>这里假设<code>a1=1,a2=3</code>就可以验证这个结论的正确性（因为不是连续的数，而且我们选取的数是整个Fibonacci数列中最相近的数）熟悉吗？后手不可能直接把<code>f(a2)</code>堆拿完，一定会有剩的，那么这时候又轮到我们先手了，这时候我们就可以把剩下的全部拿走了</p><h3 id="结论">结论</h3><p><strong>若N为Fibonacci数，则先手必胜</strong></p><h2 id="代码">代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief HDU - 2516 取石子游戏 Fibonacci博弈</span><br><span class="hljs-comment"> * @date 2022-05-05</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 100001</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">int</span> n;<br>ll Fibonacci[MAXN] = &#123;<span class="hljs-number">0</span>&#125;;<br><span class="hljs-type">bool</span> ans;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    Fibonacci[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    Fibonacci[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt; MAXN; i++)<br>        Fibonacci[i] = Fibonacci[i - <span class="hljs-number">1</span>] + Fibonacci[i - <span class="hljs-number">2</span>];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">init</span>();<br>    <span class="hljs-keyword">while</span> (~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n) &amp;&amp; n)<br>    &#123;<br>        ans = <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; MAXN; i++)<br>            <span class="hljs-keyword">if</span> (Fibonacci[i] == n)<br>            &#123;<br>                ans = <span class="hljs-literal">true</span>;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br><br>        <span class="hljs-built_in">puts</span>(ans ? <span class="hljs-string">&quot;Second win&quot;</span> : <span class="hljs-string">&quot;First win&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="References">References</h2><p><a href="https://blog.csdn.net/ACdreamers/article/details/8586135">https://blog.csdn.net/ACdreamers/article/details/8586135</a><br><a href="https://blog.csdn.net/l1832876815/article/details/81136041">https://blog.csdn.net/l1832876815/article/details/81136041</a><br><a href="https://www.cnblogs.com/jiu0821/p/4638165.html">https://www.cnblogs.com/jiu0821/p/4638165.html</a></p>]]></content>
    
    
    <categories>
      
      <category>HDU题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>博弈论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】HDU-1527 HDU-2177 取(2堆)石子游戏</title>
    <link href="/d71b2d6cbfd5/"/>
    <url>/d71b2d6cbfd5/</url>
    
    <content type="html"><![CDATA[<h1>HDU-1527 HDU-2177 取(2堆)石子游戏</h1><p>【HDU-1527】HDU：<a href="https://acm.hdu.edu.cn/showproblem.php?pid=1527">https://acm.hdu.edu.cn/showproblem.php?pid=1527</a><br>【HDU-2177】HDU：<a href="https://acm.hdu.edu.cn/showproblem.php?pid=2177">https://acm.hdu.edu.cn/showproblem.php?pid=2177</a></p><h2 id="题目">题目</h2><blockquote><p>有两堆石子，数量任意，可以不同。游戏开始由两个人轮流取石子。游戏规定，每次有两种不同的取法，一是可以在任意的一堆中取走任意多的石子；二是可以在两堆中同时取走相同数量的石子。最后把石子全部取完者为胜者。现在给出初始的两堆石子的数目，如果轮到你先取，假设双方都采取最好的策略，问最后你是胜者还是败者。如果你胜，你第1次怎样取子?</p></blockquote><h2 id="思路">思路</h2><p>这道题是关于威佐夫博弈的题，威佐夫博弈抛去理论（理论附在Ref里了），我们只需要知道如何判定先手必败</p><p>$$ (y-x)\times \frac{\sqrt5 +1}{2} = x \qquad(x&gt;y)$$</p><p>其中x和y分别表示两堆石子的数目，知道这个内容后这个代码就非常简单了。</p><p><strong>但是有一个需要注意的地方：第一次你拿了之后，下一次是对手拿，而我们这时候就不能再判先手必胜为胜利情况了，而是先手必败为胜利情况</strong></p><p><strong>还有，我们不需要考虑第几回合这种情况，就拿同时取石子举例，如果同时取3个石子我们就能赢，但我们非要先拆成取1次再取2次，那跟第一次取3次有区别吗？并没有，要考虑的是奇数次还是偶数次的情况</strong></p><h2 id="代码">代码</h2><h3 id="HDU-1527">HDU-1527</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief HDU - 1527  取石子游戏 Wythoff博弈</span><br><span class="hljs-comment"> * @date 2022-05-04</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">int</span> a, b;<br><span class="hljs-type">double</span> g = (<span class="hljs-built_in">sqrt</span>(<span class="hljs-number">5.0</span>) + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">bool</span> print)</span> <span class="hljs-comment">//返回先手是否会获胜的情况</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (x &gt; y)<br>        <span class="hljs-built_in">swap</span>(x, y);<br>    <span class="hljs-type">bool</span> ans = !(<span class="hljs-built_in">int</span>((y - x) * g) == x);<br><br>    <span class="hljs-keyword">if</span> (!ans &amp;&amp; print)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d\n&quot;</span>, x, y);<br><br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">while</span> (~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;a, &amp;b) &amp;&amp; a + b)<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-built_in">check</span>(a, b, <span class="hljs-literal">false</span>) ? <span class="hljs-string">&quot;1&quot;</span> : <span class="hljs-string">&quot;0&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="HDU-2177">HDU-2177</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief HDU - 2177  取(2堆)石子游戏 Wythoff博弈</span><br><span class="hljs-comment"> * @date 2022-05-04</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">int</span> a, b;<br><span class="hljs-type">double</span> g = (<span class="hljs-built_in">sqrt</span>(<span class="hljs-number">5.0</span>) + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">bool</span> print)</span> <span class="hljs-comment">//返回先手是否会获胜的情况</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (x &gt; y)<br>        <span class="hljs-built_in">swap</span>(x, y);<br>    <span class="hljs-type">bool</span> ans = !(<span class="hljs-built_in">int</span>((y - x) * g) == x);<br><br>    <span class="hljs-keyword">if</span> (!ans &amp;&amp; print)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d\n&quot;</span>, x, y);<br><br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">while</span> (~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;a, &amp;b) &amp;&amp; a + b)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">check</span>(a, b, <span class="hljs-literal">false</span>))<br>        &#123;<br>            <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;1&quot;</span>);<br><br>            <span class="hljs-comment">//两边同时取石子</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= a; i++)<br>                <span class="hljs-built_in">check</span>(a - i, b - i, <span class="hljs-literal">true</span>);<br><br>            <span class="hljs-comment">//从任意一堆里取，这里我们只需要选择大的堆</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= b; i++)<br>                <span class="hljs-built_in">check</span>(a, b - i, <span class="hljs-literal">true</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;0&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="References">References</h2><p><a href="https://www.cnblogs.com/zwfymqz/p/8469863.html">https://www.cnblogs.com/zwfymqz/p/8469863.html</a><br><a href="https://zh.m.wikipedia.org/zh-sg/%E5%A8%81%E4%BD%90%E5%A4%AB%E6%B8%B8%E6%88%8F">https://zh.m.wikipedia.org/zh-sg/威佐夫游戏</a></p>]]></content>
    
    
    <categories>
      
      <category>HDU题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>博弈论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】POJ-3159 Candies 卡Queue+SPFA与Vector</title>
    <link href="/c66f9f8bda20/"/>
    <url>/c66f9f8bda20/</url>
    
    <content type="html"><![CDATA[<h1>POJ-3159 Candies</h1><p>POJ:<a href="http://poj.org/problem?id=3159">http://poj.org/problem?id=3159</a></p><h2 id="题目">题目</h2><blockquote><p>During the kindergarten days, flymouse was the monitor of his class. Occasionally the head-teacher brought the kids of flymouse’s class a large bag of candies and had flymouse distribute them. All the kids loved candies very much and often compared the numbers of candies they got with others. A kid A could had the idea that though it might be the case that another kid B was better than him in some aspect and therefore had a reason for deserving more candies than he did, he should never get a certain number of candies fewer than B did no matter how many candies he actually got, otherwise he would feel dissatisfied and go to the head-teacher to complain about flymouse’s biased distribution.</p><p>snoopy shared class with flymouse at that time. flymouse always compared the number of his candies with that of snoopy’s. He wanted to make the difference between the numbers as large as possible while keeping every kid satisfied. Now he had just got another bag of candies from the head-teacher, what was the largest difference he could make out of it?</p></blockquote><table><thead><tr><th>Time Limit</th><th>Memory Limit</th></tr></thead><tbody><tr><td>1500 ms</td><td>131072 kB</td></tr></tbody></table><h2 id="思路">思路</h2><p>这道题实际上就是说，A不允许B比A多C根蜡烛，也就是说<code>不允许B - A &gt; C</code>的情况出现，而输入给了多个这样的不等式，实际上是一个差分约束系统</p><p>关于差分约束系统，参考：<a href="https://oi-wiki.org/graph/diff-constraints/">https://oi-wiki.org/graph/diff-constraints/</a></p><p>知道是差分约束后，用Dijkstra或者SPFA什么的都可以了</p><p>这道题的思路其实很简单，但是一直TLE，然后查了一下，发现不能用Vector，只要用了Vector就会TLE，其次是如果是SPFA那么不能使用队列优化只能用栈优化，<strong>这道题太阴间了</strong></p><p>已知会TLE的解：</p><ul class="lvl-0"><li class="lvl-2"><p>Bellman-Ford</p></li><li class="lvl-2"><p>队列优化Bellman-Ford（SPFA）</p></li><li class="lvl-2"><p>使用了Vector的任何解（可能要划掉任何？）</p></li></ul><p>不过参考了网上题解，这道题倒是让我会了丢掉Vector如何存边</p><p>AC的代码使用了<strong>链式前向星</strong>，参考：<a href="https://blog.csdn.net/sugarbliss/article/details/86495945">https://blog.csdn.net/sugarbliss/article/details/86495945</a></p><p>总而言之这就是一道考优化的题嘛</p><h2 id="代码">代码</h2><h3 id="TLE">TLE</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief POJ - 3159 Candies SPFA 卡TLE了..</span><br><span class="hljs-comment"> * @date 2022-05-03</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 1000001</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> INF 0x3f3f3f3f</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">    N is the number of kids in the class</span><br><span class="hljs-comment"> */</span><br><span class="hljs-type">int</span> n, m;<br><br>vector&lt;pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&gt; Edge[MAXN];<br><span class="hljs-type">bool</span> vis[MAXN];<br><span class="hljs-type">int</span> dis[MAXN];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SPFA</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">memset</span>(vis, <span class="hljs-literal">false</span>, <span class="hljs-built_in">sizeof</span>(vis));<br>    <span class="hljs-built_in">memset</span>(dis, INF, <span class="hljs-built_in">sizeof</span>(dis));<br><br>    queue&lt;<span class="hljs-type">int</span>&gt; Q;<br>    Q.<span class="hljs-built_in">push</span>(<span class="hljs-number">1</span>);<br>    vis[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;<br>    dis[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">while</span> (!Q.<span class="hljs-built_in">empty</span>())<br>    &#123;<br>        <span class="hljs-type">int</span> now = Q.<span class="hljs-built_in">front</span>();<br>        Q.<span class="hljs-built_in">pop</span>();<br>        vis[now] = <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; Edge[now].<span class="hljs-built_in">size</span>(); i++)<br>        &#123;<br>            <span class="hljs-type">int</span> next = Edge[now][i].first;<br>            <span class="hljs-type">int</span> wishes = Edge[now][i].second;<br><br>            <span class="hljs-keyword">if</span> (dis[now] + wishes &lt; dis[next])<br>            &#123;<br>                dis[next] = dis[now] + wishes;<br>                <span class="hljs-keyword">if</span> (vis[next])<br>                    <span class="hljs-keyword">continue</span>;<br>                vis[next] = <span class="hljs-literal">true</span>;<br>                Q.<span class="hljs-built_in">push</span>(next);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);<br>    <span class="hljs-type">int</span> a, b, c;<br>    <span class="hljs-keyword">while</span> (m--)<br>    &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        Edge[a].<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">make_pair</span>(b, c)); <span class="hljs-comment">// a期望b不能拿超过c的东西</span><br>    &#125;<br>    <span class="hljs-built_in">SPFA</span>();<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, dis[n]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="AC">AC</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief POJ - 3159 Candies SPFA</span><br><span class="hljs-comment"> * @date 2022-05-03</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stack&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 200001</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> INF 0x3f3f3f3f</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">    N is the number of kids in the class</span><br><span class="hljs-comment"> */</span><br><span class="hljs-type">int</span> n, m,len;<br><br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Edge</span><br>&#123;<br>    <span class="hljs-type">int</span> v, next, w;<br>&#125;e[MAXN];<br><br><span class="hljs-type">int</span> head[MAXN]; <span class="hljs-comment">//head[from]表示以head为出发点的邻接表表头在数组es中的位置，开始时所有元素初始化为-1</span><br><span class="hljs-type">bool</span> vis[MAXN];<br><span class="hljs-type">int</span> dis[MAXN];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> from,<span class="hljs-type">int</span> to,<span class="hljs-type">int</span> wish)</span></span>&#123;<br>    e[len].v = to;<br>    e[len].next = head[from];<br>    e[len].w = wish;<br>    head[from] = len++;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SPFA</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">memset</span>(vis, <span class="hljs-literal">false</span>, <span class="hljs-built_in">sizeof</span>(vis));<br>    <span class="hljs-built_in">memset</span>(dis, INF, <span class="hljs-built_in">sizeof</span>(dis));<br><br>    stack&lt;<span class="hljs-type">int</span>&gt; Q;<br>    Q.<span class="hljs-built_in">push</span>(<span class="hljs-number">1</span>);<br>    vis[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;<br>    dis[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">while</span> (!Q.<span class="hljs-built_in">empty</span>())<br>    &#123;<br>        <span class="hljs-type">int</span> now = Q.<span class="hljs-built_in">top</span>();<br>        Q.<span class="hljs-built_in">pop</span>();<br>        vis[now] = <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = head[now]; i!=<span class="hljs-number">-1</span>; i=e[i].next)<br>        &#123;<br>            <span class="hljs-type">int</span> v = e[i].v;<br>            <span class="hljs-type">int</span> w = e[i].w;<br><br>            <span class="hljs-keyword">if</span> (dis[now] + w &lt; dis[v])<br>            &#123;<br>                dis[v] = dis[now] + w;<br>                <span class="hljs-keyword">if</span> (vis[v])<br>                    <span class="hljs-keyword">continue</span>;<br>                vis[v] = <span class="hljs-literal">true</span>;<br>                Q.<span class="hljs-built_in">push</span>(v);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);<br>    <span class="hljs-type">int</span> a, b, c;<br>    <span class="hljs-built_in">memset</span>(head,<span class="hljs-number">-1</span>,<span class="hljs-built_in">sizeof</span>(head));<br>    <span class="hljs-keyword">while</span> (m--)<br>    &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        <span class="hljs-built_in">add</span>(a,b,c);<br>    &#125;<br>    <span class="hljs-built_in">SPFA</span>();<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, dis[n]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Reference">Reference</h2><p><a href="https://exp-blog.com/algorithm/poj/poj1860-currency-exchange/">https://exp-blog.com/algorithm/poj/poj1860-currency-exchange/</a><br><a href="http://www.cppblog.com/keroro/archive/2013/05/28/200649.html">http://www.cppblog.com/keroro/archive/2013/05/28/200649.html</a><br><a href="https://www.programminghunter.com/article/6472483735/">https://www.programminghunter.com/article/6472483735/</a><br><a href="https://blog.csdn.net/sugarbliss/article/details/86495945">https://blog.csdn.net/sugarbliss/article/details/86495945</a><br><a href="https://oi-wiki.org/graph/diff-constraints/">https://oi-wiki.org/graph/diff-constraints/</a></p>]]></content>
    
    
    <categories>
      
      <category>POJ题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>图论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】POJ-1860 Currency Exchange</title>
    <link href="/ca113b437a77/"/>
    <url>/ca113b437a77/</url>
    
    <content type="html"><![CDATA[<h1>POJ-1860 Currency Exchange</h1><p>POJ:<a href="http://poj.org/problem?id=1860">http://poj.org/problem?id=1860</a></p><h2 id="题目">题目</h2><blockquote><p>Several currency exchange points are working in our city. Let us suppose that each point specializes in two particular currencies and performs exchange operations only with these currencies. There can be several points specializing in the same pair of currencies. Each point has its own exchange rates, exchange rate of A to B is the quantity of B you get for 1A. Also each exchange point has some commission, the sum you have to pay for your exchange operation. Commission is always collected in source currency.<br>For example, if you want to exchange 100 US Dollars into Russian Rubles at the exchange point, where the exchange rate is 29.75, and the commission is 0.39 you will get (100 - 0.39) * 29.75 = 2963.3975RUR.<br>You surely know that there are N different currencies you can deal with in our city. Let us assign unique integer number from 1 to N to each currency. Then each exchange point can be described with 6 numbers: integer A and B - numbers of currencies it exchanges, and real RAB, CAB, RBA and CBA - exchange rates and commissions when exchanging A to B and B to A respectively.<br>Nick has some money in currency S and wonders if he can somehow, after some exchange operations, increase his capital. Of course, he wants to have his money in currency S in the end. Help him to answer this difficult question. Nick must always have non-negative sum of money while making his operations.</p><p>有很多种货币，货币之间可以兑换，但是需要手续费，而且A-&gt;B的汇率、手续费和B-&gt;A的汇率、手续费不同，有个人想通过货币交易来赚钱，判断能不能赚钱</p></blockquote><table><thead><tr><th>Time Limit</th><th>Memory Limit</th></tr></thead><tbody><tr><td>1000 ms</td><td>30000 kB</td></tr></tbody></table><h2 id="思路">思路</h2><p>做这道题的时候学校把这道题归类到图论，然后按前面的做题情况来说，先做了一堆并查集，在上一题又出现了SPFA，这道题就比较容易猜到是SPFA来做，有点投机取巧的味道</p><p>然后，这道题首先要注意输入问题，有的并不是int输入，而是double输入（因为这个我卡了半天代码）。</p><p>对于一个货币交易点，我们可以知道这个点只能在2种货币间进行兑换，例如一个货币交易点可以兑换A和B的货币，我们所需要抽象的并不是交易点，而应当是各种货币，把货币当成一张图上的各个点，然后各个点之间是一个无向图，但是<strong>往返所需要的花费是不一样的</strong>。通过各个货币建立起来一张图后，我们所需要做的就是在各个货币之间往返，然后查找出能否赚钱</p><p>我们利用了SPFA的算法思路（<strong>不断更新一个点一直到这个点不能再被更新</strong>），样本的答案如果会赚钱，那么一定会出现<strong>一个正权环</strong>，在这个环之前不断的走就会一直赚钱（就像其他题解说的能一直松弛），而题目又有一句他最终会回到起点（<code>he wants to have his money in currency S in the end</code>），那么我们只需要在起点判断钱会不会增加即可。</p><p>因此，在这道题中，dis数组表示的是走到这个点时，我们当前手上所持有的货币金额大小，更新条件就是<code>(dis[now]-commission)*rate &gt; dis[next]</code>，也就是经过货币兑换我们会比先前的值更大</p><h2 id="代码">代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief POJ - 1860 Currency Exchange SPFA</span><br><span class="hljs-comment"> * @date 2022-05-03</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 100001</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> INF 1 &lt;&lt; 30</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">    N - the number of currencies</span><br><span class="hljs-comment">    M - the number of exchange points</span><br><span class="hljs-comment">    S - the number of currency Nick has</span><br><span class="hljs-comment">    V - the quantity of currency units he has</span><br><span class="hljs-comment"> */</span><br><span class="hljs-type">int</span> n, m, s;<br><span class="hljs-type">double</span> v;<br><br><span class="hljs-comment">// Vector&lt;pair&lt;下一个位置,pair&lt;利率,手续费&gt;&gt;&gt; Edge[当前位置];</span><br>vector&lt;pair&lt;<span class="hljs-type">int</span>, pair&lt;<span class="hljs-type">double</span>, <span class="hljs-type">double</span>&gt;&gt;&gt; Edge[MAXN]; <span class="hljs-comment">//领接表</span><br><span class="hljs-type">bool</span> vis[MAXN];<br><span class="hljs-type">double</span> dis[MAXN]; <span class="hljs-comment">//到当前这个点时我们所持有的钱</span><br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">SPFA</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">memset</span>(vis, <span class="hljs-literal">false</span>, <span class="hljs-built_in">sizeof</span>(vis));<br>    <span class="hljs-built_in">memset</span>(dis, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(dis));<br><br>    queue&lt;<span class="hljs-type">int</span>&gt; Q;<br>    Q.<span class="hljs-built_in">push</span>(s);<br>    vis[s] = <span class="hljs-literal">true</span>;<br>    dis[s] = v; <span class="hljs-comment">//设定当前这个位置的钱</span><br><br>    <span class="hljs-keyword">while</span> (!Q.<span class="hljs-built_in">empty</span>())<br>    &#123;<br>        <span class="hljs-type">int</span> now = Q.<span class="hljs-built_in">front</span>();<br>        Q.<span class="hljs-built_in">pop</span>();<br>        vis[now] = <span class="hljs-literal">false</span>;<br><br>        <span class="hljs-comment">//回到起点，发现钱多了</span><br>        <span class="hljs-keyword">if</span>(now == s &amp;&amp; dis[now]&gt;v) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; Edge[now].<span class="hljs-built_in">size</span>(); i++)<br>        &#123;<br>            <span class="hljs-type">int</span> next = Edge[now][i].first;<br>            <span class="hljs-type">double</span> rate = Edge[now][i].second.first;<br>            <span class="hljs-type">double</span> commission = Edge[now][i].second.second;<br><br>            <span class="hljs-comment">//如果进行货币交易后发现，诶嘿，钱多了</span><br>            <span class="hljs-keyword">if</span> ((dis[now] - commission) * rate &gt; dis[next])<br>            &#123;<br>                dis[next] = (dis[now] - commission) * rate;<br>                <span class="hljs-keyword">if</span>(vis[next]) <span class="hljs-keyword">continue</span>;<br>                vis[next] = <span class="hljs-literal">true</span>;<br>                Q.<span class="hljs-built_in">push</span>(next);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> a, b;<br>    <span class="hljs-type">double</span> r_ab, c_ab, r_ba, c_ba;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d %lf&quot;</span>, &amp;n, &amp;m, &amp;s, &amp;v);<br>    <span class="hljs-keyword">while</span> (m--)<br>    &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %lf %lf %lf %lf&quot;</span>, &amp;a, &amp;b, &amp;r_ab, &amp;c_ab, &amp;r_ba, &amp;c_ba);<br>        Edge[a].<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">make_pair</span>(b, <span class="hljs-built_in">make_pair</span>(r_ab, c_ab)));<br>        Edge[b].<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">make_pair</span>(a, <span class="hljs-built_in">make_pair</span>(r_ba, c_ba)));<br>    &#125;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-built_in">SPFA</span>() ? <span class="hljs-string">&quot;YES&quot;</span> : <span class="hljs-string">&quot;NO&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Reference">Reference</h2><p><a href="https://exp-blog.com/algorithm/poj/poj1860-currency-exchange/">https://exp-blog.com/algorithm/poj/poj1860-currency-exchange/</a></p>]]></content>
    
    
    <categories>
      
      <category>POJ题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>图论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】POJ-1797 Heavy Transportation 三种解法</title>
    <link href="/d71f658b1ddd/"/>
    <url>/d71f658b1ddd/</url>
    
    <content type="html"><![CDATA[<h1>POJ-1797 Heavy Transportation</h1><p>POJ:<a href="http://poj.org/problem?id=1797">http://poj.org/problem?id=1797</a></p><h2 id="题目">题目</h2><blockquote><p>Background<br>Hugo Heavy is happy. After the breakdown of the Cargolifter project he can now expand business. But he needs a clever man who tells him whether there really is a way from the place his customer has build his giant steel crane to the place where it is needed on which all streets can carry the weight.<br>Fortunately he already has a plan of the city with all streets and bridges and all the allowed weights.Unfortunately he has no idea how to find the the maximum weight capacity in order to tell his customer how heavy the crane may become. But you surely know.</p><p>Problem<br>You are given the plan of the city, described by the streets (with weight limits) between the crossings, which are numbered from 1 to n. Your task is to find the maximum weight that can be transported from crossing 1 (Hugo’s place) to crossing n (the customer’s place). You may assume that there is at least one path. All streets can be travelled in both directions.</p></blockquote><table><thead><tr><th>Time Limit</th><th>Memory Limit</th></tr></thead><tbody><tr><td>3000ms</td><td>30000kB</td></tr></tbody></table><p>这道题参考了多个题解和教程，尝试着带着参考写了4种不同的答案（其中Dijkstra有2个），实际上这道题是入门图论题，只是我自己水平还有很大提升空间</p><p><strong>这道题实际上求的是最大生成树，所以可以看到在一些地方会与标准的最小生成树符号反了</strong></p><h2 id="方法一：Kruskal">方法一：Kruskal</h2><h3 id="思路">思路</h3><p>对边进行由大到小的排序，然后逐个边合并，一直到连通节点1（起始点）和节点n（终点）结束（代码里通过判断两个根节点是否一致来得出是否连通），<strong>由于我们边是按从大到小排序的，所以答案就是连通节点的最后一条边能支持的最大重量</strong>。嗯…模板无疑</p><h3 id="代码">代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief POJ - 1797 Heavy Transportation Kruskal</span><br><span class="hljs-comment"> * @date 2022-05-02</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 100001</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Edge</span><br>&#123;<br>    ll start;<br>    ll end;<br>    ll heavy;<br>&#125;;<br><br>ll plans;        <span class="hljs-comment">//计划数</span><br>ll n, m;         <span class="hljs-comment">//十字路口的条数（点的数量） 路径数量</span><br>ll ans;          <span class="hljs-comment">//答案</span><br>ll father[MAXN]; <span class="hljs-comment">//根节点</span><br>Edge heavy[MAXN];<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">compare</span><span class="hljs-params">(Edge m, Edge n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> m.heavy &gt; n.heavy;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">set_make</span><span class="hljs-params">(ll n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>        father[i] = i;<br>&#125;<br><br><span class="hljs-function">ll <span class="hljs-title">set_find</span><span class="hljs-params">(ll x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (x != father[x])<br>        father[x] = <span class="hljs-built_in">set_find</span>(father[x]);<br>    <span class="hljs-keyword">return</span> father[x];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">set_union</span><span class="hljs-params">(ll x, ll y)</span></span><br><span class="hljs-function"></span>&#123;<br>    ll fx = <span class="hljs-built_in">set_find</span>(x);<br>    ll fy = <span class="hljs-built_in">set_find</span>(y);<br><br>    <span class="hljs-keyword">if</span> (fx != fy)<br>        father[fy] = fx;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><br>    <span class="hljs-built_in">memset</span>(heavy, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(heavy)); <span class="hljs-comment">//重置为0</span><br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;plans);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> current = <span class="hljs-number">0</span>; current &lt; plans; current++)<br>    &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld %lld&quot;</span>, &amp;n, &amp;m);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld %lld %lld&quot;</span>, &amp;heavy[i].start, &amp;heavy[i].end, &amp;heavy[i].heavy);<br><br>        <span class="hljs-built_in">set_make</span>(MAXN<span class="hljs-number">-1</span>);<br>        <span class="hljs-built_in">sort</span>(heavy, heavy + m, compare);<br>        ll k = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>        &#123;<br>            ans = i;<br>            <span class="hljs-keyword">if</span> (k == n)<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">set_find</span>(heavy[i].start) != <span class="hljs-built_in">set_find</span>(heavy[i].end))<br>            &#123;<br>                <span class="hljs-built_in">set_union</span>(heavy[i].start, heavy[i].end);<br>                k++;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">set_find</span>(<span class="hljs-number">1</span>) == <span class="hljs-built_in">set_find</span>(n))<br>                    <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Scenario #%d:\n%d\n\n&quot;</span>, current + <span class="hljs-number">1</span>, heavy[ans].heavy); <span class="hljs-comment">//输出答案</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="方法二：-带队列优化的Bellman-Ford-（SPFA）">方法二： 带队列优化的Bellman-Ford （SPFA）</h2><h3 id="思路-2">思路</h3><p>B站学习了一圈，再参考了其他人的题解，实际上这个SPFA法解题只需要改一个地方：</p><p>标准的spfa的dis数组记录的是距离（最小距离balabala），但因为题目原因，这道题需要把dis数组改为从起始点到当前点的最大承重量</p><p>因此只需要把标准的<code>dis[v]&gt;dis[now]+Edge[now][i].second</code>改为<code>min(dis[now], Edge[now][i].second) &gt; dis[Edge[now][i].first]</code>就好了，当然，下面那个更新状态的语句也要改。改完就能跑通了（跑通就过！</p><h3 id="代码-2">代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief POJ - 1797 Heavy Transportation SPFA</span><br><span class="hljs-comment"> * @date 2022-04-29</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 1000001</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> INF 1 &lt;&lt; 30</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">int</span> plans; <span class="hljs-comment">//计划数</span><br><span class="hljs-type">int</span> n, m;  <span class="hljs-comment">//十字路口的条数（点的数量） 路径数量</span><br><br>vector&lt;pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&gt; Edge[MAXN];<br><span class="hljs-type">bool</span> vis[MAXN];<br><span class="hljs-type">int</span> dis[MAXN];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SPFA</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">memset</span>(vis, <span class="hljs-literal">false</span>, <span class="hljs-built_in">sizeof</span>(vis)); <span class="hljs-comment">//重置为0</span><br>    <span class="hljs-built_in">memset</span>(dis, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(dis));<br><br>    queue&lt;<span class="hljs-type">int</span>&gt; Q;<br>    Q.<span class="hljs-built_in">push</span>(<span class="hljs-number">1</span>);<br>    vis[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;<br>    dis[<span class="hljs-number">1</span>] = INF;<br><br>    <span class="hljs-keyword">while</span> (!Q.<span class="hljs-built_in">empty</span>())<br>    &#123;<br>        <span class="hljs-type">int</span> now = Q.<span class="hljs-built_in">front</span>();<br>        Q.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; Edge[now].<span class="hljs-built_in">size</span>(); i++)<br>        &#123;<br>            <span class="hljs-type">int</span> next = Edge[now][i].first;<br>            <span class="hljs-type">int</span> heavy = Edge[now][i].second;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">min</span>(dis[now], heavy) &gt; dis[next])<br>            &#123;<br>                dis[next] = <span class="hljs-built_in">min</span>(dis[now], heavy);<br>                <span class="hljs-keyword">if</span> (!vis[next])<br>                &#123;<br>                    vis[next] = <span class="hljs-literal">true</span>;<br>                    Q.<span class="hljs-built_in">push</span>(next);<br>                &#125;<br>            &#125;<br>        &#125;<br>        vis[now] = <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;plans);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> current = <span class="hljs-number">0</span>; current &lt; plans; current++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; MAXN; i++)<br>            Edge[i].<span class="hljs-built_in">clear</span>();<br>        <span class="hljs-type">int</span> tmp_start, tmp_end, tmp_heavy;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>        &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;tmp_start, &amp;tmp_end, &amp;tmp_heavy);<br>            Edge[tmp_start].<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">make_pair</span>(tmp_end, tmp_heavy));<br>            Edge[tmp_end].<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">make_pair</span>(tmp_start, tmp_heavy));<br>        &#125;<br>        <span class="hljs-built_in">SPFA</span>();<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Scenario #%d:\n%d\n\n&quot;</span>, current + <span class="hljs-number">1</span>, dis[n]); <span class="hljs-comment">//输出答案</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="方法三：Dijkstra">方法三：Dijkstra</h2><h3 id="思路-3">思路</h3><p>太模板了，其实一些思路与方法一的思路还是很像的<br><strong>更新条件是：</strong><code>1.这个点没有被访问过 2.这个点到起始点的代价比前面确定的点到起始点的代价和当前点到前面确定点的代价都要小</code></p><h3 id="代码-3">代码</h3><h4 id="带优先队列优化的">带优先队列优化的</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief POJ - 1797 Heavy Transportation Dijkstra</span><br><span class="hljs-comment"> * @date 2022-05-02</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 10001</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> INF 1e7</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">int</span> plans; <span class="hljs-comment">//计划数</span><br><span class="hljs-type">int</span> n, m;  <span class="hljs-comment">//十字路口的条数（点的数量） 路径数量</span><br><br>vector&lt;pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&gt; Edge[MAXN];<br><span class="hljs-type">int</span> dis[MAXN];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Djistra</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">memset</span>(dis, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(dis));<br><br>    priority_queue&lt;pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&gt; Q; <span class="hljs-comment">//第二个是我们要表示的点，而第一个仅仅只是用于排序而已</span><br>    dis[<span class="hljs-number">1</span>] = INF;<br>    Q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">make_pair</span>(dis[<span class="hljs-number">1</span>], <span class="hljs-number">1</span>));<br><br>    <span class="hljs-keyword">while</span> (!Q.<span class="hljs-built_in">empty</span>())<br>    &#123;<br>        <span class="hljs-type">int</span> now = Q.<span class="hljs-built_in">top</span>().second;<br>        Q.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; Edge[now].<span class="hljs-built_in">size</span>(); i++)<br>        &#123;<br>            <span class="hljs-type">int</span> next = Edge[now][i].first;<br>            <span class="hljs-type">int</span> heavy = Edge[now][i].second;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">min</span>(dis[now], heavy) &gt; dis[next])<br>            &#123;<br>                dis[next] = <span class="hljs-built_in">min</span>(dis[now], heavy);<br>                Q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">make_pair</span>(dis[next], next));<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;plans);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> current = <span class="hljs-number">0</span>; current &lt; plans; current++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; MAXN; i++)<br>            Edge[i].<span class="hljs-built_in">clear</span>();<br>        <span class="hljs-type">int</span> tmp_start, tmp_end, tmp_heavy;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>        &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;tmp_start, &amp;tmp_end, &amp;tmp_heavy);<br>            Edge[tmp_start].<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">make_pair</span>(tmp_end, tmp_heavy));<br>            Edge[tmp_end].<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">make_pair</span>(tmp_start, tmp_heavy));<br>        &#125;<br>        <span class="hljs-built_in">Djistra</span>();<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Scenario #%d:\n%d\n\n&quot;</span>, current + <span class="hljs-number">1</span>, dis[n]); <span class="hljs-comment">//输出答案</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="不带优先队列优化的">不带优先队列优化的</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief POJ - 1797 Heavy Transportation Dijkstra</span><br><span class="hljs-comment"> * @date 2022-05-02</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 2001</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">int</span> plans;           <span class="hljs-comment">//计划数</span><br><span class="hljs-type">int</span> n, m;            <span class="hljs-comment">//十字路口的条数（点的数量） 路径数量</span><br><span class="hljs-type">int</span> vis[MAXN * <span class="hljs-number">100</span>]; <span class="hljs-comment">//是否访问</span><br><span class="hljs-type">int</span> d[MAXN * <span class="hljs-number">100</span>];   <span class="hljs-comment">//当前点到起点的最大承载重量</span><br><span class="hljs-type">int</span> heavy[MAXN][MAXN];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">djistra</span><span class="hljs-params">(<span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">memset</span>(vis, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(vis));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>        d[i] = heavy[i][start];<br>    vis[start] = <span class="hljs-number">1</span>; <span class="hljs-comment">//第一个点已经被访问啦</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; m; i++)<br>    &#123;<br>        <span class="hljs-type">int</span> point = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> maxHeavy = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-comment">//找一条承载重量最大且没被访问的边</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (!vis[j] &amp;&amp; d[j] &gt; maxHeavy)<br>                maxHeavy = d[j], point = j;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (!maxHeavy) <span class="hljs-comment">//没有找到合适的边</span><br>            <span class="hljs-keyword">break</span>;<br>        vis[point] = <span class="hljs-number">1</span>; <span class="hljs-comment">//标记这个点为已访问</span><br>        <span class="hljs-comment">//对于每一条边，进行松弛</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++)<br>        &#123;<br>            <span class="hljs-comment">//1.这个点没有被访问过 2.这个点到起始点的代价比前面确定的点到起始点的代价和当前点到前面确定点的代价都要小</span><br>            <span class="hljs-keyword">if</span> (!vis[j] &amp;&amp; d[j] &lt; <span class="hljs-built_in">min</span>(d[point], heavy[point][j]))&#123;<br>                d[j] = <span class="hljs-built_in">min</span>(d[point], heavy[point][j]); <span class="hljs-comment">//更新这个点的最大承载力的最大值</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;plans);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> current = <span class="hljs-number">0</span>; current &lt; plans; current++)<br>    &#123;<br>        <span class="hljs-built_in">memset</span>(heavy, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(heavy)); <span class="hljs-comment">//重置为0</span><br>        <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(d));         <span class="hljs-comment">//重置为0</span><br>        <span class="hljs-type">int</span> tmp_start, tmp_end, tmp_heavy;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)<br>        &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;tmp_start, &amp;tmp_end, &amp;tmp_heavy);<br>            heavy[tmp_start][tmp_end] = heavy[tmp_end][tmp_start] = tmp_heavy;<br>        &#125;<br>        <span class="hljs-built_in">djistra</span>(<span class="hljs-number">1</span>, n);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Scenario #%d:\n%d\n\n&quot;</span>, current + <span class="hljs-number">1</span>, d[n]); <span class="hljs-comment">//输出答案</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Reference">Reference</h2><p><a href="https://zh.wikipedia.org/zh-cn/%E5%85%8B%E9%B2%81%E6%96%AF%E5%85%8B%E5%B0%94%E6%BC%94%E7%AE%97%E6%B3%95">https://zh.wikipedia.org/zh-cn/克鲁斯克尔演算法</a><br><a href="https://zh.m.wikipedia.org/zh-sg/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E5%BF%AB%E9%80%9F%E7%AE%97%E6%B3%95">https://zh.m.wikipedia.org/zh-sg/最短路径快速算法</a><br><a href="https://zh.m.wikipedia.org/wiki/%E5%85%8B%E9%B2%81%E6%96%AF%E5%85%8B%E5%B0%94%E6%BC%94%E7%AE%97%E6%B3%95">https://zh.m.wikipedia.org/wiki/克鲁斯克尔演算法</a><br><a href="https://www.programminghunter.com/article/5506934098/">https://www.programminghunter.com/article/5506934098/</a><br><a href="https://www.cnblogs.com/zxy160/p/7215156.html">https://www.cnblogs.com/zxy160/p/7215156.html</a><br><a href="https://jqh.zone/blog/post_detail/515/post_detail/377">https://jqh.zone/blog/post_detail/515/post_detail/377</a><br><a href="https://blog.csdn.net/u011265346/article/details/42914843">https://blog.csdn.net/u011265346/article/details/42914843</a></p>]]></content>
    
    
    <categories>
      
      <category>POJ题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>图论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】POJ-1182 食物链</title>
    <link href="/bc0566ddf8c1/"/>
    <url>/bc0566ddf8c1/</url>
    
    <content type="html"><![CDATA[<h1>POJ-1182 食物链</h1><p>POJ：<a href="http://poj.org/problem?id=1182">http://poj.org/problem?id=1182</a></p><h2 id="题目">题目</h2><blockquote><p>题目描述：</p><p>动物王国中有三类动物A,B,C，这三类动物的食物链构成了有趣的环形。A吃B， B吃C，C吃A。现有N个动物，以1－N编号。每个动物都是A,B,C中的一种，但是我们并不知道它到底是哪一种。有人用两种说法对这N个动物所构成的食物链关系进行描述：第一种说法是&quot;1 X Y&quot;，表示X和Y是同类。第二种说法是&quot;2 X Y&quot;，表示X吃Y。此人对N个动物，用上述两种说法，一句接一句地说出K句话，这K句话有的是真的，有的是假的。当一句话满足下列三条之一时，这句话就是假话，否则就是真话。<br>1） 当前的话与前面的某些真的话冲突，就是假话；<br>2） 当前的话中X或Y比N大，就是假话；<br>3） 当前的话表示X吃X，就是假话。</p><p>任务描述：</p><p>根据给定的N（1 &lt;= N &lt;= 50,000）和K句话（0 &lt;= K &lt;= 100,000），输出假话的总数。</p></blockquote><table><thead><tr><th>Time Limit</th><th>Memory Limit</th></tr></thead><tbody><tr><td>1000ms</td><td>10000 kB</td></tr></tbody></table><h2 id="思路">思路</h2><p>首先我要跟自己严肃批评一下，这是一道非常经典的并查集题，出现在NOI2001，但是我并没有做过</p><h3 id="处理信息">处理信息</h3><p>题目本身就有很强的并查集提示，但是我们仍然需要解决一个问题：如何确定每种动物属于A、B还是C？我们再想一下，我们真的需要确定这个动物确切属于ABC的哪一个吗？更直接一点，为什么要出现ABC？</p><p>对于这个环形食物链，我们任意选取其中一种动物，我们可以观察到，<strong>这种动物</strong>和另外两种的关系，<strong>必定只存在一个吃和一个被吃</strong>。这样子我们可以稍微简化一下，需要实现的关系从ABC变到了吃和被吃的关系。</p><p>但是上述表达仍然，存在一些问题，我们仍然刻意强调了<strong>这种动物</strong>这个概念，我们需要继续减弱这种概念的影响，我们继续简化，对于一个动物（不是一类动物）本身而言，<strong>它和别的动物只会存在下面三种关系</strong>：同类、被吃、吃</p><h3 id="更新时关系的更新">更新时关系的更新</h3><p>我们设定一个<code>pair&lt;long long ,long long&gt; node[MAXN]</code>，规定为一个节点的表示，其中，first表示这个节点的根节点位置，second表示这个节点与根节点的关系（吃、被吃、同类）</p><p>在更新父节点的过程中，我们与父节点的关系也会发生变化，现在我们需要考虑的就是如何更新我们与父节点的变化，这里我们假设存在三个节点：<code>x-&gt;y-&gt;z</code>在更新过程中，我们肯定是期望要直接把x的父节点更新为z，但是如何确定x和z的关系？直接枚举</p><table><thead><tr><th>x-&gt;y</th><th>y-&gt;z</th><th>x-&gt;z</th><th>由x-&gt;y推x-&gt;z</th></tr></thead><tbody><tr><td>同类</td><td>同类</td><td>同类</td><td>同类+同类=同类</td></tr><tr><td>同类</td><td>吃</td><td>吃</td><td>同类+吃=吃</td></tr><tr><td>同类</td><td>被吃</td><td>被吃</td><td>同类+被吃=被吃</td></tr><tr><td>吃</td><td>同类</td><td>吃</td><td>吃+同类=吃</td></tr><tr><td>吃</td><td>吃</td><td><strong>被吃</strong></td><td>吃+吃=被吃（因为这是一个环状食物链）</td></tr><tr><td>吃</td><td>被吃</td><td>同类</td><td>吃+被吃=同类</td></tr><tr><td>被吃</td><td>同类</td><td>被吃</td><td>被吃+同类=被吃</td></tr><tr><td>被吃</td><td>吃</td><td>同类</td><td>被吃+吃=同类</td></tr><tr><td>被吃</td><td>被吃</td><td>吃</td><td>被吃+被吃=吃（因为这是一个环状食物链）</td></tr></tbody></table><p>注意：这是任意的三个点之间的关系，一共只有9种</p><p>我们进行如下抽象：<code>同类=0，被吃=1，吃=2</code>，或者<code>同类=0，吃=1，被吃=2</code>，之所以我一直把同类定义为0，因为由表格第一行，<code>同类+同类=同类</code>，<strong>在数学上这与0的性质很接近</strong></p><p>继续观察我给了备注的两行，我们可以发现<code>吃+吃=被吃</code>和<code>被吃+被吃=吃</code>如果根据上面抽象化（以第一个为例），就是<code>2+2=1</code>和<code>1+1=2</code>，第二个抽象在数学上本身成立，那如何让第一个也成立呢？我们引入了模：<code>(2+2)%3=1</code>，引入后经过检查，不会与其他关系冲突，也就是说，我们可以在以上9种的关系中全部加入模3（也可以根据题目猜测得出，因为题目也是一个<strong>有3种动物的环状食物链</strong>）。</p><p>因此，我们得出了一个公式用于解决节点状态更新的问题</p><p>$$ Relation&lt;x,z&gt; = (Relation&lt;x,y&gt;+Relation&lt;y,z&gt;)%3 $$</p><h3 id="合并时状态的更新">合并时状态的更新</h3><p>除了更新父节点，我们还需要解决两棵树合并的问题，现在考虑两个节点<code>x和y</code>，他们的根节点不同（<code>假定为fx和fy</code>），我们合并时选择<code>把y树合并到x树上</code>，为了简化问题，我们让这些点之间的关系为<code>aniType-1</code>（因为恰好可以与前面讨论的内容直接成立，输入1时表示的就是同类，2表示的就是吃的关系）</p><p>合并两棵树，实际上只需要解决<code>fy节点连接到fx节点的状态更新</code>，接着，我们发现这四者其实存在一些关系：<code>y-&gt;fy,x-&gt;y,x-&gt;fx</code>可以发现，跟前面关系更新时非常的像：</p><p><code>y-&gt;fy</code>的关系实际上就是<code>fy-&gt;y</code>的关系取反（比如吃变为被吃），同类-&gt;同类（0-&gt;0），吃-&gt;被吃（1-&gt;2），被吃-&gt;吃（2-&gt;1），我们可以发现对于后面二者，我们直接改为<code>3-Relation&lt;fy,y&gt;</code>，但是这时候我们会发现如果是同类的话这个公式最后答案是3，等一下，直接模3不就好了吗？这不又变回0了？</p><p>其他就是一个顺水推舟了，我们可以得到一个新的公式</p><p>$$ Relation&lt;fy,fx&gt; = (-Relation&lt;y,fy&gt; + Relation&lt;y,x&gt;+Relation&lt;x,fx&gt;)%3$$</p><p>至此，代码已经显而易见了，我们只需要在<strong>每次更新</strong>时利用如上关系同时更新两个节点间的联系即可</p><p><strong>注意：是每次更新，并查集在进行set_union()和set_find()过程中都会进行更新，同时，在代码中，每调用一次这两个函数，节点间关系都有可能会改变，因此不能储存find()的ans，先前为了减少工作量，在main()函数中我储存了find的结果，直接导致本来AC的这道题WA了7个测点</strong></p><h2 id="代码">代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author OZLIINEX</span><br><span class="hljs-comment"> * @brief POJ - 1182  食物链</span><br><span class="hljs-comment"> * @date 2022-04-28</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXN 100001</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br>pair&lt;ll, ll&gt; node[MAXN]; <span class="hljs-comment">// first：根节点位置 second:与根节点的关系（0=同类，1=吃，2=被吃）</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @brief 构建</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">makeSet</span><span class="hljs-params">(ll n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>    &#123;<br>        node[i].first = i;<br>        node[i].second = <span class="hljs-number">0</span>; <span class="hljs-comment">//跟自己肯定是同类拉</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @brief 查找x所在树的根节点，并不断更新这棵树</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function">ll <span class="hljs-title">find</span><span class="hljs-params">(ll x)</span></span><br><span class="hljs-function"></span>&#123;<br>    ll fx = node[x].first; <span class="hljs-comment">//拿到这个点的父节点</span><br>    <span class="hljs-keyword">if</span> (x != fx)<br>    &#123;<br>        node[x].first = <span class="hljs-built_in">find</span>(fx);                                <span class="hljs-comment">//持续更新这个节点的父节点</span><br>        node[x].second = (node[x].second + node[fx].second) % <span class="hljs-number">3</span>; <span class="hljs-comment">//更新这个节点和父节点的关系</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> node[x].first;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Union</span><span class="hljs-params">(ll x,ll y,ll d)</span></span>&#123;<br>    ll fx = <span class="hljs-built_in">find</span>(x);<br>    ll fy = <span class="hljs-built_in">find</span>(y);<br><br>    node[fy].first = fx;<br>    node[fy].second = (node[x].second - node[y].second + <span class="hljs-number">3</span> + (d - <span class="hljs-number">1</span>)) % <span class="hljs-number">3</span>; <span class="hljs-comment">//更新节点关系</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    ll n, k;<br>    ll aniType, aniX, aniY; <span class="hljs-comment">//种类，动物1和2  1=同类 2=X吃Y</span><br>    ll ans = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld %lld&quot;</span>, &amp;n, &amp;k);<br>    <span class="hljs-built_in">makeSet</span>(MAXN - <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">while</span> (k--)<br>    &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld %lld %lld&quot;</span>, &amp;aniType, &amp;aniX, &amp;aniY);<br><br>        <span class="hljs-comment">//当前的话中X或Y比N大 或 当前的话表示X吃X</span><br>        <span class="hljs-keyword">if</span> (aniX &gt; n || aniY &gt; n || (aniX == aniY &amp;&amp; aniType == <span class="hljs-number">2</span>))<br>        &#123;<br>            ans++;<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">find</span>(aniX) == <span class="hljs-built_in">find</span>(aniY)) <span class="hljs-comment">//判断这两棵树的根节点是否一样，若不一样则执行合并操作，一样则进行相应判断</span><br>        &#123;<br>            <span class="hljs-keyword">if</span> (aniType == <span class="hljs-number">1</span> &amp;&amp; node[aniX].second != node[aniY].second) <span class="hljs-comment">//同类但是两个根节点不同，false</span><br>                ans++;<br>            <span class="hljs-keyword">if</span> (aniType == <span class="hljs-number">2</span> &amp;&amp; (node[aniX].second + <span class="hljs-number">1</span>) % <span class="hljs-number">3</span> != node[aniY].second) <span class="hljs-comment">//a吃b但是二者</span><br>                ans++;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-built_in">Union</span>(aniX,aniY,aniType);<br>    &#125;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, ans);<span class="hljs-comment">//</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Reference">Reference</h2><p><a href="https://blog.csdn.net/freezhanacmore/article/details/8767413">https://blog.csdn.net/freezhanacmore/article/details/8767413</a></p>]]></content>
    
    
    <categories>
      
      <category>POJ题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>图论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021思修冲刺提纲</title>
    <link href="/768d045b3503/"/>
    <url>/768d045b3503/</url>
    
    <content type="html"><![CDATA[<h1>绪论：当担复兴大任，培养时代新人</h1><h2 id="新时代呼唤担当民族复兴大任的时代新人">新时代呼唤担当民族复兴大任的时代新人</h2><ul class="lvl-0"><li class="lvl-2"><p>我们要肩负历史使命，坚定前进信心，立大志、明大德、成大才、担大任，努力成为堪当民族复兴重任的时代新人，让青春在为祖国，为民族，为人民，为人类的不懈奋斗中绽放绚丽之花</p></li></ul><h2 id="不断提升思想道德素质和法治素养">不断提升思想道德素质和法治素养</h2><ul class="lvl-0"><li class="lvl-2"><p><strong>人的本质是一切社会关系的总和</strong></p></li><li class="lvl-2"><p>思想道德和法律都是上层建筑的重要组成部分，共同服务于一定的经济基础</p></li><li class="lvl-2"><p>一方面，思想道德建设为法治建设提供思想指引和价值基础</p></li><li class="lvl-2"><p>另一方面，法治建设为思想道德建设提供制度支撑和法律保障，通过对思想道德的基本原则予以确认，为思想道德建设提供国家强制力保障</p></li><li class="lvl-2"><p>思想道德素质是人们的思想观念、政治立场、价值取向、道德情操和行为习惯等方面品质和能力的综合体现</p></li><li class="lvl-2"><p>法治素养是指人们通过学习法律知识，理解法律本质、运用法治思维、依法维护权利与依法履行义务的品质和能力，对于保证人们尊崇法治、遵守法律具有重要意义</p></li></ul><h1>第一章：领悟人生真谛 把握人生方向</h1><h2 id="第一节：人生观是对人生的总看法">第一节：人生观是对人生的总看法</h2><h3 id="1-1-正确认识人的本质">1.1 正确认识人的本质</h3><ul class="lvl-0"><li class="lvl-2"><p>人生观就是人们关于人生目的，人生态度，人生价值等问题的总观点和总看法</p></li><li class="lvl-2"><p><strong>马克思：人的本质不是单个人所固有IDE抽象物，在其现实性上，它是一切社会关系的总和</strong></p></li><li class="lvl-2"><p>个人与社会是对立统一的关系，两者相互依存、相互制约、相互促进</p></li><li class="lvl-2"><p>个人与社会的关系，最根本的是个人利益与社会利益的关系</p></li></ul><h3 id="1-2-人生观的主要内容">1.2 人生观的主要内容</h3><ul class="lvl-0"><li class="lvl-2"><p>人生目的是对人为什么活着这一人生根本问题的认识和回答，是人生观的核心</p></li><li class="lvl-2"><p>首先，人生目的决定人生道路</p></li><li class="lvl-2"><p>其次，人生目的决定人生态度</p></li><li class="lvl-2"><p>最后，人生目的决定人生价值选择</p></li><li class="lvl-2"><p>人生态度是指人们通过生活实践形成的对人生问题的一种相对稳定的心理倾向和精神状态</p></li><li class="lvl-2"><p>人生价值是指人的生命及其实践活动对于社会和个人所具有的作用和意义</p></li><li class="lvl-2"><p>选择什么样的人生目的，走什么样的人生道路，处理个人与社会、理想与现实、付出与收获、生与死等一系列人生历程中的重大问题时，人们总会有所取舍、有所好恶，对于赞成什么、反对什么，认同什么、抵制什么，总会有一定的标准。这些都与人们对人生价值的看法密切相关。</p></li><li class="lvl-2"><p>人生价值内在地包含了对人生的<strong>自我价值和社会价值</strong>两个方面</p></li><li class="lvl-2"><p>自我价值的<strong>前提</strong>是社会价值，社会价值<strong>保障</strong>自我价值</p></li><li class="lvl-2"><p>人生目的、人生态度、人生价值三者相互影响、紧密关联。</p></li><li class="lvl-2"><p>人生目的决定着人们对待实际生活的<strong>态度</strong>和对人生价值的<strong>评判</strong></p></li><li class="lvl-2"><p>人生态度影响着人们对人生目的的<strong>持守</strong>和人生价值的<strong>实现</strong></p></li><li class="lvl-2"><p>人生价值制约着人们对人生目的和人生态度的<strong>选择</strong></p></li></ul><h3 id="1-3-人生观与世界观、价值观">1.3 人生观与世界观、价值观</h3><ul class="lvl-0"><li class="lvl-2"><p>世界观是人们对生活在其中的世界以及人与世界的关系的总体看法和根本观点</p></li><li class="lvl-2"><p>世界观决定人生观，有什么样的世界观，就会有什么样的人生观</p></li><li class="lvl-2"><p>同时，人生观又对世界观的巩固、发展和变化起着重要作用</p></li><li class="lvl-2"><p>一个人树立什么样的价值观，会直接影响他对人生目的、人生意义等问题的思考</p></li></ul><h2 id="第二节：正确的人生观">第二节：正确的人生观</h2><h3 id="2-2-积极进取的人生态度">2.2 积极进取的人生态度</h3><ul class="lvl-0"><li class="lvl-2"><p>人生须认真</p></li><li class="lvl-2"><p>虽然人生很长，但关键处只有几步；虽然人生问题很复杂，但要害在于把握住最基本的东西</p></li><li class="lvl-2"><p>人生要进取</p></li><li class="lvl-2"><p>评价人生价值的根本尺度，是看一个人的实践活动是否符合社会发展的客观规律，是否促进了历史的进步</p></li><li class="lvl-2"><p>在今天，衡量人生价值的标准，最重要的就是看一个人是否用自己的劳动和聪明才智为国家和社会真诚奉献，为人民群众尽心尽力服务。</p></li><li class="lvl-2"><p>客观、公正、准确地评价社会成员人生价值的大小，除了要掌握科学的标准外，还需要掌握恰当的评价方法</p><ul class="lvl-2"><li class="lvl-4">①既要看贡献的大小，也要看尽力的程度</li><li class="lvl-4">②既要尊重物质贡献，也要尊重精神贡献</li><li class="lvl-4">③既要注重社会贡献，也要注重自身完善</li></ul></li></ul><h2 id="第三节：创造有意义的人生">第三节：创造有意义的人生</h2><h3 id="3-2-反对错误人生观">3.2 反对错误人生观</h3><ul class="lvl-0"><li class="lvl-2"><p>拜金主义是一种认为金钱可以主宰一切，把追求金钱作为人生至高目的的思想观念</p></li><li class="lvl-2"><p>享乐主义是一种把享乐作为人生目的，主张人生就在于满足感官的需求与快乐的思想观念</p></li></ul><h1>第二章 追求远大理想 坚定崇高信念</h1><h2 id="第一节：理想信念的内涵及其重要性">第一节：理想信念的内涵及其重要性</h2><h3 id="1-1-什么是理想信念">1.1 什么是理想信念</h3><ul class="lvl-0"><li class="lvl-2"><p>理想是人们在实践中形成的、有实现可能性的、对未来社会和自身发展目标的向往与追求，是人们的世界观、人生观和价值观在奋斗目标上的集中体现</p><ul class="lvl-2"><li class="lvl-4">①理想具有超越性</li><li class="lvl-4">②理想具有实践性。作为一定的社会实践的产物，理想是处在特定历史条件下的人们对社会实践活动理性认识的结晶。离开了实践，任何理想的产生都是不可思议的。理想的实现，同样也离不开实践。</li><li class="lvl-4">③理想具有时代性</li></ul></li><li class="lvl-2"><p>信念是人们在一定的认识基础上确立的对某种思想或事物坚信不疑并身体力行的精神状态。</p></li><li class="lvl-2"><p>信念是认知、情感和意志的有机统一体，为人们矢志不渝、百折不挠地追求理想目标提供了强大的精神动力</p><ul class="lvl-2"><li class="lvl-4">信念具有执着性。信念因其执着而为信念。信念一旦形成，就不会轻易改变</li><li class="lvl-4">信念具有支撑性。心有所信，方能行远</li><li class="lvl-4">信念具有多样性。信仰是<strong>最高层次</strong>的信念，具有最大的统摄力</li></ul></li><li class="lvl-2"><p>理想是信念所指的对象，信念则是理想实现的保障。</p></li></ul><h3 id="1-2-理想信念是精神之-钙">1.2 理想信念是精神之&quot;钙&quot;</h3><ul class="lvl-0"><li class="lvl-2"><p>①理想指引方向，信念决定成败。</p></li><li class="lvl-2"><p>②理想信念昭示奋斗目标。人的理想信念反应的是对社会和人自身发展的期望</p></li><li class="lvl-2"><p>③理想信念催生前进动力</p></li><li class="lvl-2"><p>④理想信念提供精神支柱</p></li><li class="lvl-2"><p>⑤理想信念提高精神境界</p></li><li class="lvl-2"><p>大学生只有树立崇高的理想信念，才能激发起为民族复兴和人民幸福而发愤学习的强烈责任感与使命感，掌握祖国建设、服务人民的本领。不论今后从事什么职业，大学生都要把个人的奋斗志向同国家和民族的前途命运紧紧联系在一起，把个人的学习进步同祖国的繁荣昌盛紧紧联系在一起，使理想信念之花结出丰硕的成长成才之果</p></li></ul><h2 id="第二节：坚定信仰信念信心">第二节：坚定信仰信念信心</h2><h3 id="2-2-增强对中国特色社会主义的信念">2.2 增强对中国特色社会主义的信念</h3><ul class="lvl-0"><li class="lvl-2"><p>实现中华民族伟大复兴，要求我们必须增强对中国特色社会主义的坚定信念</p></li><li class="lvl-2"><p>中国特色社会主义是<strong>科学社会主义</strong>，不是别的什么主义</p></li><li class="lvl-2"><p><strong>在当代中国，坚持中国特色社会主义，就是真正坚持科学社会主义</strong></p></li><li class="lvl-2"><p>中国共产党领导是中国特色社会主义最本质的特征，是中国特色社会主义制度的最大优势，是党和国家的根本所在，命脉所在，是全国各族人民的利益所系，命运所系</p></li><li class="lvl-2"><p>实现中华民族伟大复兴，是中华民族近代以来最伟大的梦想</p></li></ul><h2 id="第三节：在实现中国梦的实践中放飞青春梦想">第三节：在实现中国梦的实践中放飞青春梦想</h2><h3 id="3-2-坚持个人理想与社会理想的有机结合">3.2 坚持个人理想与社会理想的有机结合</h3><ul class="lvl-0"><li class="lvl-2"><p>①<strong>个人理想以社会理想为指引</strong>。追求个人理想的实践活动都是在社会中进行的，正确的个人理想不是依个人主观愿望随意确定的，从根本上说它是由正确的社会理想规定的。</p></li><li class="lvl-2"><p>②同时，<strong>个人理想的实现，必须以社会理想的实现为前提和基础</strong>。因此，在整个理想体系中，社会理想是最根本、最重要的，而个人理想则从属于社会理想</p></li><li class="lvl-2"><p>③换句话说，<strong>个人理想的确立要以社会理想为引导，个人理想的实现依赖于社会理想的实现</strong></p></li><li class="lvl-2"><p>④<strong>个人理想只有同国家的的前途、民族的命运相结合，个人的向往和追求只有同社会的需要和人民的利益相一致，才可能变为现实。</strong></p></li><li class="lvl-2"><p>⑤<strong>社会理想是个人理想的汇聚和升华</strong>。</p></li><li class="lvl-2"><p>⑥社会理想归根到底要靠全体社会成员的共同努力来实现，并具体体现在每个社会成员为实现个人理想而进行的活生生的实践中</p></li></ul><h1>第三章 继承优良传统 弘扬中国精神</h1><h2 id="第一节：中国精神是兴国强国之魂">第一节：中国精神是兴国强国之魂</h2><h3 id="1-3-实现中国梦必须弘扬中国精神">1.3 实现中国梦必须弘扬中国精神</h3><ul class="lvl-0"><li class="lvl-2"><p>实现中华民族伟大复兴的中国梦、开启社会主义现代化国家建设新征程，必须大力弘扬中国精神，弘扬以爱国主义为核心的民族精神和以改革创新为核心的时代精神，振奋起全民族的“精气神”</p></li><li class="lvl-2"><p>凝聚民族复兴的磅礴伟力</p><ul class="lvl-2"><li class="lvl-4">①凝聚中国力量的精神纽带</li><li class="lvl-4">②激发创新创造的精神动力</li><li class="lvl-4">③推进复兴伟业的精神支柱</li></ul></li><li class="lvl-2"><p>爱国主义的基本内涵主要表现在四个方面</p><ul class="lvl-2"><li class="lvl-4">①爱祖国的大好河山</li><li class="lvl-4">②爱自己的骨肉同胞</li><li class="lvl-4">③爱祖国的灿烂文化</li><li class="lvl-4">④爱自己的国家</li></ul></li></ul><h2 id="第二节：做新时代的忠诚爱国者">第二节：做新时代的忠诚爱国者</h2><ul class="lvl-0"><li class="lvl-2"><p>大力弘扬新时代爱国主义，必须坚持爱国爱党爱社会主义相统一、维护祖国统一和民族团结、尊重和传承中华民族历史文化、坚持立足中国又面向世界</p></li></ul><h3 id="2-1-坚持爱国爱党爱社会主义相统一">2.1 坚持爱国爱党爱社会主义相统一</h3><ul class="lvl-0"><li class="lvl-2"><p>新中国是中国共产党领导的社会主义国家，祖国的命运和党的命运、社会主义的命运密不可分。当代中国，爱国主义的本质就是坚持爱国和爱党、爱社会主义高度统一</p></li><li class="lvl-2"><p>我们爱的“国”是中国共产党领导的社会主义中国</p></li><li class="lvl-2"><p>爱国爱党爱社会主义统一于实现中华民族伟大复兴的历史进程</p></li><li class="lvl-2"><p>爱国主义的丰富性和生命力，正是通过它的历史性和现实性来表现的</p></li></ul><h2 id="第三节：让改革创新成为青春远航的动力">第三节：让改革创新成为青春远航的动力</h2><h3 id="3-3-做改革创新生力军">3.3 做改革创新生力军</h3><ul class="lvl-0"><li class="lvl-2"><p>树立改革创新的自觉意识</p><ul class="lvl-2"><li class="lvl-4">改革创新，要求大学生自觉增强改革创新的责任感，树立敢于突破陈规、大胆探索未知、勇于创新创造的思想观念，在实践中有直面困难的勇气，有突破难关的精神，锐意进取，奋力前行</li><li class="lvl-4">①增强改革创新的责任感</li><li class="lvl-4">②树立敢于突破陈规的意识</li><li class="lvl-4">③树立大胆探索未知领域的信心</li></ul></li><li class="lvl-2"><p>增强改革创新的能力本领</p><ul class="lvl-2"><li class="lvl-4">①夯实创新基础</li><li class="lvl-4">②培养创新思维</li><li class="lvl-4">③投身改革创新实践</li></ul></li></ul><h1>第四章 明确价值要求 践行价值准则</h1><h2 id="第一节：全体人民共同的价值追求">第一节：全体人民共同的价值追求</h2><h3 id="1-1-价值观与社会主义核心价值观">1.1 价值观与社会主义核心价值观</h3><ul class="lvl-0"><li class="lvl-2"><p>人们的社会存在和社会生活是具体的、现实的，是属于一定时代的，反映社会存在和社会生活的价值观总是表现出鲜明的时代特点</p></li><li class="lvl-2"><p>社会主义价值观和社会主义核心价值体系是紧密联系、互为依存、相辅相成的</p></li></ul><h3 id="1-2-社会主义核心价值观的基本内容">1.2 社会主义核心价值观的基本内容</h3><ul class="lvl-0"><li class="lvl-2"><p>富强、民主、文明、和谐</p></li><li class="lvl-2"><p>自由、平等、公正、法治</p></li><li class="lvl-2"><p>爱国、敬业、诚信、友善</p></li><li class="lvl-2"><p>富强是促进社会进步、人的自由全面发展的物质基础，体现了马克思主义唯物史观生产力标准的根本要求。</p></li><li class="lvl-2"><p>富强，就是人民的富裕和国家的强盛。</p><ul class="lvl-2"><li class="lvl-4">富强在于富民，即人民富裕。社会主义生产力的发展，国家财富的创造，其根本目的都在于丰富人民的物质生活和精神生活。</li><li class="lvl-4">富强还在于强国，即国家强盛，体现为国家拥有强大的综合国力。</li><li class="lvl-4">人民富裕和国家强盛在根本上是统一的，这是社会主义的价值追求</li></ul></li></ul><h3 id="1-3-当代中国发展进步的精神指引">1.3 当代中国发展进步的精神指引</h3><ul class="lvl-0"><li class="lvl-2"><p>培育和践行社会主义核心价值观，是有效整合我国社会意识、凝聚社会价值共识、防范和化解社会矛盾、聚合磅礴之力的重大举措，是保证我国经济社会沿着正确的方向发展、实现中华民族伟大复兴的价值支撑，意义重大而深远</p></li><li class="lvl-2"><p>①坚持和发展中国特色社会主义的价值遵循</p></li><li class="lvl-2"><p>②提高国家文化软实力的迫切要求</p><ul class="lvl-2"><li class="lvl-4">一个国家的文化软实力，从根本上说，取决于其核心价值观的生命力、凝聚力、感召力。</li><li class="lvl-4">当今世界，文化越来越成为综合国力竞争的重要因素，成为经济社会发展的重要支撑，文化软实力越来越成为争夺发展制高点、道义制高点的关键所在</li><li class="lvl-4">文化软实力的竞争，本质上是不同文化所代表的的核心价值观的竞争</li><li class="lvl-4">现在，越来越多的国家把提升文化软实力确立为国家战略，价值观之争日趋激烈。</li><li class="lvl-4">培育和践行社会主义核心价值观<ul class="lvl-4"><li class="lvl-6">有利于增进国际社会对中国的理解，扩大中华文化的影响力，展示社会主义中国的良好形象</li><li class="lvl-6">有利于增强社会主义意识形态的竞争力，掌握话语权，赢得主动权，逐步打破西方的话语垄断、舆论垄断，维护国家文化利益和意识形态安全，不断提高我们国家的文化软实力</li></ul></li></ul></li><li class="lvl-2"><p>③推进社会团结奋进的“最大公约数”</p></li></ul><h2 id="第二节：社会主义核心价值观的显著特征">第二节：社会主义核心价值观的显著特征</h2><h3 id="2-2-彰显人民至上的价值立场">2.2 彰显人民至上的价值立场</h3><ul class="lvl-0"><li class="lvl-2"><p>为中国人民谋幸福，为中华民族谋复兴，是中国共产党人的初心和使命，也是我们党领导现代化建设的出发点和落脚点</p></li><li class="lvl-2"><p>特别是在2020年中国抗击新冠肺炎疫情斗争中，人民至上、生命至上成为最醒目的价值导向，深刻彰显了我国社会主义核心价值观的人民性。</p></li><li class="lvl-2"><p>习近平深刻指出，什么叫人民至上？这么多人围着一个病人转，这真正体现了不惜一切代价。</p></li><li class="lvl-2"><p>在保护人民生命安全面前，我们必须不惜一切代价，我们也能够做到不惜一切代价，因为中国共产党的根本宗旨是全心全意为人民服务，我们的国家是人民当家做主的社会主义国家、鲜明的人民性，使得社会主义核心价值观具有强大的感召力。</p></li></ul><h3 id="2-3-因真实可信而具有强大的道义力量">2.3 因真实可信而具有强大的道义力量</h3><ul class="lvl-0"><li class="lvl-2"><p>“普世价值”就是一种极具迷惑性、欺骗性并且带有鲜明政治倾向的价值观</p></li><li class="lvl-2"><p><strong>“普世价值”在理论上的虚伪性</strong>：事实上，西方国家所谓的“普世价值”并非指人类道德评价、审美评价的普遍性或共性，而是特指资本主义价值观；推行的并不是人类共同的价值观，而是特定的价值观及其背后的经济政治文化制度</p></li><li class="lvl-2"><p><strong>“普世价值”在实践上的虚伪性</strong>：其实，西方所谓的“普世价值”，在他们自己的世界里都未能真正“普适”。种族歧视、劳资对立、金钱政治、贫富分化、社会撕裂、人权无保障等问题，在一些西方国家长期存在且愈演愈烈，与他们所标榜的“普世价值”形成鲜明对照</p></li><li class="lvl-2"><p>反对西方所谓“普世价值”，并不是说人类社会不存在共同价值</p></li></ul><h1>第五章 遵守道德规范 锤炼道德品格</h1><h2 id="第一节：社会主义道德的核心与原则">第一节：社会主义道德的核心与原则</h2><h3 id="1-1-坚持马克思主义道德观">1.1 坚持马克思主义道德观</h3><ul class="lvl-0"><li class="lvl-2"><p>道德是一种特殊的社会意识形态，它是以<strong>善恶</strong>为评价方式，主要依靠社会舆论（<strong>他律</strong>）、传统习俗和内心信念（<strong>自律</strong>）来发挥作用的行为规范的总和</p></li><li class="lvl-2"><p>马克思主义道德观认为，人类社会的实际情况是：<strong>物质生活的生产方式制约着整个社会生活、政治生活和精神生活的过程</strong>。因此，劳动创造了人和人类社会，是道德起源的第一个历史前提</p></li><li class="lvl-2"><p><strong>社会关系是道德赖以产生的客观条件</strong>。可以说，道德正是适应社会关系尤其是利益关系调节的需要而产生的。</p></li><li class="lvl-2"><p><strong>人的自我意识是到的产生的主观条件</strong>。</p></li><li class="lvl-2"><p><strong>道德反应社会经济关系的特殊意识形态</strong>。道德的性质和基本准则，规范反应了与之相应的社会经济关系的性质和内容。</p></li><li class="lvl-2"><p><strong>道德是社会利益关系的特殊调节方式</strong>。道德是处于同一社会或同一生活环境中的人们在长期的共同生活过程中逐渐积累形成的要求、秩序和理想，它通过社会的道德风尚和个人的道德风范来调节利益关系</p></li><li class="lvl-2"><p>封建社会的道德：维护宗法利益</p></li><li class="lvl-2"><p>资本主义社会的道德：以个人主义，利己主义为核心</p></li><li class="lvl-2"><p>社会主义社会的道德：共产主义道德的初级形态</p></li><li class="lvl-2"><p>社会主义和共产主义道德，是人类道德合乎规律发展的必然产物，是人类道德发展史上的一种崭新类型的道德，是对人类道德传统的批判与继承，并必然随着社会的进步和实践的发展而与时俱进</p></li></ul><h3 id="1-2-坚持以为人民服务为核心">1.2 坚持以为人民服务为核心</h3><ul class="lvl-0"><li class="lvl-2"><p><strong>为人民服务是社会主义经济基础和人际关系的客观要求。</strong></p><ul class="lvl-2"><li class="lvl-4">在社会主义社会，每个劳动者和建设者都在为社会、为他人同时也是为自己而劳动和工作。</li><li class="lvl-4">各行各业的劳动者和建设者，只是社会分工不同，没有高低贵贱之分。</li><li class="lvl-4">权利和义务不再分属于两个对立的阶级，而是统一于人民自己身上，每个人都是服务对象，又都为他人服务，全体人民通过社会分工和相互服务来实现共同利益。</li></ul></li><li class="lvl-2"><p>**为人民服务是社会主义市场经济健康发展的要求。**社会主义市场经济，不仅不排斥为社会和他人服务，而且需要通过服务甚至是优质服务，才能实现市场主体的利益。</p></li><li class="lvl-2"><p>在今天，毫不利己、专门利人、无私奉献是为人民服务，顾全大局、先公后私、爱岗敬业、办事公道是为人民服务，热心公益、助人为乐、见义勇为、扶贫帮困、扶残助残是为人民服务，遵纪守法、诚实劳动并获取正当的个人利益同样也是为人民服务。</p></li><li class="lvl-2"><p>那种认为为人民服务只适于党员干部而不能推广到全体人民的看法是一种误解。</p></li></ul><h3 id="1-3-坚持以集体主义为原则">1.3 坚持以集体主义为原则</h3><ul class="lvl-0"><li class="lvl-2"><p>集体主义强调国家利益、社会整体利益高于个人利益</p></li><li class="lvl-2"><p>集体主义重视和保障个人的正当利益</p></li><li class="lvl-2"><p>集体主义可分为三个层次的要求：</p><ul class="lvl-2"><li class="lvl-4">①无私奉献，一心为公。</li><li class="lvl-4">②先公后私，先人后己</li><li class="lvl-4">③顾全大局、遵纪守法、热爱祖国、诚实劳动，以正当合法的手段保障个人利益</li></ul></li></ul><h2 id="第二节：吸收借鉴优秀道德成果">第二节：吸收借鉴优秀道德成果</h2><h3 id="2-1-传承中华传统美德">2.1 传承中华传统美德</h3><ul class="lvl-0"><li class="lvl-2"><p>“复古论”和“虚无论”这两种观点都是错误的，割断了道德的历史与发展的关系，都不利于社会的发展和道德的进步</p></li></ul><h3 id="2-2-发扬中国革命道德">2.2 发扬中国革命道德</h3><ul class="lvl-0"><li class="lvl-2"><p>中国革命道德继承了中国传统道德的精华，崛起了传统道德的糟粕，是中国优良传统道德的延续和发展，是超越了中华传统美德的时代局限而形成的一种崭新的道德</p></li><li class="lvl-2"><p>中国革命道德的主要内容：</p><ul class="lvl-2"><li class="lvl-4">①为实现社会主义和共产主义的理想信念而奋斗</li><li class="lvl-4">②全心全意为人民服务</li><li class="lvl-4">③始终把革命利益放在首位</li><li class="lvl-4">④树立社会新风，建立新型人际关系</li><li class="lvl-4">⑤修身自律，保持节操</li></ul></li><li class="lvl-2"><p>大学生发扬革命道德、传承红色基因，就要深入了解中国社会和中国革命的历史，了解中国共产党的人带领广大人民群众进行革命斗争的艰苦实践，真正体会中国革命道德的本质内涵、历史意义和当代价值，自觉同各种歪曲历史、诋毁英雄的历史虚无主义思潮作斗争，努力在坚持和发展中国特色社会主义伟大进程中创造无愧于时代、无愧于人民、无愧于先辈的业绩</p></li></ul><h2 id="第三节：投身崇德向善的道德实践">第三节：投身崇德向善的道德实践</h2><h3 id="3-1-遵守社会公德">3.1 遵守社会公德</h3><ul class="lvl-0"><li class="lvl-2"><p>公共生活具有以下四个方面的特征：</p><ul class="lvl-2"><li class="lvl-4">①活动范围的广泛性</li><li class="lvl-4">②活动内容的开放性</li><li class="lvl-4">③交往对象的复杂性</li><li class="lvl-4">④活动方式的多样性</li></ul></li><li class="lvl-2"><p>从本质上说，网络交往仍然是人与人的现实交往，网络生活也是人的真实生活。网络生活中的道德要求，是人们在网络生活中为了维护正常的网络公共秩序需要共同遵守的基本道德准则，是社会公德在网络空间的运用和扩展</p></li><li class="lvl-2"><p>大学生网络生活要求：</p><ul class="lvl-2"><li class="lvl-4">①正确使用网络工具</li><li class="lvl-4">②加强网络文明自律<ul class="lvl-4"><li class="lvl-6">进行健康网络交往</li><li class="lvl-6">自觉避免沉迷游戏</li><li class="lvl-6">加强网络道德自律</li></ul></li><li class="lvl-4">③营造良好网络道德环境</li></ul></li></ul><h3 id="3-2-恪守职业道德">3.2 恪守职业道德</h3><ul class="lvl-0"><li class="lvl-2"><p>在生活中，必须牢固树立“劳动最光荣、劳动最崇高、劳动最美丽”的观念，通过劳动创造更加美好的生活。无论从事什么事，都要干一行、爱一行、钻一行。只要踏实劳动、勤勉工作，在平凡岗位上也能干出不平凡的业绩</p></li><li class="lvl-2"><p>职业生活中的道德规范即职业道德，是指从事一定职业的人在职业生活中应当遵循的具有职业特征的道德要求和行为准则，涵盖了从业人员与服务对象、职业与职工、职业与职业之间的关系</p></li><li class="lvl-2"><p>爱岗敬业、诚实守信、办事公道、热情服务和奉献社会是职业生活中的基本道德规范</p></li></ul><h1>第六章 学习法治思维 提升法治素养</h1><h2 id="第一节：社会主义法律的特征和运行">第一节：社会主义法律的特征和运行</h2><h3 id="1-1-法律及其历史发展">1.1 法律及其历史发展</h3><ul class="lvl-0"><li class="lvl-2"><p>**①法律是由国家创制和实施的行为规范。**在保证法律实施的过程中，法律意识、道德观念、价值观念、纪律观念也发挥着重要作用</p></li><li class="lvl-2"><p>**②法律由一定的社会物质生活条件所决定。**物质资料生产方式既是决定社会面貌、性质和发展的根本因素，也是决定法律本质、内容和发展方向的根本因素</p></li><li class="lvl-2"><p>**③法律是统治阶级意志的体现。**法律所体现的统治阶级意志，并不是统治阶级意志的全部，仅仅是上升为国家意志的那部分意志。</p></li><li class="lvl-2"><p>综上所述，可以将法律定义为：<strong>法律是由国家制定或认可并由国家强制力保证实施的，反应由特定社会物质生活条件所决定的统治阶级意志的规范体系。</strong></p></li><li class="lvl-2"><p>法律随着私有制、阶级和国家的产生而产生，也将随着私有制、阶级和国家的消亡而消亡</p></li><li class="lvl-2"><p>资本主义法律，归根结底是为了维护资产阶级根本利益的法律。</p></li><li class="lvl-2"><p>我国社hi主义法律体系体现了党的主张和人民意志的统一。<strong>我国社会主义法律既具有鲜明的阶级性，又具有广泛的人民性，体现了阶级性与人民性的统一。</strong></p></li><li class="lvl-2"><p>党纪严于国法，国法高于党纪</p></li><li class="lvl-2"><p>我国社会主义法律的运行具有鲜明的中国特色</p></li><li class="lvl-2"><p>法律制定（P187）、法律执行（P188）、法律适用（P188）、法律遵守（P189）</p></li></ul><h2 id="第二节：坚持全面依法治国">第二节：坚持全面依法治国</h2><h3 id="2-2-坚持走中国特色社会主义法治道路">2.2 坚持走中国特色社会主义法治道路</h3><ul class="lvl-0"><li class="lvl-2"><p>走中国特色社会主义法治道路，必须坚持中国共产党的领导，坚持人民主体地位，坚持法律面前人人平等，坚持依法治国和以德治国相结合，坚持从中国实际出发</p></li></ul><h3 id="2-3-建设法治中国">2.3 建设法治中国</h3><ul class="lvl-0"><li class="lvl-2"><p>**科学立法是全面依法治国的前提，严格执法是全面依法治国的关键，公正司法是全面依法治国的重点，全民守法是全面依法治国的基础。**全面以法治固，必须从立法、执法、司法、守法四个方面统筹推进。</p></li></ul><h2 id="第三节：维护宪法权威">第三节：维护宪法权威</h2><h3 id="3-2-我国宪法地位和基本原则">3.2 我国宪法地位和基本原则</h3><ul class="lvl-0"><li class="lvl-2"><p>宪法的基本原则是贯穿宪法规范始终，对宪法的制定、修改、实施、遵守等环节起指导作用的基本准则</p></li><li class="lvl-2"><p>我国宪法的基本原则集中反应了规范权力运行、保障公民权力的基本精神，体现了社会主义法治的根本性质</p></li><li class="lvl-2"><p>基本原则内容：</p><ul class="lvl-2"><li class="lvl-4">①党的领导原则</li><li class="lvl-4">②人民当家作主原则</li><li class="lvl-4">③尊重和保障人权原则</li><li class="lvl-4">④社会主义法治原则</li><li class="lvl-4">⑤民主集中制原则</li></ul></li></ul><h2 id="第四节：自觉尊法学法守法用法">第四节：自觉尊法学法守法用法</h2><h3 id="4-1-培养社会主义法治思维">4.1 培养社会主义法治思维</h3><ul class="lvl-0"><li class="lvl-2"><p>法律的普遍适用性，是指法律在本国主权范围内对所有人具有普遍的约束力。</p></li><li class="lvl-2"><p>法律的优先适用性，是指当同一项社会关系同时受到多种社会规范的调整而多种社会规范又相互矛盾时，要优先考虑法律规范的适用。</p></li><li class="lvl-2"><p>法律的不可违抗性，是指法律必须遵守，违反法律要受到惩罚</p></li></ul><h3 id="4-2-依法行使权力与履行义务">4.2 依法行使权力与履行义务</h3><ul class="lvl-0"><li class="lvl-2"><p>法律义务的履行表现为两种形式：</p><ul class="lvl-2"><li class="lvl-4">一种是作为，是指义务人实施积极的行为，如子女通过经常看望和提供财务等行为履行赡养父母的义务等</li><li class="lvl-4">另一种是不作为，是指义务人不得实施某种行为，如未经许可不得公开他人隐私等。</li></ul></li><li class="lvl-2"><p>法律义务具有法定的强制性，违反法律义务必须承担法律责任</p></li><li class="lvl-2"><p>人格尊严权：即与人身有密切联系的名誉、姓名、肖像等不容侵犯的权利。</p></li><li class="lvl-2"><p>人格尊严是人之为人所应当享有的地位、待遇或尊重的总和，集中表现为人的自尊心和自爱心。</p></li><li class="lvl-2"><p>人格尊严权的基本内容有姓名权、肖像权、名誉权、荣誉权、隐私权等</p></li><li class="lvl-2"><p><strong>①权利行使目的的正当性</strong>：公民在行使法律权利时，不仅要在形式上符合相关法律的规定，也要符合立法意图和精神，不得违反宪法法律确定的基本原则，保障权利行使的正当性。此外，行使权利不得破坏公序良俗，妨碍法律的社会功能和法律价值的实现。</p></li><li class="lvl-2"><p><strong>②权利行使的必要限度</strong>：任何权利的行使都不是绝对的，都有其相应的限度，必须依照法律规定的限度来行使权力。</p></li><li class="lvl-2"><p>**③权利行使方式的法定性：**权利行使的方式分为口头方式、书面方式和行为方式，有时口头方式和书面方式可以兼用。</p></li><li class="lvl-2"><p>**④权利行使的正当程序：**由于一个人行使权利的过程可能就是另一个人履行义务的过程，所以程序正当原则同样适用于权利行使过程。通常情况下，行使权利的程序是法律规定的。</p></li></ul><h3 id="4-3-不断提升法治素养">4.3 不断提升法治素养</h3><ul class="lvl-0"><li class="lvl-2"><p>人民权益要靠法律保障，法律权威要靠人民维护。</p></li><li class="lvl-2"><p>就大学生而言，作为一个公民，要在尊重法律权威方面加强砥砺，在学习和生活中积极作为，养成敬畏法律的良好品质，努力成为尊重法律权威、信仰法律的先锋。</p></li><li class="lvl-2"><p>法律知识通常包括法律法规方面的知识和法律原理、原则方面的知识，这两部分法律知识对于培养法治思维、提升法治素养都很重要</p></li><li class="lvl-2"><p>养成守法习惯：增强规则意识，守住法律底线。</p></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>大学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Home Assistant后续 - 接入米家蓝牙设备</title>
    <link href="/a9464a0f89ed/"/>
    <url>/a9464a0f89ed/</url>
    
    <content type="html"><![CDATA[<h1>Home Assistant 更新</h1><p>月底的时候发现HA有新版本，直接进入容器，执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip install --upgrade pip <br>pip install --upgrade homeassistant -i https://pypi.tuna.tsinghua.edu.cn/simple <span class="hljs-comment">#使用清华源</span><br></code></pre></td></tr></table></figure><p>有个鸡贼的事情，pip最新版本是<code>21.多</code>，但是Home Assistant支持的pip版本是小于21的，然而，如果我不执行第一条，会一直报错更新失败，而更新到21版本后，又看着HA把pip退回到20，但是这时候更新好了</p><p>整个就是一个$$ ? $$</p><h1>Home Assistant接入Mijia蓝牙设备</h1><p>这里以我刚买的米家蓝牙电子温湿度计为例</p><p>首先需要通过米家APP将这个电子温湿度计接入小米账号</p><p>接入后在HA后台的<code>hass-xiaomi-miot</code>集成里更新设备，更新后会在设备里多一个<code>Xiaomi Digital Temperature and Humidity Monitor</code></p><h2 id="获取蓝牙设备一些信息">获取蓝牙设备一些信息</h2><h3 id="获取MAC地址">获取MAC地址</h3><p>打开米家APP，进入蓝牙设备管理页面后点右上角三个小圆点进入设置，在<code>关于</code>里就有蓝牙设备的MAC地址，不需要像网上说的那么复杂</p><h3 id="获取V5-ENCRYPTION-KEY">获取V5 ENCRYPTION KEY</h3><p>小米的蓝牙设备数据是加密过的，我们需要给后面的<code>BLE Monitor</code>插件提供解密密钥来解密数据</p><p>github链接：<a href="https://github.com/PiotrMachowski/Xiaomi-cloud-tokens-extractor">https://github.com/PiotrMachowski/Xiaomi-cloud-tokens-extractor</a></p><p>这个python脚本用来获取账号绑定的米家设备的一些信息，其中就包括蓝牙设备的加密秘钥，方法在README里已经说很清楚了，执行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://github.com/PiotrMachowski/Xiaomi-cloud-tokens-extractor/releases/latest/download/token_extractor.zip<br>unzip token_extractor.zip<br><span class="hljs-built_in">cd</span> token_extractor<br>pip3 install -r requirements.txt <span class="hljs-comment"># 安装依赖项</span><br>python3 token_extractor.py <span class="hljs-comment"># 执行脚本</span><br></code></pre></td></tr></table></figure><p>这个脚本会要求你输入小米账号及密码，输入后会让你选择所属区域，对于国人来说就是cn了，里面涉及的英文不难</p><p>我们重点要的是这个32位Encryption Key：</p><p><img src="https://files.ozline.icu/images/blog/HA/HA-07.png" alt="image-20220101211055549"></p><h2 id="安装BLE-Monitor插件">安装BLE Monitor插件</h2><p>我给树莓派已经安装了Samba，可以从Finder直接SMB访问树莓派</p><p>对于HA，统一在<code>/home-assistant/custom_components/</code>安装外部插件，上一篇里我安装过了<code>hass-xiaomi-miot</code>插件，这个文件夹就已经存在了，如果没有安装过插件，可以手动创建新文件夹</p><p>github链接：<a href="https://github.com/custom-components/ble_monitor">https://github.com/custom-components/ble_monitor</a></p><p>把整个source下载下来（zip downlolad），复制<code>custom_components</code>文件夹里面的<code>ble_monitor</code>文件夹，直接粘贴到刚刚<code>/home-assistant/custom_components/</code>里</p><p>进入HA后台，在<code>配置-&gt;设置-&gt;服务管理</code>里重新启动Home Assistant服务</p><p>重新启动后在<code>配置-&gt;设备和服务-&gt;集成-&gt;添加集成</code>里添加<code>Passive BLE monitor </code>，跳出的配置页不用管，直接点下一步就可以</p><h2 id="配置BLE-Monitor以解密设备数据">配置BLE Monitor以解密设备数据</h2><p>编辑<code>/home-assistant/comfiguration.yaml</code>，在行尾添加下面代码：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># ble monitor</span><br><span class="hljs-attr">ble_monitor:</span><br>  <span class="hljs-attr">hci_interface:</span> <span class="hljs-number">0</span><br>  <span class="hljs-attr">batt_entities:</span> <span class="hljs-literal">True</span><br>  <span class="hljs-attr">discovery:</span> <span class="hljs-literal">False</span><br>  <span class="hljs-attr">devices:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">mac:</span> <span class="hljs-string">&#x27;前面获取的设备mac地址&#x27;</span><br>      <span class="hljs-attr">encryption_key:</span> <span class="hljs-string">&#x27;前面获取的32位密钥&#x27;</span><br><br></code></pre></td></tr></table></figure><p>然后进入HA后台，在<code> 配置-&gt;设置-&gt;配置检查</code>里检查配置文件是否正确，如果无误的话就再重启HA设备</p><h1>收工</h1><p>由于蓝牙设备广播（以我这个设备）会有时间间隔（通常为1分钟\5分钟\10分钟），因此需要过一会儿才能在<code>Bluetooth Low Energy Monitor</code>这个集成里找到设备（找到这个设备可能不用这么久）并且获取当前数据（温度、湿度等等）</p><p>最终成果展示</p><p><img src="https://files.ozline.icu/images/blog/HA/HA-08.png" alt="image-20220101212049895"></p>]]></content>
    
    
    <categories>
      
      <category>RaspBerryPi</category>
      
    </categories>
    
    
    <tags>
      
      <tag>智能家居</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】HDU-2089 不要62</title>
    <link href="/620286314092/"/>
    <url>/620286314092/</url>
    
    <content type="html"><![CDATA[<h1>HDU-2089 不要62</h1><p>HDU：<a href="https://acm.dingbacode.com/showproblem.php?pid=2089">https://acm.dingbacode.com/showproblem.php?pid=2089</a></p><h2 id="题目">题目</h2><blockquote><p>杭州人称那些傻乎乎粘嗒嗒的人为62（音：laoer）。杭州交通管理局经常会扩充一些的士车牌照，新近出来一个好消息，以后上牌照，不再含有不吉利的数字了，这样一来，就可以消除个别的士司机和乘客的心理障碍，更安全地服务大众。不吉利的数字为所有含有4或62的号码。例如：<br>62315 73418 88914<br>都属于不吉利号码。但是，61152虽然含有6和2，但不是62连号，所以不属于不吉利数字之列。你的任务是，对于每次给出的一个牌照区间号，推断出交管局今次又要实际上给多少辆新的士车上牌照了。</p></blockquote><blockquote><p>输入的都是整数对n、m（0&lt;n≤m&lt;1000000），如果遇到都是0的整数对，则输入结束。</p><p>对于每个整数对，输出一个不含有不吉利数字的统计个数，该数值占一行位置。</p></blockquote><h2 id="思路">思路</h2><p>数位dp，搜索记忆</p><p>这是我学习动态规划的第一道题，这道题可能难度从广义上讲很简单，但我确实花了一些时间来学习</p><p>参考了这个博主写的题解：<a href="https://www.cnblogs.com/2000liuwei/p/10604834.html">https://www.cnblogs.com/2000liuwei/p/10604834.html</a></p><p>这位博主从题设条件仅为<code>不要4的牌照</code>开始说起，上手难度低，而且便于理解，他提供了3份代码，一份是没有dp纯粹dfs的代码，另一份是有dp的dfs的代码，而这两份代码都只解决了<code>不要4的牌照</code>这个问题，最后才贴上了STD，而STD仅仅只是在第二份代码上添了几行罢了</p><p>但这道题的思路是可以学习的，对于输入数字后首先储存每位数字（num数组），然后开始搜索，搜索过程中会判断是否触发limit（上限，也就是说搜索抵达了边界条件，也就是最大数字），若没有触发，则进行全搜索，搜索过程中储存答案，便于下次搜索时直接调用，减少时间复杂度</p><p>更多详细的内容可以直接参考我这份并没有作什么修改的代码，我在里面添加了注释：</p><h2 id="代码">代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> infreopen() freopen(<span class="hljs-string">&quot;in.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> outfreopen() freopen(<span class="hljs-string">&quot;out.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>,stdout);</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> setzero(a) memset(a,0,sizeof(a));</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br>ll num[<span class="hljs-number">101</span>];<br>ll dp[<span class="hljs-number">101</span>][<span class="hljs-number">2</span>];<br><span class="hljs-comment">//这里的dp又叫记忆化搜索,保留搜索结果，减少时间复杂度</span><br><span class="hljs-comment">//这个dp储存了，数字长度在len下，没有6和有6时的结有效牌照数量</span><br><span class="hljs-comment">//而当触发limit=时，这个dp不储存（因为不完整），这时候就用到了普通的dfs搜索</span><br><br><span class="hljs-comment">//这里面的dfs从高位搜索到低位</span><br><span class="hljs-function">ll <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> len,<span class="hljs-type">bool</span> ifsix,<span class="hljs-type">bool</span> limit)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(!len) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span>(!limit&amp;&amp;dp[len][ifsix]!=<span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> dp[len][ifsix];<br>    ll ans=<span class="hljs-number">0</span>;<br>    ll maxn=limit?num[len]:<span class="hljs-number">9</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;=maxn;i++)&#123;<br>        <span class="hljs-keyword">if</span>(i==<span class="hljs-number">4</span>) <span class="hljs-keyword">continue</span>;<span class="hljs-comment">//遇到4直接跳过</span><br>        <span class="hljs-keyword">if</span>(i==<span class="hljs-number">2</span>&amp;&amp;ifsix) <span class="hljs-keyword">continue</span>;<span class="hljs-comment">//遇到62跳过</span><br>        ans+=<span class="hljs-built_in">dfs</span>(len<span class="hljs-number">-1</span>,i==<span class="hljs-number">6</span>,limit&amp;&amp;i==maxn);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!limit) dp[len][ifsix]=ans;<br>    <span class="hljs-keyword">return</span> ans;<br>    <span class="hljs-comment">//这个limit指的是触发边界条件（指的就是m和n）时的一些操作，比如不计入dp里面（因为这时候统计不完整）</span><br>  <span class="hljs-comment">//当然，这个limit只有每位都是上限的时候才会触发，这也是为什么会有limit&amp;&amp;i==maxn这个语句</span><br>  <span class="hljs-comment">//例如我们搜索101，必须当百位是1（limit=true）且十位刚好等于0的时候，个位数的dfs才会触发limit</span><br>&#125;<br><br><span class="hljs-function">ll <span class="hljs-title">solve</span><span class="hljs-params">(ll x)</span></span>&#123;<br>    <span class="hljs-built_in">setzero</span>(num);<br>    <span class="hljs-type">int</span> len=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(x)&#123;<br>        num[++len]=x%<span class="hljs-number">10</span>;<br>        x/=<span class="hljs-number">10</span>;<br>    &#125;<br>    <span class="hljs-comment">//把数字拆成每一位储存到num数组里，利用len表示长度</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">dfs</span>(len,<span class="hljs-literal">false</span>,<span class="hljs-literal">true</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">infreopen</span>();<br>    ll m,n;<br>    <span class="hljs-built_in">memset</span>(dp,<span class="hljs-number">-1</span>,<span class="hljs-built_in">sizeof</span>(dp));<br>    <span class="hljs-comment">//把dp初始化放到外面，这样遇到多个数据都可以调用同一个dp，快速减少时间复杂度</span><br>    <span class="hljs-keyword">while</span>(~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld %lld&quot;</span>,&amp;m,&amp;n))&#123;<br>        <span class="hljs-keyword">if</span>(m==<span class="hljs-number">0</span>&amp;&amp;n==<span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>,<span class="hljs-built_in">solve</span>(n)-<span class="hljs-built_in">solve</span>(m<span class="hljs-number">-1</span>));<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>HDU题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】HDU-1013 Digital Roots</title>
    <link href="/0322af2807f3/"/>
    <url>/0322af2807f3/</url>
    
    <content type="html"><![CDATA[<h1>HDU-1013 Digital Roots</h1><p>HDU：<a href="https://acm.dingbacode.com/showproblem.php?pid=1013">https://acm.dingbacode.com/showproblem.php?pid=1013</a></p><h2 id="题目">题目</h2><blockquote><p>The digital root of a positive integer is found by summing the digits of the integer. If the resulting value is a single digit then that digit is the digital root. If the resulting value contains two or more digits, those digits are summed and the process is repeated. This is continued as long as necessary to obtain a single digit.</p><p>For example, consider the positive integer 24. Adding the 2 and the 4 yields a value of 6. Since 6 is a single digit, 6 is the digital root of 24. Now consider the positive integer 39. Adding the 3 and the 9 yields 12. Since 12 is not a single digit, the process must be repeated. Adding the 1 and the 2 yeilds 3, a single digit and also the digital root of 39.</p></blockquote><h2 id="思路">思路</h2><p>没有思路，按题目走就是对的</p><p>关键在于：要认识到c++对于int类型的除法，不是四舍五入而是取整，整个过程就没什么大问题了</p><h2 id="代码">代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> inFre() freopen(<span class="hljs-string">&quot;in.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> outFre() freopen(<span class="hljs-string">&quot;out.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>,stdout);</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> setZero(a) memset(a,0,sizeof(a));</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXMUM 1000001</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">inFre</span>();<br>    <span class="hljs-type">char</span> c[MAXMUM];<br>    <span class="hljs-type">int</span> len=<span class="hljs-number">0</span>,sum=<span class="hljs-number">0</span>,tmp=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>,c))&#123;<br>        <span class="hljs-keyword">if</span>(c[<span class="hljs-number">0</span>]==<span class="hljs-number">48</span>) <span class="hljs-keyword">break</span>;<br>        len=<span class="hljs-built_in">strlen</span>(c);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++) sum+=c[i]<span class="hljs-number">-48</span>;<br>        <span class="hljs-keyword">while</span>(sum&gt;<span class="hljs-number">9</span>)&#123;<br>            tmp=sum;sum=<span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span>(tmp)&#123;<br>                sum+=tmp%<span class="hljs-number">10</span>;tmp/=<span class="hljs-number">10</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,sum);sum=<span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>HDU题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】POJ-1833 排列</title>
    <link href="/bad3fa39caf9/"/>
    <url>/bad3fa39caf9/</url>
    
    <content type="html"><![CDATA[<h1>POJ-1833 排列</h1><p>POJ：<a href="http://poj.org/problem?id=1833">http://poj.org/problem?id=1833</a></p><h2 id="题目">题目</h2><blockquote><p>题目描述：大家知道，给出正整数n，则1到n这n个数可以构成n！种排列，把这些排列按照从小到大的顺序（字典顺序）列出，如n=3时，列出1 2 3，1 3 2，2 1 3，2 3 1，3 1 2，3 2 1六个排列。</p><p>任务描述：给出某个排列，求出这个排列的下k个排列，如果遇到最后一个排列，则下1排列为第1个排列，即排列1 2 3…n。比如：n = 3，k=2 给出排列2 3 1，则它的下1个排列为3 1 2，下2个排列为3 2 1，因此答案为3 2 1。</p></blockquote><h2 id="思路">思路</h2><p>这是一道字典序算法模板题</p><p>找这组数字的下一个排序，算法为：</p><ul class="lvl-0"><li class="lvl-2"><p>从右至左找到第一个数，这个数满足这个数右边那个数比这个数大，记这个数为a</p></li><li class="lvl-2"><p>继续从右至左找到第一个比a大的数，记为b</p></li><li class="lvl-2"><p>交换a和b，再把a后面的数按从小到大重新排序</p></li></ul><p>如果要求下$$ k $$ 个排序，就重复$$ k $$ 次</p><h2 id="代码">代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> inFre() freopen(<span class="hljs-string">&quot;in.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> outFre() freopen(<span class="hljs-string">&quot;out.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>,stdout);</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> setZero(a) memset(a,0,sizeof(a));</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXMUM 10240</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">inFre</span>();<br>    <span class="hljs-type">int</span> m,n,k,p[MAXMUM],tmp1,tmp2;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;m);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> m1=<span class="hljs-number">0</span>;m1&lt;m;m1++)&#123;<br>        <span class="hljs-built_in">setZero</span>(p);<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>,&amp;n,&amp;k);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d &quot;</span>,&amp;p[i]);<br>        <span class="hljs-keyword">while</span>(k&gt;<span class="hljs-number">0</span>)&#123;<br>            k--;tmp1=<span class="hljs-number">-1</span>;tmp2=<span class="hljs-number">-1</span>;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=n<span class="hljs-number">-1</span>;i&gt;<span class="hljs-number">0</span>;i--)&#123;<br>                <span class="hljs-keyword">if</span>(p[i]&gt;p[i<span class="hljs-number">-1</span>])&#123;<br>                    tmp1=i<span class="hljs-number">-1</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(tmp1==<span class="hljs-number">-1</span>)&#123;<br>                <span class="hljs-built_in">sort</span>(p,p+n);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=n<span class="hljs-number">-1</span>;i&gt;<span class="hljs-number">-1</span>;i--)&#123;<br>                    <span class="hljs-keyword">if</span>(p[i]&gt;p[tmp1])&#123;<br>                        tmp2=i;<br>                        <span class="hljs-keyword">break</span>;<br>                    &#125;<br>                &#125;<br>                <span class="hljs-built_in">swap</span>(p[tmp1],p[tmp2]);<br>                <span class="hljs-built_in">sort</span>(p+tmp1+<span class="hljs-number">1</span>,p+n);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,p[i]);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>POJ题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>数学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】CodeForces-321A Ciel and Robot</title>
    <link href="/f6e7e70deedd/"/>
    <url>/f6e7e70deedd/</url>
    
    <content type="html"><![CDATA[<h1>CodeForces-321A Ciel and Robot</h1><p>CF：<a href="https://codeforces.com/problemset/problem/321/A">https://codeforces.com/problemset/problem/321/A</a></p><h2 id="题目">题目</h2><blockquote><p>Fox Ciel has a robot on a 2D plane. Initially it is located in (0, 0). Fox Ciel code a command to it. The command was represented by string <em>s</em>. Each character of <em>s</em> is one move operation. There are four move operations at all:</p><ul class="lvl-1"><li class="lvl-2">‘U’: go up, (x, y) →  (x, y+1);</li><li class="lvl-2">‘D’: go down, (x, y) →  (x, y-1);</li><li class="lvl-2">‘L’: go left, (x, y) →  (x-1, y);</li><li class="lvl-2">‘R’: go right, (x, y) →  (x+1, y).</li></ul><p>The robot will do the operations in <em>s</em> from left to right, and repeat it infinite times. Help Fox Ciel to determine if after some steps the robot will located in (<em>a</em>, <em>b</em>).</p></blockquote><blockquote><p>从$$ (0,0) $$ 开始在二维平面上行走，给定无限循环，问能否抵达某个点</p></blockquote><h2 id="思路">思路</h2><p>简单次数的模拟可以得出具有一定的周期性，即：</p><p>假设走完一次循环抵达$$ (M,N) $$ 点，也就是前进M，向上N（这里M,N不一定是正数），若可以抵达目标点，那么必然存在一个点，这个点满足：</p><ul class="lvl-0"><li class="lvl-2"><p>这个点经过$ k $次的循环(一次循环前进M，向上N)就刚好抵达目标点</p></li><li class="lvl-2"><p>这个点在行走过程中会经过</p></li></ul><p>例如样例中，目标点是$$ (2,2) $$ ，循环是$$ UR $$ ，那么：</p><p>对于$$ (1,1) $$ 这个点而言，进行$$ 1 $$ 次循环，就可以抵达目标点，也就是我们前面分析的条件</p><h2 id="坑">坑</h2><p>首先，我们要考虑到，<strong>这个k次循环，这句话已经赋予这个k必须大于0了</strong>，我们不能做一个数值为负的循环，不符合数学逻辑</p><p>我们在写代码中，习惯性的把这个求k的过程写为：$$ 距离差/目标点 $$，但是我们是否考虑过，这个目标点可能刚好在轴上呢？也就是$$ M可能等于0，N也可能等于0 $$，因此，我们需要处理这个情况</p><p>我第一次写代码的时候，处理这个情况我使用了枚举法，判断m和n然后一系列操作</p><p>但是我们能不能想一下：</p><h3 id="当m-n均为0">当m,n均为0</h3><p>意味着这个机器人走一个循环，那么我们只需要判断1次循环内能否到这个点，而<strong>不可能会再经过k次循环</strong>，因此这个k完全可以设为1</p><h3 id="当m-n有一个为0">当m,n有一个为0</h3><p>意味着这个机器人走一个循环最终会回到某一个轴上，但这时候对于不为0的数m（或n）是不是就存在循环呢？而对于为0的数n（或m），就算乘上k次循环，最终不也都为0吗？因此我们只需要考虑不为0的那一边</p><h3 id="当m-n均不为0">当m,n均不为0</h3><p>意味着这个机器人会停在某一象限里，这时候似乎会产生两个k？</p><p>事实上，这两个k必须相等，因为你横坐标和纵坐标经历的循环的次数是一致的</p><h2 id="失误">失误</h2><ul class="lvl-0"><li class="lvl-2"><p>这道题不能用$$ while(scanf()!=EOF) $$，原因未知，只知道使用上去测试点1都过不了，可能跟某些换行符有关</p></li><li class="lvl-2"><p>输出不是全大写，因为这个点我调了将近四个小时的代码</p></li></ul><h2 id="代码">代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;map&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> N 101</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> inFre() freopen(<span class="hljs-string">&quot;in.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, stdin);</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> outFre() freopen(<span class="hljs-string">&quot;out.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, stdout);</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> setZero(a) memset(a, 0, sizeof(a));</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">inFre</span>() <span class="hljs-type">int</span> a, b, len = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> x[N], y[N];<br>    <span class="hljs-type">char</span> c[N];<br>    <span class="hljs-type">bool</span> ans = <span class="hljs-literal">false</span>;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;a, &amp;b);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, c);<br>    <span class="hljs-built_in">setZero</span>(x);<br>    <span class="hljs-built_in">setZero</span>(y);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(c); i++)<br>    &#123;<br>        <span class="hljs-keyword">switch</span> (c[i])<br>        &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;U&#x27;</span>:<br>            x[i + <span class="hljs-number">1</span>] = x[i], y[i + <span class="hljs-number">1</span>] = y[i] + <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;D&#x27;</span>:<br>            x[i + <span class="hljs-number">1</span>] = x[i], y[i + <span class="hljs-number">1</span>] = y[i] - <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;L&#x27;</span>:<br>            x[i + <span class="hljs-number">1</span>] = x[i] - <span class="hljs-number">1</span>, y[i + <span class="hljs-number">1</span>] = y[i];<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;R&#x27;</span>:<br>            x[i + <span class="hljs-number">1</span>] = x[i] + <span class="hljs-number">1</span>, y[i + <span class="hljs-number">1</span>] = y[i];<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    len = <span class="hljs-built_in">strlen</span>(c);<br>    <span class="hljs-keyword">if</span> (a == <span class="hljs-number">0</span> &amp;&amp; b == <span class="hljs-number">0</span>)<br>    &#123; <span class="hljs-comment">//特判</span><br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= len; i++)<br>    &#123; <span class="hljs-comment">//从1开始判断</span><br>        <span class="hljs-type">int</span> tmpA = a - x[i];<br>        <span class="hljs-type">int</span> tmpB = b - y[i];<br>        <span class="hljs-type">int</span> tmp = (x[len] != <span class="hljs-number">0</span> ? tmpA / x[len] : (y[len] != <span class="hljs-number">0</span> ? tmpB / y[len] : <span class="hljs-number">1</span>));<br>        <span class="hljs-keyword">if</span> (x[len] * tmp == tmpA &amp;&amp; y[len] * tmp == tmpB &amp;&amp; tmp &gt;= <span class="hljs-number">0</span>)<br>        &#123;<br>            ans = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">puts</span>(ans ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CodeForces题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>数学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Home Assistant实现Mijia与Homekit互联 --使用RaspberryPi</title>
    <link href="/03d49bf4c6ee/"/>
    <url>/03d49bf4c6ee/</url>
    
    <content type="html"><![CDATA[<h1>Home Assistant 实现Mijia与Homekit互联 --使用RaspberryPi</h1><p><img src="https://files.ozline.icu/images/blog/HA/HA_05.png" alt="image-20211221025005286"></p><h2 id="前言">前言</h2><p>作为一名学生，购买原生HomeKit家庭组件经费实在是不足，且自己原本就已经断断续续购买了一定的米家硬件</p><p>在iOS生态下，Apple原生的<code>家庭</code>APP的控制能力及操作便携性远大于<code>米家</code>APP，米家iOS版操作体验低于Android版</p><p>再加上部分Apple组件（如HomePod mini）无法通过米家操作</p><p>这时候，打通米家和HomeKit的想法就提上日程了</p><h2 id="方案优点">方案优点</h2><ul class="lvl-0"><li class="lvl-2"><p>将几乎所有米家设备加入<code>家庭</code>APP，使得一个APP可以控制几乎全部设备</p></li><li class="lvl-2"><p>在有家庭中枢的情况下，可以实现远程操作设备（如忘记关灯可以实现远程关灯）</p></li><li class="lvl-2"><p>拥有一个控制面板，可以直观显示设备当前情况</p></li></ul><h2 id="无外接显示器SSH登录RasPi">无外接显示器SSH登录RasPi</h2><p>打开terminal，进入烧录好的SD卡，在boot文件夹中输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ozline@OZLIINEX ~ : <span class="hljs-built_in">touch</span> ssh  <span class="hljs-comment"># 创建ssh空文件，打开RasPi的SSH功能</span><br>ozline@OZLIINEX ~ : <span class="hljs-built_in">touch</span> wpa_supplicant.conf <span class="hljs-comment"># 创建wifi连接文件</span><br></code></pre></td></tr></table></figure><p>编辑wpa_supplicant.conf，把内容改为</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">country=CN</span><br><span class="hljs-string">ctrl_interface=DIR=/var/run/wpa_supplicant</span> <span class="hljs-string">GROUP=netdev</span><br><span class="hljs-string">update_config=1</span><br><br><span class="hljs-string">network=&#123;</span><br><span class="hljs-string">ssid=&quot;你的WIFI名称&quot;</span><br><span class="hljs-string">psk=&quot;你的WIFI密码&quot;</span><br><span class="hljs-string">priority=1</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure><p>后把SD卡插入RasPi，等绿灯不再亮而红灯常亮（RasPi 4B正常运行指示灯，其他可能有所不同），打开路由器后台，查看设备名为<code> raspberrypi</code>的ip，或者：</p><p>给RasPi通电前，在terminal输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ozline@OZLIINEX ~ : arp-a <span class="hljs-comment"># 查看lan设备的ip地址</span><br></code></pre></td></tr></table></figure><p>通电并等待指示灯正常后，再输一遍，找出这两遍中多出来的ip，那么这个ip就是树莓派的局域网地址</p><p>通过terminal直接连接树莓派</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ozline@OZLIINEX ~ : ssh pi@RasPiHost <span class="hljs-comment"># 通过ssh连接RasPi 这里RasPiHost替换为你的树莓派本地ip地址</span><br></code></pre></td></tr></table></figure><h2 id="安装Docker及Docker-Compose">安装Docker及Docker Compose</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">pi@raspberrypi:~ $  sudo curl -fsSL https://get.docker.com | sh <span class="hljs-comment"># 使用官方脚本安装Docker</span><br>pi@raspberrypi:~ $  docker version <span class="hljs-comment"># 查看docker是否安装成功</span><br>pi@raspberrypi:~ $  systemctl start docker <span class="hljs-comment"># 启动docker</span><br>pi@raspberrypi:~ $  systemctl status docker <span class="hljs-comment"># 查看docker状态</span><br>pi@raspberrypi:~ $  systemctl <span class="hljs-built_in">enable</span> docker.service <span class="hljs-comment"># 设置开机自启动</span><br>pi@raspberrypi:~ $  systemctl is-enabled docker.service <span class="hljs-comment"># 查看是否设置成功</span><br>pi@raspberrypi:~ $  sudo usermod -aG docker <span class="hljs-variable">$USER</span> <span class="hljs-comment"># 将当前用户加入docker组</span><br>pi@raspberrypi:~ $  <span class="hljs-built_in">exit</span> <span class="hljs-comment"># 退出RasPi</span><br></code></pre></td></tr></table></figure><p>退出后重新登录，这样操作docker不再需要加sudo</p><p>接下来是安装Docker Compose，对于最新的Raspberry Pi OS，已经默认安装了python3和pip3，不需要重复安装，如果不是最新版的系统，可能需要手动安装python3和pip3</p><p>安装<code>libffi-dev</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">pi@raspberrypi:~ $  sudo apt-get update <span class="hljs-comment"># 更新</span><br>pi@raspberrypi:~ $  sudo apt-get upgrade <span class="hljs-comment"># 更新</span><br>pi@raspberrypi:~ $  sudo apt-get install -y libffi-dev<br></code></pre></td></tr></table></figure><p>使用中科大软件源安装<code>docker-compose</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">pi@raspberrypi:~ $  sudo pip3 install docker-compose -i https://pypi.mirrors.ustc.edu.cn/simple/  --trusted-host  pypi.mirrors.ustc.edu.cn<br>pi@raspberrypi:~ $  docker-compose --version <span class="hljs-comment"># 检查是否安装成功</span><br></code></pre></td></tr></table></figure><h2 id="通过Docker安装Home-Assistant">通过Docker安装Home Assistant</h2><p>先创建一些所需文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">pi@raspberrypi:~ $  <span class="hljs-built_in">mkdir</span> home-assistant <span class="hljs-comment"># 创建home-assistant文件夹</span><br>pi@raspberrypi:~ $  <span class="hljs-built_in">cd</span> home-assistant<br>pi@raspberrypi:~/home-assistant $  <span class="hljs-built_in">touch</span> docker-compose.yaml <span class="hljs-comment"># 创建安装文件</span><br></code></pre></td></tr></table></figure><p>编辑这个<code>docker-compose.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3&#x27;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">homeassistant:</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">homeassistant</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">homeassistant/home-assistant</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./:/config</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/localtime:/etc/localtime:ro</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span><br>    <span class="hljs-attr">privileged:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">network_mode:</span> <span class="hljs-string">host</span><br></code></pre></td></tr></table></figure><p>开始安装<code>Home Assistant</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pi@raspberrypi:~/home-assistant $  docker-compose up -d<span class="hljs-comment"># 安装Home Assistant</span><br></code></pre></td></tr></table></figure><p>接下来打开浏览器，输入<code>http://RasPiHost:8123</code>进入Home Assistant后台界面，创建账号后就可以打开后台了，如图</p><p><img src="https://files.ozline.icu/images/blog/HA/HA_01.png" alt="image-20211221015025616"></p><h2 id="安装hass-xiaomi-miot-插件">安装hass-xiaomi-miot 插件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">pi@raspberrypi:~/home-assistant $  docker <span class="hljs-built_in">exec</span> -it homeassistant bash <span class="hljs-comment"># 进入容器</span><br>bash-5.1<span class="hljs-comment"># wget -q -O - https://cdn.jsdelivr.net/gh/al-one/hass-xiaomi-miot/install.sh | HUB_DOMAIN=hub.fastgit.org bash - # 安装插件</span><br>bash-5.1<span class="hljs-comment"># exit # 退出容器</span><br>pi@raspberrypi:~/home-assistant $ docker-compose restart <span class="hljs-comment"># 重启容器</span><br></code></pre></td></tr></table></figure><h2 id="对Home-Assistant后台进行配置">对Home Assistant后台进行配置</h2><h3 id="添加HomeKit集成">添加HomeKit集成</h3><p>在后台，进入<code>配置-&gt;设备和服务-&gt;集成</code>，点击右下角的<code>添加集成</code></p><p><img src="https://files.ozline.icu/images/blog/HA/HA_02.png" alt="image-20211221015855227"></p><p>勾选全部域，提交，然后等待通知里提供二维码，在iPhone上的<code>家庭</code>APP里扫描即可添加桥接设备，如图</p><p><img src="https://files.ozline.icu/images/blog/HA/HA_03.png" alt="IMG_2014"></p><h3 id="添加Xiaomi-Miot-Auto集成">添加Xiaomi Miot Auto集成</h3><p>按照刚刚添加HomeKit的方法就可以添加了</p><p><img src="https://files.ozline.icu/images/blog/HA/HA_04.png" alt="image-20211221021213360"></p><p>之后选择<code>账号集成模式</code>，然后输入自己的小米账号和密码，设备连接模式选择<code>云端模式</code>，之后一直点下一步就可以了，</p><h2 id="成果">成果</h2><p>打开iPhone<code>家庭</code>APP，就会有如下显示：</p><p><img src="https://files.ozline.icu/images/blog/HA/HA_06.png" alt="IMG_2015"></p><h2 id="方案缺陷">方案缺陷</h2><ul class="lvl-0"><li class="lvl-2"><p>尽管已经最大的简化，但是HA的上手难度依然存在一定的门槛</p></li><li class="lvl-2"><p>实际效果仍然与原生HomeKit有一定差距</p></li><li class="lvl-2"><p>在没有HomePod/iPad当家庭中枢的情况下，无法在非同网下操作硬件</p></li><li class="lvl-2"><p>Xiaomi Miot Auto中无法集成部分硬件（如米家电热水壶Pro）到Home Assistant</p></li></ul><h2 id="TODO">TODO</h2><ul class="lvl-0"><li class="lvl-2"><p>映射面板到公网/校园网</p></li><li class="lvl-2"><p>探索组件自动化</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>RaspBerryPi</category>
      
    </categories>
    
    
    <tags>
      
      <tag>智能家居</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【题解】CodeForces-936A SAVE ENERGY!</title>
    <link href="/a6579764190c/"/>
    <url>/a6579764190c/</url>
    
    <content type="html"><![CDATA[<h1>CodeForces-936A SAVE ENERGY!</h1><p>CF：<a href="https://codeforces.com/problemset/problem/936/A">https://codeforces.com/problemset/problem/936/A</a></p><h2 id="题目">题目</h2><blockquote><p>Julia is going to cook a chicken in the kitchen of her dormitory. To save energy, the stove in the kitchen automatically turns off after <em>k</em> minutes after turning on.</p><p>During cooking, Julia goes to the kitchen every <em>d</em> minutes and turns on the stove if it is turned off. While the cooker is turned off, it stays warm. The stove switches on and off instantly.</p><p>It is known that the chicken needs <em>t</em> minutes to be cooked on the stove, if it is turned on, and 2<em>t</em> minutes, if it is turned off. You need to find out, how much time will Julia have to cook the chicken, if it is considered that the chicken is cooked evenly, with constant speed when the stove is turned on and at a constant speed when it is turned off.</p></blockquote><blockquote><p>Julia要烤一个鸡，但是她的厨房为了省电，炉子会在开k分钟后自动关掉，Julia会间隔d分钟检查炉子有没有在工作，如果在没在工作就把炉子开起来，已知整个炉子一直开着的话要t分钟烤熟，没开着的话可以靠余温2t分钟烤熟，问总共要多少分钟能烤熟</p></blockquote><h2 id="思路">思路</h2><p>这是一道数学题，我们需要知道一个周期，这个周期指的是炉子从开始到关闭再到被Julia检查到的时间，把烤鸡这个过程微分，计算一个周期中，这个鸡可以烤到什么程度，然后累加，最后对最后一个周期（通常是不完整的）进行处理。</p><p>周期公式：$$ T=((k-1)/d+1)*d $$</p><p>T为long long 型，这个公式表示求k和d的最小覆盖周期</p><p>例如：</p><p>$ 当k=3,d=5则T=5 $</p><p>$ 当k=5,d=3则T=6 $</p><p>$ 当k=4,d=2则T=4 $</p><p>当然，即使不知道这个公式，也可以通过一些基础算法求出这个最小覆盖周期。</p><p>在这个最小覆盖周期中，炉子从开到关，期间可能存在一段炉子关着但是没有被检查到的时间，根据题意，这段时间炉子烤鸡的速度是正常速度的一半，因此我们可以定义一个周期中烤鸡实际上相当于烤了多久，也就是cycle</p><p>接着，我们对最后一个周期（这个周期通常是不完整的）进行一下处理，首先是算出这个最后一个周期中需要烤多久</p><p>也就是$ tmp=t-ll(t/cycle)*cycle $，其中$ ll(t/cycle) $利用了向下取整表示出完整循环的周期数量</p><p>如果$ tmp&lt;k $，也就意味着在最后一个周期这个炉子一直都是开着，那我们就直接加上这段时间就好了</p><p>如果$ tmp&gt;=k $，则最后一个周期中存在炉子关掉的情况，这时候我们需要2倍的时间来烤</p><h2 id="代码">代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    ll k, d, t, T;<br>    <span class="hljs-type">double</span> ans, cycle, tmp;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld %lld %lld&quot;</span>, &amp;k, &amp;d, &amp;t);<br>    T = ((k - <span class="hljs-number">1</span>) / d + <span class="hljs-number">1</span>) * d;<br>    cycle = (T - k) * <span class="hljs-number">0.5</span> + k;<br>    tmp = t - <span class="hljs-built_in">ll</span>(t / cycle) * cycle;<br>    ans = <span class="hljs-built_in">ll</span>(t / cycle) * T;<br>    ans += tmp &lt; k ? tmp : k + (tmp - k) * <span class="hljs-number">2</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.1lf\n&quot;</span>, ans);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CodeForces题解</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ACM</tag>
      
      <tag>数学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DFS实现Bilibili视频评论爬虫</title>
    <link href="/764abdf3a7b4/"/>
    <url>/764abdf3a7b4/</url>
    
    <content type="html"><![CDATA[<p>西二在线Golang组的11月考核有一个提高任务，是爬取何同学某一个视频的评论并且使用mysql储存，这里单独写一篇文章来记录编写过程中的一些事</p><h2 id="相关API">相关API</h2><p>使用Porxyman抓包后，可以轻松拿到两个API：</p><p>主评论：</p><p><code>https://api.bilibili.com/x/v2/reply/main?jsonp=jsonp&amp;next=【pages】&amp;type=1&amp;oid=【OID】&amp;mode=【mode】&amp;plat=1&amp;_=【timestamp】</code></p><p>楼中楼：</p><p><code>https://api.bilibili.com/x/v2/reply/reply?&amp;jsonp=jsonp&amp;pn=【pages】&amp;type=1&amp;oid=【OID】&amp;ps=【num】&amp;root=【父评论ID】&amp;_=【timestamp】</code></p><p>跟大多数网站的api一样，这个timestamp可以不提交，毕竟核查时间戳很浪费资源，但是bilibili并不是完全没有审查请求，它会在请求过多的时候拒绝返回数据（返回错误码-412），这个频率测试下来是不能小于0.5秒</p><p>这里的pages对应b站显示评论的一个机制，b站在下拉读取评论的过程中<strong>只会十条十条的读取</strong>，也就是说你拉到底部它才会继续加载更多的评论，不会一口气把评论都读完，而子评论也是如此，但是子评论有个更灵活的ps参数，你可以控制它返回多少子评论，但也有个上限，<strong>最多返回20条</strong>，其他就得“翻页”了</p><h2 id="爬虫逻辑">爬虫逻辑</h2><p>当爬虫爬取了一条评论后，爬虫会穷尽这条评论下的所有子评论后，才会继续读取下一条评论，而主评论的排序方式以热门程度为序，b站对返回评论有三种模式，也就是主评论API中的mode参数，1=评论，2=最新评论，3=热门评论，因此程序会逐渐爬完所有的评论，并存进数据库</p><h2 id="数据库结构">数据库结构</h2><p>以BV作为每个表的ID，rpid作为主键</p><table><thead><tr><th>rpid</th><th>mid</th><th>root</th><th>parent</th><th>rcount</th><th>ctime</th><th>like</th><th>uname</th><th>message</th></tr></thead><tbody><tr><td>评论ID</td><td>用户ID</td><td>根评论ID</td><td>父评论ID</td><td>子楼个数</td><td>时间戳</td><td>点赞数</td><td>昵称</td><td>内容</td></tr></tbody></table><h2 id="代码实现">代码实现</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;database/sql&quot;</span><br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;io/ioutil&quot;</span><br><span class="hljs-string">&quot;net/http&quot;</span><br><span class="hljs-string">&quot;strconv&quot;</span><br><span class="hljs-string">&quot;strings&quot;</span><br><span class="hljs-string">&quot;time&quot;</span><br><br>_ <span class="hljs-string">&quot;github.com/go-sql-driver/mysql&quot;</span><br><span class="hljs-string">&quot;github.com/jsonparser&quot;</span><br>)<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">思路：</span><br><span class="hljs-comment">获取到b站评论api以后，主要的内容其实就是对json进行文本操作了，整个过程是递推过程</span><br><span class="hljs-comment">唯一使用goroutine的地方是向数据库提交数据，其余均不能使用goroutine，b站服务器会检测频率</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">会导致程序运行停止的地方：</span><br><span class="hljs-comment">1.连接数据库时连接失败</span><br><span class="hljs-comment">2.提交数据时数据库返回错误结果亦或是提交失败，避免浪费资源</span><br><span class="hljs-comment">3.关闭数据库时关闭失败</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">正常进行程序就已经会导致被服务器临时ban，解决方法是强行放慢进度</span><br><span class="hljs-comment">目前是在主评论之间加1秒间隔，子评论之间加0.5秒间隔</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-keyword">const</span> (<br>userName = <span class="hljs-string">&quot;username&quot;</span><br>passWord = <span class="hljs-string">&quot;password&quot;</span><br>ip       = <span class="hljs-string">&quot;database-ip&quot;</span><br>port           = <span class="hljs-string">&quot;port&quot;</span><br>dbName         = <span class="hljs-string">&quot;dbname&quot;</span><br>bv             = <span class="hljs-string">&quot;bv1f4411m7qc&quot;</span><br>oid            = <span class="hljs-string">&quot;54737593&quot;</span><br>api_main       = <span class="hljs-string">&quot;https://api.bilibili.com/x/v2/reply/main?jsonp=jsonp&amp;next=[page]&amp;type=1&amp;oid=[oid]&amp;mode=3&amp;plat=1&amp;_[timestamp]&quot;</span>      <span class="hljs-comment">//爬取评论API</span><br>api_son        = <span class="hljs-string">&quot;https://api.bilibili.com/x/v2/reply/reply?&amp;jsonp=jsonp&amp;pn=[page]&amp;type=1&amp;oid=[oid]&amp;ps=20&amp;root=[root]&amp;_=[timestamp]&quot;</span> <span class="hljs-comment">//爬取楼中楼API</span><br>maxWorkerCount = <span class="hljs-number">64</span><br>)<br><br><span class="hljs-keyword">type</span> commentInfo <span class="hljs-keyword">struct</span> &#123;<br>rpid    <span class="hljs-type">int64</span>  <span class="hljs-comment">//评论ID</span><br>mid     <span class="hljs-type">int64</span>  <span class="hljs-comment">//用户ID</span><br>root    <span class="hljs-type">int64</span>  <span class="hljs-comment">//根楼</span><br>parent  <span class="hljs-type">int64</span>  <span class="hljs-comment">//父楼</span><br>rcount  <span class="hljs-type">int64</span>  <span class="hljs-comment">//有效楼中楼数量</span><br>ctime   <span class="hljs-type">int64</span>  <span class="hljs-comment">//11位时间戳</span><br>like    <span class="hljs-type">int64</span>  <span class="hljs-comment">//点赞人数</span><br>uname   <span class="hljs-type">string</span> <span class="hljs-comment">//昵称</span><br>message <span class="hljs-type">string</span> <span class="hljs-comment">//评论内容</span><br><span class="hljs-comment">//我之前一直在想，为什么b站评论没有显示不喜欢的人数，没想到是数据库压根没存，还是api读取的时候不返回？</span><br>&#125;<br><br><span class="hljs-keyword">var</span> db *sql.DB<br><span class="hljs-keyword">var</span> code <span class="hljs-type">int64</span><br><br><span class="hljs-keyword">var</span> workerCount = <span class="hljs-number">0</span><br><span class="hljs-keyword">var</span> solveRequest = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> commentInfo)<br><span class="hljs-keyword">var</span> workerDone = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">bool</span>)<br><span class="hljs-keyword">var</span> doneCounter = <span class="hljs-number">0</span><br><span class="hljs-keyword">var</span> haveSolved = <span class="hljs-literal">false</span><br><span class="hljs-keyword">var</span> start time.Time<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">waitForWorkers</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">for</span> &#123;<br><span class="hljs-keyword">select</span> &#123;<br><span class="hljs-keyword">case</span> info := &lt;-solveRequest:<br>workerCount++<br><span class="hljs-keyword">go</span> SubmitInfo(info, <span class="hljs-literal">true</span>)<br><span class="hljs-keyword">case</span> &lt;-workerDone:<br>workerCount--<br>doneCounter++<br>fmt.Printf(<span class="hljs-string">&quot;\r已处理任务数量：%v&quot;</span>, strconv.Itoa(doneCounter))<br><span class="hljs-keyword">if</span> workerCount == <span class="hljs-number">0</span> &amp;&amp; haveSolved &#123;<br><span class="hljs-keyword">if</span> code == <span class="hljs-number">-412</span> &#123;<br>fmt.Printf(<span class="hljs-string">&quot;\n\n程序异常结束：服务器拒绝访问&quot;</span>)<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;\n\n程序执行完毕 耗时：&quot;</span> + timeSolve(time.Since(start).String()))<br>&#125;<br><span class="hljs-keyword">return</span><br>&#125;<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">timeSolve</span><span class="hljs-params">(time <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">string</span> &#123;<br>keepNum := <span class="hljs-number">2</span>                            <span class="hljs-comment">//规划保留的小数点后位数</span><br>dotIndex := strings.IndexAny(time, <span class="hljs-string">&quot;.&quot;</span>) <span class="hljs-comment">//获取小数点所在的索引值</span><br><span class="hljs-keyword">return</span> time[:dotIndex+keepNum+<span class="hljs-number">1</span>] + <span class="hljs-string">&quot;s&quot;</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">InitDB</span><span class="hljs-params">()</span></span> <span class="hljs-type">bool</span> &#123; <span class="hljs-comment">//连接RDS</span><br>path := strings.Join([]<span class="hljs-type">string</span>&#123;userName, <span class="hljs-string">&quot;:&quot;</span>, passWord, <span class="hljs-string">&quot;@tcp(&quot;</span>, ip, <span class="hljs-string">&quot;:&quot;</span>, port, <span class="hljs-string">&quot;)/&quot;</span>, dbName, <span class="hljs-string">&quot;?charset=utf8&amp;parseTime=True&quot;</span>&#125;, <span class="hljs-string">&quot;&quot;</span>)<br>db, _ = sql.Open(<span class="hljs-string">&quot;mysql&quot;</span>, path)<br>db.SetConnMaxLifetime(<span class="hljs-number">100</span>)<br>db.SetMaxIdleConns(<span class="hljs-number">10</span>)<br><span class="hljs-keyword">if</span> err := db.Ping(); err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-built_in">panic</span>(err)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">SubmitInfo</span><span class="hljs-params">(info commentInfo, a <span class="hljs-type">bool</span>)</span></span> &#123; <span class="hljs-comment">//提交数据 true=使用goroutine</span><br>tx, err := db.Begin()<br><span class="hljs-comment">//panic(err)</span><br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-built_in">panic</span>(err)<br><span class="hljs-keyword">return</span><br>&#125;<br>cmd := <span class="hljs-string">&quot;INSERT INTO `&quot;</span> + dbName + <span class="hljs-string">&quot;`.`&quot;</span> + bv + <span class="hljs-string">&quot;` (`rpid`,`mid`,`root`,`parent`,`rcount`,`ctime`,`like`,`uname`,`message`) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)&quot;</span><br>tmp, err := tx.Prepare(cmd)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-built_in">panic</span>(err)<br><span class="hljs-keyword">return</span><br>&#125;<br>_, err = tmp.Exec(info.rpid, info.mid, info.root, info.parent, info.rcount, info.ctime, info.like, info.uname, info.message)<br><span class="hljs-keyword">if</span> err == <span class="hljs-literal">nil</span> &#123;<br>tx.Commit()<br>&#125;<br><span class="hljs-keyword">if</span> a &#123;<br>workerDone &lt;- <span class="hljs-literal">true</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>doneCounter++<br>&#125;<br><span class="hljs-keyword">return</span><br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">solveCommentProgress</span><span class="hljs-params">(data []<span class="hljs-type">byte</span>, dataType jsonparser.ValueType, offset <span class="hljs-type">int</span>, err <span class="hljs-type">error</span>)</span></span> &#123; <span class="hljs-comment">//处理评论</span><br><span class="hljs-keyword">var</span> info commentInfo<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-built_in">panic</span>(err)<br><span class="hljs-keyword">return</span><br>&#125;<br><span class="hljs-keyword">if</span> dataType == jsonparser.Object &#123; <span class="hljs-comment">//数据类型正确，开始读取</span><br>info.rpid, _ = jsonparser.GetInt(data, <span class="hljs-string">&quot;rpid&quot;</span>)<br>info.mid, _ = jsonparser.GetInt(data, <span class="hljs-string">&quot;mid&quot;</span>)<br>info.root, _ = jsonparser.GetInt(data, <span class="hljs-string">&quot;root&quot;</span>)<br>info.parent, _ = jsonparser.GetInt(data, <span class="hljs-string">&quot;parent&quot;</span>)<br>info.rcount, _ = jsonparser.GetInt(data, <span class="hljs-string">&quot;rcount&quot;</span>)<br>info.ctime, _ = jsonparser.GetInt(data, <span class="hljs-string">&quot;ctime&quot;</span>)<br>info.like, _ = jsonparser.GetInt(data, <span class="hljs-string">&quot;like&quot;</span>)<br>info.uname, _ = jsonparser.GetString(data, <span class="hljs-string">&quot;member&quot;</span>, <span class="hljs-string">&quot;uname&quot;</span>)<br>info.message, _ = jsonparser.GetString(data, <span class="hljs-string">&quot;content&quot;</span>, <span class="hljs-string">&quot;message&quot;</span>)<br><span class="hljs-keyword">if</span> workerCount &lt; maxWorkerCount &#123;<br>solveRequest &lt;- info<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>SubmitInfo(info, <span class="hljs-literal">false</span>)<br>&#125;<br><span class="hljs-comment">//楼中楼判断</span><br>_, tmp, _, _ := jsonparser.Get(data, <span class="hljs-string">&quot;replies&quot;</span>)<br><span class="hljs-keyword">if</span> tmp == jsonparser.Array &#123;<br>sonProgress(info.rpid, oid)<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getCommentData</span><span class="hljs-params">(url <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">bool</span> &#123; <span class="hljs-comment">//获取并开始处理json</span><br><span class="hljs-comment">//构建请求</span><br>req, err := http.NewRequest(<span class="hljs-string">&quot;GET&quot;</span>, url, <span class="hljs-literal">nil</span>) <span class="hljs-comment">//这个api对头文件检查不严格，实际上下面三个完全不需要</span><br>req.Header.Add(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36&quot;</span>)<br>req.Header.Add(<span class="hljs-string">&quot;Referer&quot;</span>, <span class="hljs-string">&quot;https://www.bilibili.com/&quot;</span>)<br>req.Header.Add(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><span class="hljs-comment">//发送请求</span><br>resp, err := http.DefaultTransport.RoundTrip(req) <span class="hljs-comment">// 关闭自动重定向</span><br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><span class="hljs-comment">//提取data内容</span><br>re, err := ioutil.ReadAll(resp.Body)<br>resp.Body.Close()<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br>code, err = jsonparser.GetInt(re, <span class="hljs-string">&quot;code&quot;</span>)<br><span class="hljs-keyword">if</span> code == <span class="hljs-number">-412</span> &#123; <span class="hljs-comment">//请求过多，暂时不提供数据</span><br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br>result, tmp, _, err := jsonparser.Get(re, <span class="hljs-string">&quot;data&quot;</span>)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br>_, tmp, _, _ = jsonparser.Get(result, <span class="hljs-string">&quot;replies&quot;</span>)<br><span class="hljs-keyword">if</span> tmp == jsonparser.Array &#123; <span class="hljs-comment">//存在则进行评论处理</span><br>_, _ = jsonparser.ArrayEach(result, solveCommentProgress, <span class="hljs-string">&quot;replies&quot;</span>)<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">mainProgress</span><span class="hljs-params">()</span></span> &#123; <span class="hljs-comment">//处理主评论</span><br><span class="hljs-keyword">if</span> InitDB() &#123;<br>fmt.Println(<span class="hljs-string">&quot;数据库连接成功\n&quot;</span>)<br><span class="hljs-keyword">defer</span> endProgress()<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;数据库连接失败\n&quot;</span>)<br><span class="hljs-keyword">return</span><br>&#125;<br><br>start = time.Now()<br><span class="hljs-keyword">var</span> tmp <span class="hljs-type">int</span> = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> &#123;<br><span class="hljs-comment">//地址预处理</span><br>url := strings.ReplaceAll(api_main, <span class="hljs-string">&quot;[oid]&quot;</span>, oid)<br>url = strings.ReplaceAll(url, <span class="hljs-string">&quot;[page]&quot;</span>, strconv.Itoa(tmp))<br>url = strings.ReplaceAll(url, <span class="hljs-string">&quot;[timestamp]&quot;</span>, strconv.FormatInt(time.Now().UnixMilli(), <span class="hljs-number">10</span>))<br><span class="hljs-keyword">if</span> !getCommentData(url) || code == <span class="hljs-number">-412</span> &#123;<br><span class="hljs-keyword">break</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>tmp++<br>&#125;<br>time.Sleep(time.Second)<br>&#125;<br>haveSolved = <span class="hljs-literal">true</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sonProgress</span><span class="hljs-params">(root <span class="hljs-type">int64</span>, oid <span class="hljs-type">string</span>)</span></span> &#123; <span class="hljs-comment">//处理子评论</span><br><span class="hljs-keyword">var</span> tmp <span class="hljs-type">int</span> = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> &#123;<br><span class="hljs-comment">//地址预处理</span><br>url := strings.ReplaceAll(api_son, <span class="hljs-string">&quot;[oid]&quot;</span>, oid)<br>url = strings.ReplaceAll(url, <span class="hljs-string">&quot;[root]&quot;</span>, strconv.FormatInt(root, <span class="hljs-number">10</span>))<br>url = strings.ReplaceAll(url, <span class="hljs-string">&quot;[page]&quot;</span>, strconv.Itoa(tmp))<br>url = strings.ReplaceAll(url, <span class="hljs-string">&quot;[timestamp]&quot;</span>, strconv.FormatInt(time.Now().UnixMilli(), <span class="hljs-number">10</span>))<br><span class="hljs-keyword">if</span> !getCommentData(url) || code == <span class="hljs-number">-412</span> &#123;<br><span class="hljs-keyword">break</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>tmp++<br>&#125;<br>time.Sleep(<span class="hljs-number">500000000</span>)<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">endProgress</span><span class="hljs-params">()</span></span> &#123; <span class="hljs-comment">//程序结束时处理的内容</span><br>err := db.Close() <span class="hljs-comment">//关闭数据库</span><br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-built_in">panic</span>(err)<br><span class="hljs-keyword">return</span><br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">go</span> mainProgress()<br>waitForWorkers()<br><span class="hljs-keyword">return</span><br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="爬取逻辑">爬取逻辑</h2><p>在这个程序中，爬虫采用DFS方法，如图，爬虫从上至下，从左至右遍历</p><pre><code class=" mermaid">graph LRA[程序开始]--&gt;B[读取第1页文章列表]A--&gt;D[...]A--&gt;E[读取第N页文章列表]B--&gt;F[解析第1个文章]B--&gt;J[...]B--&gt;K[解析第N个文章]E--&gt;M[...]</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>golang</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>并查集</title>
    <link href="/aac2d8e6bc14/"/>
    <url>/aac2d8e6bc14/</url>
    
    <content type="html"><![CDATA[<h1>并查集</h1><p>2018.10.04</p><ul class="lvl-0"><li class="lvl-2"><p>并查集保持一组不相交的动态集合$S={S1,S2…Sk}$。</p></li><li class="lvl-2"><p>每个集合通过一个代表来识别</p></li><li class="lvl-2"><p>代表就是集合中的某个成员</p></li><li class="lvl-2"><p>哪一个成员作为代表是无所谓的</p></li><li class="lvl-2"><p>我们关心的是如果寻找某一动态集合的代表2次，并且在两次寻找之间不修改集合，两次得到的答案应该是相同的</p></li></ul><h1>操作</h1><h3 id="Make-Set-x">Make-Set(x)</h3><p>建立一个新的集合，它的唯一成员，也就是代表，就是x</p><p>因为各个集合是不相交的，所以要求x在其他集合中没有出现过</p><h3 id="Union-x-y">Union(x,y)</h3><p>将包含x和y的动态集合合并并为一个新的集合（就是这两个集合的并集）</p><p>假定在这个操作之前两个集合是不相交的，然后选出一个代表</p><h3 id="Find-Set-x">Find-Set(x)</h3><p>返回一个指针，指向包含x的（唯一）集合代表</p><h1>应用</h1><p>简单：统计一个无向图中连通子图的个数</p><p>对于每个V中的顶点v，Make-Set(v)</p><p>对于每个E中的边(u,v)，如果Find-Set(u)!=Find-Set(v)，则Union(u,v)</p><p>最后统计有几个集合就可以了。（统计代表的个数）</p><h1>如何实现</h1><p>用有根树来表示集合</p><p>树中的每个节点都表示集合的一个成员</p><p>每棵树表示一个集合</p><p>每个成员仅指向它的父节点</p><p>每棵树的根表示代表，而且它的父亲是它自己（父节点是自己）</p><p>之前的三个操作：</p><ul class="lvl-0"><li class="lvl-2"><p>Make-Set(x):一颗新的树</p></li><li class="lvl-2"><p>Union(x,y):让一棵树的根指向另一棵树</p></li><li class="lvl-2"><p>Find-Set(x):查找根节点（树根）</p></li></ul><h1>优化</h1><h3 id="按秩合并">按秩合并</h3><p>目的是让包含较少节点的树的根指向包含较多节点的树的根</p><p>不记录以每个节点为根的子树的大小</p><p>采用一种简化分析的方法</p><p>对每个节点，用秩(rank)表示节点高度的一个上界</p><p>在按秩合并过程中，具有较小的根在Union操作中要指向具有较大秩的根</p><h3 id="路径压缩">路径压缩</h3><p>目的是减少Find-Set操作中访问的节点个数</p><p>尽量让路上每个节点直接指向根节点</p><p>这个操作不会改变节点的秩</p><h1>代码实现</h1><p>$p[x]$表示x的父节点，$rank[x]$表示x的秩</p><h3 id="Make-Set-x-2">Make-Set(x)</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c++">p[x]=x<br>rank[x]=<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>Link过程是由Union调用的一个子过程</p><h3 id="Union-x-y-2">Union(x,y)</h3><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos">Link(<span class="hljs-built_in">Find</span>-<span class="hljs-built_in">Set</span>(x),<span class="hljs-built_in">Find</span>-<span class="hljs-built_in">Set</span>(y));<br></code></pre></td></tr></table></figure><h3 id="Link-x-y">Link(x,y)</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">if</span>(rank[x]&gt;rank[y]) p[y]=x;<br><span class="hljs-keyword">else</span>&#123;<br>    p[x]=y;<br>    <span class="hljs-keyword">if</span>(rank[x]==rank[y]) rank[y]+=<span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Find-Set-x-2">Find-Set(x)</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">if</span>(x!=p[x]) p[x]=Find-<span class="hljs-built_in">Set</span>(p[x]);<br><span class="hljs-keyword">return</span> p[x];<br></code></pre></td></tr></table></figure><p>这中间包含了路径压缩</p><p>第一趟（递归没有收缩） 查找一路上升，并且找到根</p><p>第二趟（递归收缩）更新每一个节点，让节点直接指向根</p><h1>时间复杂度计算</h1><p>当同时使用按秩合并和路径压缩时，最坏情况运行时间为$$O(mα(n))$$，其中$α(n)$ 是一个增长极其缓慢的函数。</p><p>在各种实际情况中，可以把这个运行时间看作与m 成线性关系。</p>]]></content>
    
    
    
    <tags>
      
      <tag>ACM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hash函数</title>
    <link href="/1d70c90329e4/"/>
    <url>/1d70c90329e4/</url>
    
    <content type="html"><![CDATA[<h1>Hash</h1><p>通过一个函数H，可以把字符串映射成一个数字</p><p>满足$x!=y$时，$H(x)==H(y)$的概率很小</p><h1>应用</h1><ul class="lvl-0"><li class="lvl-2"><p>假设有n个长度为L的字符串，问其中最多有几个字符串是相等的</p></li><li class="lvl-2"><p>直接比较两个长度是L的字符串是否相等的时间复杂度是$O(L)$的</p></li><li class="lvl-2"><p>因此需要枚举$O(n²)$对字符串进行比较，时间复杂度是$O(n²)$</p></li><li class="lvl-2"><p>如果把每个字符串都用一个哈希函数映射成一个整数</p></li><li class="lvl-2"><p>问题就转变为查找一个序列的众数</p></li><li class="lvl-2"><p>时间复杂度就变成了$O(L)$</p></li></ul><p>其实可以类比成压缩吧…</p><h1>字符串哈希</h1><p>一个设计良好的字符串哈希函数可以让我们用$O(L)$的时间复杂度预处理，之后每次获取这个字符串的一个子串的哈希值都只需要$O(1)$的时间</p><h1>BKDR Hash</h1><p>基本思想：把一个字符串当做k进制数来处理</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-type">int</span> k=<span class="hljs-number">19</span>,M=<span class="hljs-number">1e9</span>+<span class="hljs-number">7</span>;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">BKDRHash</span><span class="hljs-params">(<span class="hljs-type">char</span> *str)</span></span>&#123;<br>    <span class="hljs-type">int</span> ans=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;str[i];i++)<br>        ans=(<span class="hljs-number">1LL</span>*ans*k+str[i])%M;<br>    <span class="hljs-comment">//1LL:把int类型转变成long long进行运算</span><br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="使用">使用</h3><p>假设字符串s的下标从1开始，长度为n</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c++">ha[<span class="hljs-number">0</span>]=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br>    ha[i]=(ha[i<span class="hljs-number">-1</span>]*k+str[i])%M<br></code></pre></td></tr></table></figure><p>所以可以知道$ha[i]$就是$s[1…i]$的BKDRHash</p><p>现在询问$s[x…y]$的BKDRHash</p><p>通过公式可以发现</p><p>$ha[y]=s[1]*k<sup>{y-1}+s[2]*k</sup>{y-2}+…+s[x-1]*k<sup>{y-x+1}+s[x]*k</sup>{y-x}+…+s[y]$</p><p>注意到$ha[x-1]=s[1]*k<sup>{x-2}+s[2]*k</sup>{x-3}+…+s[x-1]$</p><p>而我们要求的$s[x…y]$的哈希值为$s[x]*k^{y-x}+…+s[y]$</p><p>可以发现$s[x…y]=ha[y]-ha[x-1]*k^{y-x+1}$</p><p>因此预处理出ha数组和k的幂次，每次询问$s[x…y]$的哈希值，只要$O(1)$的时间</p><h1>EQ</h1><h3 id="问题描述">问题描述</h3><p>鲍勃向你提出了Q个问题：在每个问题中，他给定你一个整数x，请你告诉他有多少个位置，满足“字符串A从该位置开始的后缀子串”与B匹配的长度恰好为x。</p><p>$1 ≤ N,M,Q ≤ 200000$</p><p>例如：</p><p>例如：A=aabcde，B=ab，则A有aabcde、abcde、bcde、cde、de、e这6个后缀子串，它们与B=ab的匹配长度分别是1、2、0、0、0、0。因此A有4个位置与B的匹配长度恰好为0，有1个位置的匹配长度恰好为1，有1个位置的匹配长度恰好为2。</p><h3 id="分析">分析</h3><p>理解题意，核心问题是：给定两个字符串A,B，求出A的每个后缀子串和B的最长公共前缀，标准做法是扩展KMP，时间复杂度呈线性</p><p>前面已经提到，我们可以用$O(n)$预处理O(1)处理出一个子串的哈希值</p><p>求字符串$A[i…n]$与字符串$B[1…m]$的最长公共前缀？</p><p>可以用二分</p><p>二分长度mid</p><p>计算$A[i…i+mid-1]$和$B[1…mid]$的哈希值并进行比较</p><p>时间复杂度是$O(log\ n)$</p><h3 id="代码">代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">ll <span class="hljs-title">getha</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123;<br><span class="hljs-keyword">return</span> ha[y] - ha[x - <span class="hljs-number">1</span>] * p[y - x + <span class="hljs-number">1</span>]; <br>&#125; <br><span class="hljs-function">ll <span class="hljs-title">gethb</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123;<br><span class="hljs-keyword">return</span> hb[y] - hb[x - <span class="hljs-number">1</span>] * p[y - x + <span class="hljs-number">1</span>]; <br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123; <br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;Q); <br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, a+<span class="hljs-number">1</span>); <br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, b+<span class="hljs-number">1</span>); <br>p[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>; <br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-built_in">max</span>(n,m);i++) p[i]=p[i<span class="hljs-number">-1</span>]*P;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i ++)ha[i]=ha[i<span class="hljs-number">-1</span>]*P+a[i];<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i ++) hb[i]=hb[i<span class="hljs-number">-1</span>]*P+b[i]; <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= n;i ++)&#123;<br><span class="hljs-type">int</span> l=<span class="hljs-number">1</span>,r=<span class="hljs-built_in">min</span>(m,n-i+<span class="hljs-number">1</span>),mid;<br><span class="hljs-keyword">while</span>(l&lt;=r)&#123;<br>mid=(l+r)&gt;&gt;<span class="hljs-number">1</span>;<span class="hljs-comment">//位运算</span><br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">getha</span>(i,i+mid<span class="hljs-number">-1</span>) == <span class="hljs-built_in">gethb</span>(<span class="hljs-number">1</span>,mid))&#123;<br>l=mid+<span class="hljs-number">1</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123; <br>r=mid<span class="hljs-number">-1</span>; <br>&#125;<br> &#125;<br>cnt[r]++; <br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>ACM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>STL基本容器</title>
    <link href="/a8ee19d5da2b/"/>
    <url>/a8ee19d5da2b/</url>
    
    <content type="html"><![CDATA[<h1>STL基本容器</h1><p>2018.10.03</p><h3 id="顺序容器">顺序容器</h3><ul class="lvl-0"><li class="lvl-2"><p>“数组”：vector</p></li><li class="lvl-2"><p>“队列”：queue,deque,priority_queue</p></li></ul><h3 id="关联容器">关联容器</h3><ul class="lvl-0"><li class="lvl-2"><p>“集合”：set,multiset,unordered_set</p></li><li class="lvl-2"><p>“字典”：map,unordered_map</p></li></ul><h1>Vector 动态数组</h1><p>头文件：<code>#include &lt;vector&gt;</code></p><h3 id="使用方法">使用方法</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c++">vector&lt;<span class="hljs-type">int</span>&gt; vec1; <span class="hljs-comment">//默认初始化,vec1是空的</span><br><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">vec2</span><span class="hljs-params">(vec1)</span></span>;<span class="hljs-comment">//使用vec1初始化vec2</span><br><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">vec3</span><span class="hljs-params">(vec1.begin(),vec1.end())</span></span>;<span class="hljs-comment">//使用vec1初始化vec3</span><br><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">vec4</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>; <span class="hljs-comment">//10个值是0的元素</span><br><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">vec5</span><span class="hljs-params">(<span class="hljs-number">10</span>,<span class="hljs-number">4</span>)</span></span>;<span class="hljs-comment">//10个值是4的元素</span><br><br>vec1.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">100</span>);<span class="hljs-comment">//尾部添加元素</span><br><span class="hljs-type">int</span> size = vec1.<span class="hljs-built_in">size</span>();<span class="hljs-comment">//元素个数</span><br><span class="hljs-type">bool</span> isEmpty = vec1.<span class="hljs-built_in">empty</span>();<span class="hljs-comment">//判断是否为空</span><br>cout&lt;&lt;vec[<span class="hljs-number">10</span>]&lt;&lt;endl; <span class="hljs-comment">//取得第一个元素</span><br>vec1.<span class="hljs-built_in">insert</span>(vec1.<span class="hljs-built_in">end</span>(),<span class="hljs-number">5</span>,<span class="hljs-number">3</span>);<span class="hljs-comment">//从vec1.back位置插入5个值为3的元素</span><br>vec1.<span class="hljs-built_in">pop_back</span>();<span class="hljs-comment">//删除末尾元素</span><br>vec1.<span class="hljs-built_in">erase</span>(vec1.<span class="hljs-built_in">begin</span>(),vec1.<span class="hljs-built_in">begin</span>()+<span class="hljs-number">2</span>);<span class="hljs-comment">//删除vec1[0]-vec[2]之间的元素，不包括vec1[2]其他元素的前移</span><br>cout&lt;&lt;(vec1==vec2)?<span class="hljs-literal">true</span>:<span class="hljs-literal">false</span>;<span class="hljs-comment">//判断是否相等==、!=、&gt;=、&lt;=...</span><br>vector&lt;<span class="hljs-type">int</span>&gt;::iterator iter = vec1.<span class="hljs-built_in">begin</span>();<span class="hljs-comment">//获取迭代器首地址</span><br>vector&lt;<span class="hljs-type">int</span>&gt;::<span class="hljs-type">const</span> iterator c iter=vec1.<span class="hljs-built_in">begin</span>();<span class="hljs-comment">//获取const类型迭代器</span><br>vec1.<span class="hljs-built_in">clear</span>();<span class="hljs-comment">//清空元素</span><br></code></pre></td></tr></table></figure><h2 id="遍历">遍历</h2><p>下标法</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-type">int</span> length = vec1.<span class="hljs-built_in">size</span>();<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;lengthl;i++)&#123;<br>    cout&lt;&lt;vec1[i];<br>&#125;<br>cout&lt;&lt;endl&lt;&lt;endl;<br></code></pre></td></tr></table></figure><p>迭代器法</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c++">vector&lt;<span class="hljs-type">int</span>&gt;::iterator iter=vec1.<span class="hljs-built_in">begin</span>();<br><span class="hljs-keyword">for</span>(;iter!=vec1.<span class="hljs-built_in">end</span>();iter++)&#123;<br>    cout&lt;&lt;*iter;<br>&#125;<br></code></pre></td></tr></table></figure><h1>Queue 队列</h1><p>可以看作是数组实现的队列</p><p>提一下队列特点：先进先出</p><p>头文件：<code>#include &lt;queue&gt;</code></p><h3 id="使用方法-2">使用方法</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++">queue&lt;<span class="hljs-type">int</span>&gt; q;<br>q.<span class="hljs-built_in">opo</span>();<span class="hljs-comment">//弹出队列第一个元素</span><br>q.<span class="hljs-built_in">push</span>();<span class="hljs-comment">//在队尾插入一个元素</span><br>q.<span class="hljs-built_in">empty</span>();<span class="hljs-comment">//判断队列是否为空</span><br>q.<span class="hljs-built_in">size</span>();<span class="hljs-comment">//获取队列长度</span><br>q.<span class="hljs-built_in">front</span>();<span class="hljs-comment">//返回队列第一个元素(最早，最先进入的元素)</span><br>q.<span class="hljs-built_in">back</span>();<span class="hljs-comment">//返回队列最后一个元素(最晚，最后进入的元素)</span><br></code></pre></td></tr></table></figure><h1>Deque 双端队列</h1><p>可以看作是数组实现的双端队列</p><p>头文件：<code>#include &lt;deque&gt;</code></p><h3 id="使用方法-3">使用方法</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c++">deque&lt;<span class="hljs-type">int</span>&gt; dq;<br>dq.<span class="hljs-built_in">pop_front</span>();<span class="hljs-comment">//在队首弹出一个元素</span><br>dq.<span class="hljs-built_in">pop_back</span>();<span class="hljs-comment">//在队尾弹出一个元素</span><br>dq.<span class="hljs-built_in">push_front</span>();<span class="hljs-comment">//在队首加入一个元素</span><br>dq.<span class="hljs-built_in">push_back</span>();<span class="hljs-comment">//在队尾加入一个元素</span><br>dq.<span class="hljs-built_in">size</span>();<span class="hljs-comment">//获取队列长度</span><br><br><span class="hljs-comment">//输出</span><br><span class="hljs-keyword">for</span> (pos = dq.<span class="hljs-built_in">begin</span>(); pos != dq.<span class="hljs-built_in">end</span>(); pos++)  <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, *pos);<br></code></pre></td></tr></table></figure><h1>Priority_queue 优先队列</h1><p>可以看作是最大堆/优先队列</p><p>这里稍微重点一下(因为老师花的时间比较多)</p><p>头文件：<code> #include &lt;queue&gt;</code></p><p>定义：<code>priority_queue&lt;Type, Container, Functional&gt;</code></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// 下面两种优先队列的定义是等价的</span><br>priority_queue&lt;<span class="hljs-type">int</span>&gt; q;<br>priority_queue&lt;<span class="hljs-type">int</span>,vector&lt;<span class="hljs-type">int</span>&gt;,less&lt;<span class="hljs-type">int</span>&gt; &gt;q;<br><br><span class="hljs-comment">//如果想要把最小的放在第一位，则只需要</span><br>priority_queue&lt;<span class="hljs-type">int</span>,vector&lt;<span class="hljs-type">int</span>&gt;,greater&lt;<span class="hljs-type">int</span>&gt; &gt;q;<br></code></pre></td></tr></table></figure><blockquote><p>less表示数字大的优先级高(队头),greater表示数字小的优先级高</p></blockquote><p>队头元素等价于优先级最高的元素</p><h3 id="使用方法-4">使用方法</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++">priority_queue&lt;<span class="hljs-type">int</span>&gt; a;<br>a.<span class="hljs-built_in">top</span>();<span class="hljs-comment">//访问队头元素</span><br>a.<span class="hljs-built_in">empty</span>();<span class="hljs-comment">//判断是否为空</span><br>a.<span class="hljs-built_in">size</span>();<span class="hljs-comment">//返回堆的大小</span><br>a.<span class="hljs-built_in">push</span>();<span class="hljs-comment">//插入元素</span><br>a.<span class="hljs-built_in">pop</span>();<span class="hljs-comment">//删除队头元素</span><br>a.<span class="hljs-built_in">swap</span>(b);<span class="hljs-comment">//交换队列</span><br></code></pre></td></tr></table></figure><h3 id="结构体的优先级设置">结构体的优先级设置</h3><p>来源于CSDN作者琦小虾的文章:<a href="https://blog.csdn.net/ajianyingxiaoqinghan/article/details/79734532">链接</a></p><h3 id="基本类型例子">基本类型例子</h3><p>上课记得笔记找不到了…这边引用了CSDN作者吕白_的文章:<a href="https://blog.csdn.net/weixin_36888577/article/details/79937886">链接</a>  O～O</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//对于基础类型 默认是大顶堆</span><br>    priority_queue&lt;<span class="hljs-type">int</span>&gt; a; <br>    <span class="hljs-comment">//等同于 priority_queue&lt;int, vector&lt;int&gt;, less&lt;int&gt; &gt; a</span><br>    <span class="hljs-comment">//                这里一定要有空格，不然成了右移运算符↓</span><br>    priority_queue&lt;<span class="hljs-type">int</span>, vector&lt;<span class="hljs-type">int</span>&gt;, greater&lt;<span class="hljs-type">int</span>&gt; &gt; c;  <span class="hljs-comment">//这样就是小顶堆</span><br>    priority_queue&lt;string&gt; b;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)&#123;<br>        a.<span class="hljs-built_in">push</span>(i);<br>        c.<span class="hljs-built_in">push</span>(i);<br>    &#125;<br>    <span class="hljs-keyword">while</span> (!a.<span class="hljs-built_in">empty</span>()) &#123;<br>        cout &lt;&lt; a.<span class="hljs-built_in">top</span>() &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>        a.<span class="hljs-built_in">pop</span>();<br>    &#125; <br>    cout &lt;&lt; endl;<br>    <span class="hljs-keyword">while</span> (!c.<span class="hljs-built_in">empty</span>()) &#123;<br>        cout &lt;&lt; c.<span class="hljs-built_in">top</span>() &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>        c.<span class="hljs-built_in">pop</span>();<br>    &#125;<br>    cout &lt;&lt; endl;<br>    b.<span class="hljs-built_in">push</span>(<span class="hljs-string">&quot;abc&quot;</span>);<br>    b.<span class="hljs-built_in">push</span>(<span class="hljs-string">&quot;abcd&quot;</span>);<br>    b.<span class="hljs-built_in">push</span>(<span class="hljs-string">&quot;cbd&quot;</span>);<br>    <span class="hljs-keyword">while</span> (!b.<span class="hljs-built_in">empty</span>()) <br>    &#123;<br>        cout &lt;&lt; b.<span class="hljs-built_in">top</span>() &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>        b.<span class="hljs-built_in">pop</span>();<br>    &#125; <br>    cout &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">//输出:</span><br><span class="hljs-comment">//4 3 2 1 0</span><br><span class="hljs-comment">//0 1 2 3 4</span><br><span class="hljs-comment">//cbd abcd abc</span><br></code></pre></td></tr></table></figure><h3 id="pair的比较">pair的比较</h3><p>先比较第一个，再比较第二个</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span><br><span class="hljs-function"></span>&#123;<br>    priority_queue&lt;pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; &gt; a;<br>    <span class="hljs-function">pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; <span class="hljs-title">b</span><span class="hljs-params">(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span></span>;<br>    <span class="hljs-function">pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; <span class="hljs-title">c</span><span class="hljs-params">(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)</span></span>;<br>    <span class="hljs-function">pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; <span class="hljs-title">d</span><span class="hljs-params">(<span class="hljs-number">2</span>, <span class="hljs-number">5</span>)</span></span>;<br>    a.<span class="hljs-built_in">push</span>(d);<br>    a.<span class="hljs-built_in">push</span>(c);<br>    a.<span class="hljs-built_in">push</span>(b);<br>    <span class="hljs-keyword">while</span> (!a.<span class="hljs-built_in">empty</span>()) <br>    &#123;<br>        cout &lt;&lt; a.<span class="hljs-built_in">top</span>().first &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; a.<span class="hljs-built_in">top</span>().second &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>        a.<span class="hljs-built_in">pop</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//输出：</span><br><span class="hljs-comment">//2 5</span><br><span class="hljs-comment">//1 3</span><br><span class="hljs-comment">//1 2</span><br></code></pre></td></tr></table></figure><h3 id="自定义类型例子">自定义类型例子</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">//方法1</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">tmp1</span> <span class="hljs-comment">//运算符重载&lt;</span><br>&#123;<br>    <span class="hljs-type">int</span> x;<br>    <span class="hljs-built_in">tmp1</span>(<span class="hljs-type">int</span> a) &#123;x = a;&#125;<br>    <span class="hljs-type">bool</span> <span class="hljs-keyword">operator</span>&lt;(<span class="hljs-type">const</span> tmp1&amp; a) <span class="hljs-type">const</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> x &lt; a.x; <span class="hljs-comment">//大顶堆</span><br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">//方法2</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">tmp2</span> <span class="hljs-comment">//重写仿函数</span><br>&#123;<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span> <span class="hljs-params">(tmp1 a, tmp1 b)</span> </span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> a.x &lt; b.x; <span class="hljs-comment">//大顶堆</span><br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">tmp1 <span class="hljs-title">a</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-function">tmp1 <span class="hljs-title">b</span><span class="hljs-params">(<span class="hljs-number">2</span>)</span></span>;<br>    <span class="hljs-function">tmp1 <span class="hljs-title">c</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span></span>;<br>    priority_queue&lt;tmp1&gt; d;<br>    d.<span class="hljs-built_in">push</span>(b);<br>    d.<span class="hljs-built_in">push</span>(c);<br>    d.<span class="hljs-built_in">push</span>(a);<br>    <span class="hljs-keyword">while</span> (!d.<span class="hljs-built_in">empty</span>())&#123;<br>        cout &lt;&lt; d.<span class="hljs-built_in">top</span>().x &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>        d.<span class="hljs-built_in">pop</span>();<br>    &#125;<br>    cout &lt;&lt; endl;<br>    priority_queue&lt;tmp1, vector&lt;tmp1&gt;, tmp2&gt; f;<br>    f.<span class="hljs-built_in">push</span>(c);<br>    f.<span class="hljs-built_in">push</span>(b);<br>    f.<span class="hljs-built_in">push</span>(a);<br>    <span class="hljs-keyword">while</span> (!f.<span class="hljs-built_in">empty</span>()) <br>    &#123;<br>        cout &lt;&lt; f.<span class="hljs-built_in">top</span>().x &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>        f.<span class="hljs-built_in">pop</span>();<br>    &#125;<br>&#125;<br><span class="hljs-comment">//输出:</span><br><span class="hljs-comment">//3</span><br><span class="hljs-comment">//2</span><br><span class="hljs-comment">//1</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//3</span><br><span class="hljs-comment">//2</span><br><span class="hljs-comment">//1</span><br></code></pre></td></tr></table></figure><h3 id="打印堆中元素">打印堆中元素</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">while</span>(!q.<span class="hljs-built_in">empty</span>())&#123;<br>    cout&lt;&lt;q.<span class="hljs-built_in">top</span>()&lt;&lt;endl;<br>    q.<span class="hljs-built_in">pop</span>();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="其他">其他</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::priority_queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> n :&#123;<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>&#125;) q.<span class="hljs-built_in">push</span>(n);<br>    <span class="hljs-built_in">print_queue</span>(q);<br>    std::priority_queue&lt;<span class="hljs-type">int</span>,std::vector&lt;<span class="hljs-type">int</span>&gt;,std::greater&lt;<span class="hljs-type">int</span>&gt;&gt; q2;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> n : &#123;<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>&#125;) q2.<span class="hljs-built_in">push</span>(n);<br>    <span class="hljs-built_in">print_queue</span>(q2);<br>    <span class="hljs-comment">//用lambda比较元素</span><br>    <span class="hljs-keyword">auto</span> cmp=[](<span class="hljs-type">int</span> left,<span class="hljs-type">int</span> right)&#123;<span class="hljs-built_in">return</span> (left^<span class="hljs-number">1</span>)&lt;(right^<span class="hljs-number">1</span>);&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> n:&#123;<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>&#125;) q3.<span class="hljs-built_in">push</span>(n);<br>    <span class="hljs-built_in">print_queue</span>(q3);<br>&#125;<br></code></pre></td></tr></table></figure><h1>Set 堆</h1><p>可以看作是维护的有序数组，可以用作堆</p><p>头文件：<code>#include &lt;set&gt;</code></p><p>一个元素只能出现一次，如果要出现多次需要用到multiset</p><p>定义：<code>set&lt;int&gt; s;</code></p><h3 id="常用操作">常用操作</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c++">s.<span class="hljs-built_in">begin</span>(); <span class="hljs-comment">//返回指向第一个元素的迭代器</span><br>s.<span class="hljs-built_in">end</span>(); <span class="hljs-comment">//返回指向最后一个元素的迭代器</span><br>s.<span class="hljs-built_in">insert</span>(); <span class="hljs-comment">//插入一个元素</span><br>s.<span class="hljs-built_in">erase</span>(a); <span class="hljs-comment">//删除集合中键值为a的元素</span><br>s.<span class="hljs-built_in">size</span>(); <span class="hljs-comment">//尺寸</span><br>s.<span class="hljs-built_in">count</span>();<span class="hljs-comment">//返回某个值元素的个数</span><br>s.<span class="hljs-built_in">empty</span>();<span class="hljs-comment">//是否为空</span><br>s.<span class="hljs-built_in">swap</span>();<span class="hljs-comment">//交换2个集合变量</span><br>s.<span class="hljs-built_in">upper_bound</span>();<span class="hljs-comment">//返回大于某个值元素的迭代器</span><br>s.<span class="hljs-built_in">lower_bound</span>();<span class="hljs-comment">//返回小于某个值元素的迭代器</span><br><br><span class="hljs-comment">//迭代器使用方法同上面</span><br><br>set&lt;<span class="hljs-type">int</span>&gt;::iterator iter=s.<span class="hljs-built_in">begin</span>();<br><span class="hljs-keyword">for</span>(;iter!=s.<span class="hljs-built_in">end</span>();iter++)&#123;<br>    cout&lt;&lt;*iter;<br>&#125;<br></code></pre></td></tr></table></figure><h1>Bitset</h1><p>方便的进行位运算,常用来处理二进制位的有序集</p><p>头文件：<code>#include &lt;bitset&gt;</code></p><p>每个位可能包含0或者1，也可以当作<strong>false</strong>和<strong>true</strong></p><p>定义：<code>bitset&lt;40&gt; b;</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>ACM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>智学网HTTP协议分析记录</title>
    <link href="/789d77bcbb37/"/>
    <url>/789d77bcbb37/</url>
    
    <content type="html"><![CDATA[<h1>智学网(<a href="http://zhixue.com">zhixue.com</a>)HTTP协议分析记录</h1><p>2018.11.23，智学网APP，Android，Charles抓包</p><h1>登录</h1><h2 id="接口API">接口API</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span><br><span class="hljs-attribute">http</span>://www.zhixue.com/container/app/weakCheckLogin?<br><br><span class="hljs-attribute">password</span>=<span class="hljs-number">08</span>c185208d0e57efc854&amp;loginName=<span class="hljs-number">38268068</span>&amp;description=%<span class="hljs-number">7</span>B%<span class="hljs-number">27</span>encrypt%<span class="hljs-number">27</span>%<span class="hljs-number">3</span>A%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>password%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">7</span>D&amp;deviceMac=<span class="hljs-number">50</span>%<span class="hljs-number">3</span>A8F%<span class="hljs-number">3</span>A4C%<span class="hljs-number">3</span>AFA%<span class="hljs-number">3</span>AAA%<span class="hljs-number">3</span>A3B&amp;deviceId=<span class="hljs-number">866146033672761</span><br></code></pre></td></tr></table></figure><p>POST数据解析</p><table><thead><tr><th>password</th><th>08c185208d0e57efc854</th></tr></thead><tbody><tr><td>loginName</td><td>38268068</td></tr><tr><td>description</td><td>{‘encrypt’:[‘password’]}</td></tr><tr><td>deviceMac</td><td>50:8F:4C:FA:AA:3B</td></tr><tr><td>deviceId</td><td>866146033672761</td></tr></tbody></table><p><strong>password</strong>:加密后的密码，算法不知道，估计难拆，不过用作查询不需要拆</p><p><strong>description</strong>:给服务端表明这份密码是加密过的</p><p><strong>deviceMac</strong>:设备的mac地址，用作查询不需要改</p><p><strong>deviceld</strong>:这个不知道…为什么不是id而是ld…</p><h2 id="返回json">返回json</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;errorCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;errorInfo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;操作成功&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;accountType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;userCode&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;clazzInfo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;5423495a-22f6-4be8-97de-3d19206f4be7&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;gradeCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;11&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;graduated&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4444000020000342148&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;高二年级4班&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;order&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;phase&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;05&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;phaseName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;高中&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;schoolId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2244000020000000338&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;year&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2017</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;createdBy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zx&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;currentloginType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zx&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;customInfo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;simpleAndNormalVip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;simpleVip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;viewSummerHomework&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;hasOrg&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4444000020022642541&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;isAdmin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;isInitialPwd&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;林黄骁&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;preLoginDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1542987371000</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;student&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;roles&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;student&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;serverInfo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;curServerTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1542987504466</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;token&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;63db0c7d-b13f-4300-a643-16bad50cd221&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;userInfo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;birthday&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1503244800000</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;38268068&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;email&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;gender&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4444000020022642541&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;im&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;loginName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zx38268068&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;mobile&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;13950383863&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;林黄骁&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;school&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;areaId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1267&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;cityId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1263&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;countryId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;districtId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1267&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;phase&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;05&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;provinceId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1262&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;schoolCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1003&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;schoolId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2244000020000000338&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;schoolName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;福建省福州八中&quot;</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;vipInfo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;hidden&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;vipBeginTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1509206400000</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;vipEndTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1540828799000</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;vipLevel&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;virtualTagInfo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;areaName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;cityId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;cityName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;districtId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;districtName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;needAreaPop&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;needGradePop&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;nickName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;provinceId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;provinceName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;roleTag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>此处的token=63db0c7d-b13f-4300-a643-16bad50cd221会发现基本所有的接口都需要这个token作为一个验证参数</p><h1>查询</h1><h2 id="接口API-2">接口API</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><br><span class="hljs-attribute">GET</span><br><br><span class="hljs-attribute">http</span>://app.zhixue.com/study/social/getGuessScore?&amp;examId=f899e9d4-db72-<span class="hljs-number">4</span>fad-<span class="hljs-number">96</span>ea-<span class="hljs-number">307</span>b15d4896b&amp;guessUserId=<span class="hljs-number">4444000020022642815</span>&amp;token=f867f8c8-fb39-<span class="hljs-number">4</span>de6-<span class="hljs-number">8188</span>-e65ccd1565bc&amp;childrenId=<span class="hljs-number">4444000020022642541</span><br><br><span class="hljs-attribute">http</span>://app.zhixue.com/study/social/getGuessScore?&amp;examId=<span class="hljs-number">911973</span>c8-<span class="hljs-number">750</span>d-<span class="hljs-number">4</span>bd2-<span class="hljs-number">9037</span>-<span class="hljs-number">32</span>eb60904012&amp;guessUserId=<span class="hljs-number">4444000020022642389</span>&amp;token=e5295e82-<span class="hljs-number">6684</span>-<span class="hljs-number">44</span>e5-a2f9-<span class="hljs-number">7</span>f25c64ae0c1&amp;childrenId=<span class="hljs-number">4444000020022642541</span><br><br><span class="hljs-attribute">http</span>://app.zhixue.com/study/social/getGuessScore?&amp;examId=&#123;exam_id&#125;&amp;guessUserId=&#123;userid&#125;&amp;token=&#123;token&#125;&amp;childrenId=&#123;userid_myself&#125;<br><br></code></pre></td></tr></table></figure><h2 id="参数分析">参数分析</h2><p><strong>examId</strong>：考试ID，已经可以抓到</p><p><strong>guessUserId</strong>：伴学的ID，不需要添加为好友</p><p><strong>token</strong>：智学网APP账户钥匙，与登录的保持一致</p><p><strong>childrenId</strong>：自己的智学网ID</p><h2 id="缺陷">缺陷</h2><p>需要VIP账号，不然有次数限制</p><h2 id="返回json-2">返回json</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;errorCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;errorInfo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;操作成功&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;customForbidDTO&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;user_Ratio_To_Level&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;user_Score_To_Level&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Class_Rank&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Grade_Rank&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Union_Rank&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Class_AvgScore&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Grade_AvgScore&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Union_AvgScore&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Class_HighScore&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Grade_HighScore&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Union_HighScore&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Origin_Paper&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;forbid_Score_PK&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;show_Intelligent_Correct&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;show_UserLevel&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;show_Score_Distribution&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;show_WrongTopic_Training&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;studentPKDTOs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;userId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4444000020022642541&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;avatar&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;林黄骁&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;subjectList&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;subjectCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;subjectName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;总分&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">215.0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;classPercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;gradePercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;subjectCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;14&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;subjectName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;地理&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">76.5</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;classPercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;gradePercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;subjectCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;12&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;subjectName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;历史&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">69.5</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;classPercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;gradePercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;subjectCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;27&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;subjectName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;政治&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">69.0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;classPercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;gradePercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;isFriend&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;isSelf&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;isVip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;userId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4444000020022642535&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;avatar&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;杨宸杰&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;subjectList&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;subjectCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;subjectName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;总分&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">171.5</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;classPercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;gradePercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;subjectCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;14&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;subjectName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;地理&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">64.0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;classPercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;gradePercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;subjectCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;12&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;subjectName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;历史&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">63.5</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;classPercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;gradePercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;subjectCode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;27&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;subjectName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;政治&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">44.0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;classPercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;gradePercent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;isFriend&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;isSelf&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;isVip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h1>2018.12.23</h1><h2 id="前言">前言</h2><p>大概是一周前，应该是我生日前一天，智学网对上文提到的接口api添加了协议头验证，扒出来是加了这个验证也花了挺多时间，然后顺便也解决了我三个月前的一个web端疑问，web端有几个api总是提示参数缺失，而提交的数据和cookie都没有什么问题。</p><h2 id="协议头HTTP-HEADER">协议头HTTP HEADER</h2><p>首先扒出来了他的协议头：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs html">POST /container/app/weakCheckLogin? HTTP/1.1<br>deviceId: 866146033672761<br>browserVersion: Android_1.8.1595<br>channelId: Android_11010005<br>deviceMac: 50:8F:4C:FA:AA:3B<br>resolution: 1920*1080<br>authbizcode: 0001<br>authguid: 4ff59b11-eb56-4614-b6f5-2bfa889d4d40<br>authtimestamp: 1545492288739<br>authtoken: 8e59161b459405c5b7c48006c0d8b426<br>Content-Length: 168<br>Content-Type: application/x-www-form-urlencoded<br>Host: www.zhixue.com<br>Cookie: tlsysSessionId=bc887c7f-6626-46a7-906a-9dab53f17211; __DAYU_PP=fE7YI3jmfneyaq6NMmma43a9dc4cbb04; JSESSIONID=0EF8C11939B7BD9E5C459E2DD17F4B59<br>Cookie2: $Version=1<br>Accept-Encoding: gzip<br>Connection: keep-alive<br></code></pre></td></tr></table></figure><p>经过一波分析和实验，得出智学网其实只是验证了这三个参数</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">authguid</span>: <span class="hljs-number">4</span>ff59b11-eb56-<span class="hljs-number">4614</span>-b6f5-<span class="hljs-number">2</span>bfa889d4d40<br><span class="hljs-attribute">authtimestamp</span>: <span class="hljs-number">1545492288739</span> //<span class="hljs-number">13</span>位时间戳，精确到毫秒<br><span class="hljs-attribute">authtoken</span>: <span class="hljs-number">8</span>e59161b459405c5b7c48006c0d8b426<br></code></pre></td></tr></table></figure><p>很头大，中间花了一个多小时找这三个参数来源，最后发现，这个应该是实时生成的，每一次请求这三个都不一样</p><p>但是手机端又不会给出加密算法，只能靠电脑端了</p><p>还好这个加密算法被封进了app.js</p><h2 id="app-js">app.js</h2><p>从google dev-tools里面扒拉出来的，不知道为什么charles没有扒拉出这个…很玄吧</p><h3 id="AuthGUID">AuthGUID</h3><p>关于对guid生成的算法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = [], e = <span class="hljs-number">0</span>; e &lt; <span class="hljs-number">36</span>; e++) <span class="hljs-comment">//一共取36位</span><br>t[e] = <span class="hljs-string">&quot;0123456789abcdef&quot;</span>.<span class="hljs-title function_">substr</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-number">16</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()), <span class="hljs-number">1</span>); <br><span class="hljs-comment">//随机0-1，相乘，取不大于这个数的最大整数</span><br><br><span class="hljs-keyword">return</span> t[<span class="hljs-number">14</span>] = <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-comment">//14位强行替换为4，参照结果来看这是一个事实</span><br>t[<span class="hljs-number">19</span>] = <span class="hljs-string">&quot;0123456789abcdef&quot;</span>.<span class="hljs-title function_">substr</span>(<span class="hljs-number">3</span> &amp; t[<span class="hljs-number">19</span>] | <span class="hljs-number">8</span>, <span class="hljs-number">1</span>), <span class="hljs-comment">//第19位进行与或</span><br><span class="hljs-comment">//从代码上看我怎么感觉只能取出8,9,10,11位的数..一定是错觉</span><br>t[<span class="hljs-number">8</span>] = t[<span class="hljs-number">13</span>] = t[<span class="hljs-number">18</span>] = t[<span class="hljs-number">23</span>] = <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-comment">//这里进行替换，强行改成-</span><br>t.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs maxima">结果：<br><span class="hljs-number">012345678901234567890123456789012345</span> //位数对照<br>f0e39247-<span class="hljs-number">054b-4042</span>-<span class="hljs-number">9382</span>-38511c3b2060<br>4ff59b11-eb56-<span class="hljs-number">4614</span>-b6f5-2bfa889d4d40<br></code></pre></td></tr></table></figure><p>这里已经算出来guid了</p><h1>AuthToken</h1><p>这个算法很奇怪，这是里面的一部分，或者就是全部的代码吧？</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">webpackJsonp</span>([<span class="hljs-number">1</span>], &#123;<br>    <span class="hljs-string">&quot;+BTi&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-string">&quot;+ECs&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-string">&quot;0RHc&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-string">&quot;150l&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-string">&quot;1zUs&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-string">&quot;2aH0&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;<br>            t.<span class="hljs-property">exports</span> = <span class="hljs-string">&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAgCAMAAADZqYNOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OTMwMjYyMUZGM0FFMTFFODg3OTFGNzlFNjAwQ0ZENjkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OTMwMjYyMUVGM0FFMTFFODg3OTFGNzlFNjAwQ0ZENjkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjIyN0FGNEQ3NTI1ODExRTZBMzg2RjlDRjg2RkI0NUY1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjIyN0FGNEQ4NTI1ODExRTZBMzg2RjlDRjg2RkI0NUY1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+NRPJrwAAAJ9QTFRFrOrkiuLZm+bf4vj1et7Up+niHse2B8GvkeTbXdfLieLZFMWz0/Txte3nMcy82PXyuu7ptu3n1vXy6vr4n+fg9f385vn3t+3o8Pv63fb0tOznHce20PPwSNLE8fz7yPHtyfLusezmX9fLH8i3oejhvu/qwO/rCMKvXtfL7/v6guDWXNfK8/z73Pb0revk5/n3qerj7fv5BsGuBcGu////VYK8ngAAADV0Uk5T/////////////////////////////////////////////////////////////////////wB8tdAKAAAAtklEQVR42qzT2Q7CIBAF0IFSqGutW9W27vuuw/9/mzFVHqAlJXofOcllQgaQtkAVXQrUI/ZKd2hGKEU0Wt9HH80ymxYk15gbN/JYKS8YiCstGaiqdgmZTkhfBmQ2JqSnqY/o1bAtG1hvITY19QAGc+jIBYRDgJGmF0rPG3qVa5p6lD6cmu1T2e+1N6eMHe4skEe2DRm7Ob3Vf9X/7lWZPk+25nyff9GivUqURomBq8jll5XkJcAA89Ooa6nFvYgAAAAASUVORK5CYII=&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;3JRO&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;<br>            t.<span class="hljs-property">exports</span> = <span class="hljs-string">&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAgCAMAAADZqYNOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OTMwMjYyMjNGM0FFMTFFODg3OTFGNzlFNjAwQ0ZENjkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OTMwMjYyMjJGM0FFMTFFODg3OTFGNzlFNjAwQ0ZENjkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjIyN0FGNEQ3NTI1ODExRTZBMzg2RjlDRjg2RkI0NUY1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjIyN0FGNEQ4NTI1ODExRTZBMzg2RjlDRjg2RkI0NUY1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+5kDDrQAAAYBQTFRFVdXIQdDBPc/AK8q6G8a1FsWz8Pv6+/7+BsGuM8y90/Tx+P39yfLuqOnj7Pr5RNHCCMKvw/DsPs/ALcu7UNPGD8OxiuLZGMa0EMSxte3net7UT9PGF8W0EcSys+zm+v79DMOw6vr4uO3of9/VbdvQOs6/wO/rW9bKeN3T+f79Lsu70fTwDcOxtO3n9v38CcKv/f/+rOrkWNbJv+/qwfDrHse2ZdnN8/z7LMu7/P7+8vz77vv67/v6dd3Sq+rk5Pj29/38b9vQbtvQJ8q51/Xy4Pf1YNjMH8i3l+Xddt3T2fbzhuHYN82+c9zSp+niC8KwP8/BXNfKi+La5fj2zfPvxvHt9Pz8gN/W5/n37fv5nufgTNPFIsi4vO7p8fz7m+bfRtHDIci3EsSyMcy8yPHtsezmSdLEfd/VguDWcNzRB8GvJMm42vbzRdHDOc6/oOfg6fr4zPLu3Pb0Msy9e97UTtPGft/VieLZWdbJ3fb01vXyO86/luXdiOLZBcGu////avyEswAAAIB0Uk5T/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wA4BUtnAAABlklEQVR42qyTV1cCMRCFUWCX6tJ7l6KAKB0Eexd77x1773Xy10123UM8lhedl71zv5Pck81Egn4ryZ9oymqy6NW0p9ZbnNaIQIGUz+DwNJB+2eMw+IijEKk2qDwmvfHOaVRgoVP2agFEij9MoJGzkSVmrjHAYIOi/J7IqwHQeHnZQFP5zXhLu7igXD2KrtFUirdsNXQRGQvpcBOiKRodlrhARaQdZI+bT59yu7FomysTORsjbjdNZVxlnhVzm/WHdX00HcJRO6YlIp9XycGiNGX3KmdxMde8b7kq0rQNi8Q6f8iBsPDLKXoiee2vWWymqUBTF47KDvp5ayIixx2RzL1A8/YOpULIJVfmmtaiZLJ5q168BYT8nZe8LDRlWN7Iua9rtJYr1ANcoB9pVZFCX2mLilca83bpG2pq7cgj1JXVhdE3tDQG2U5mF26RSDUslcu8AFjh3PtB3QA2bjGw8UHVzBSA+1Sc53TOCPwg9uBBPJA6UHsdrNBvwe8ZMUyCUPUILcx8eSkJ/ZvTFw+mi//1yt4FGAAD3X9yTjfCbwAAAABJRU5ErkJggg==&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;6atI&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-string">&quot;7XQ6&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-string">&quot;8XQW&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-string">&quot;9RkD&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e, s</span>) &#123;<br>            t.<span class="hljs-property">exports</span> = s.<span class="hljs-property">p</span> + <span class="hljs-string">&quot;static/img/composition-banner.24153ed.png&quot;</span><br>    &#125;,<br>    <span class="hljs-title class_">CCWw</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-title class_">EyqX</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-title class_">FGfq</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-title class_">HQok</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-attr">I4nB</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-string">&quot;It+H&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-attr">JGNI</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-attr">KTGR</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;<br>            t.<span class="hljs-property">exports</span> = <span class="hljs-string">&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA5CAYAAACWJGMLAAAIB0lEQVRoQ92afYwcZR3Hv7+Zndm7tgSEtJVWCLShkrbIXayA9Ha2JxKai9zdzpUjQAUbI4VCLFRtUlOQWE2r1siLYlFCCNWq693snafYYOnezl2PgkDxlMQUEl8LalWapnfsPvPyM7P3wt3t7Mvs7Fm95899fi/fz/N75pnneXYIc7DRHGTCfw0qkjaaJBlbwNAALARwEgTTdfC43awP1nJwZx8qnY5EpVOPMOFuMBfmI2JifDfnnrcVzc12LeBmHSqaSX2HwVvKiSXQ47l44p5ydpX0zyrU2JQj07dCM9URseuwVoupOKtQqpk6AOZbKhndvA3hR0LTb63Yvojh7EJljL8CWBpA5AkR1z8QwN7XdLahcgDUykVSTsQTdZXb+1vONtQcrNRcfKbm5Ornzfg5957KP8ZzcUcxsT6NT8UtYJ6y9yPTdfj/cO8Xdn2uwn9Wl/Qq9NTEZXahDvUujqjcILHbCFADiBsBXATguCRHtmXXth6uCcWMILWBYlD0cGoZK2gAcyMIDQA1gnlJcdGcJfCHcvENb9QarGqo+qG+pY7j3Muuey2AKwk4N7g4ekDEE18J7lfaoyqo+kzPRTbcXxOwOKSgncId/lpd5MqmbCzRXyyWkulqBOQ7AMgc4QP2Wv2FUnmrglJNYz8YG0MC2QR3pUvyejDvkhFpzMZb/zAtJjOpA8ZOMB4CSBrrIxtEtwitvatY/sBQ6lDf5bCs33mjFgaKgUctN7tLkeqOE/A+AC+J+SebsGazlY/7q+S5qhp5BkCrT543RFxfUTuoTOrHAN8cEuik5dKKqMS7GbhrMhZJ3xBa+3bV7FkJdlMAignPibhe9IgSqFLqEWM1bPwGwPhUmIpGIwweBvNrkOgYAToY6/3gmXAnQX4RrvMqaErFCS7Ae5npbgLOKTZwTHTI0hLX16RSaqa7C6AOn2CjimsvH2nu/JvXNzZFxTBASoEt0Ssi1n6VYqYOEdBcRcVPSIjECp6/KYEqrpSSTjWQzK+AC6tEhL05Tf/CRFzVTB0E8w0+gtkljtlaxxE1Y/QWeV6KchJhMOfYN2F88EJXSjVTPWBumxmIgTMW2cugdZ7MV8k02sDo8U1I9AOhJT6Z7xs6eL5qjb42vsMoWzACfzs3/5/bJheSEh4VVUpJd60hSXopf99T2PaIuL4j//Ozz0bVBdnXwVjuB6/I8gdHm9remuiLDPbEJIcPAxwpofFdlmizFUvsL0s+blARlJpJ/QLglgKhRKctwcvwcf1fY1Xq+SLY/WqR5DtEXN8zs081Uw+A+ctFfP7IcHUrvuFYpUCeXVkoxUxdRcDRIlfGu4SWeNAL5G2bbMv6PQELCgXwm2KkfjVaWrzbpemNWYoOpJ5jxnUzep4TFm6dGLDaQmWMhwnY6jOdTlkuXYrmxKnxZ+kpMDb5JScJN+Zi+s+LCnu5b170jPWIS0gQaBTgJ4SW2A0iNwjMhG35SmVSewn8uYLghC8JTR+bNsykmKnT/lXKT4cnciOj29Gy8XQ1IoP6lIfq7/4IEb04faryn0W0/gpc0zIpUjWNETDmlRDwF5LkO3OxtoNBRQa1LwuVn1r9xk0gPAxgERMdJUm+SzS1vj41WUW3RkQM5meEpN6P2CfeCSq2UvuKoCaDJZMyOjudmcGj/ca2HNvfU2XlMTB/qoLkb0vMt2XXdaQrsA1sEgzKL/xQsl61lRGAf8tQNklwL2R29gEoc9HPWQnKylLbncA04w6hoaJH+y7jnHU8H4/gHRt2C0d5LErWbiZ8uuRrY3xXXq34Yn6hoSIZ42MS8Pz0BHwMJG+UCEtc1/0+gEv8BdCbIp647H8OSskYdxDwtI+wpIjrNyOdXKBIkT0EeH+RFg5iBFeItbp36KxZC10pNdO9E6BdMxWxRN+0YonPT/yuZoyXAXy4QDnzg2JdR4F/GMLQUErG2EfA5gIoovstLeG9BvKtGDyAV0VcL4QNQRUOarD3HNVxTYAbCjQQbRBaonsSavBnq+DYftOMJZsvzV7X8acQHNNcq4aKDhgrmCkF5pV+YpjoaktLeMeVyaZmDG+VLFgYiLE1t05/9KxCRQd7WlzH/SEB5xUR4ghl3iJcu/7f06BM4+tgTJ6QJ/qY0W+t06s52vumD1YpBqkDPTvAzq737uF84hL1CC2RmNkTOWJ8VLIx5ONhizq8H1ePncvCtsqh0skFqiQ/XeTiZVLH2D0C3ThxJJkm0LucNFMnAFzos7BssrSE36shMGNFUNEjqeVss3fvsLpUBgL25eZf/FmsWTN2IenTogPGPnYLV0sQeoWmtwcm8Jso5YLU9fc2O5LTRYzzS9jmmKR7La39yXLxomljPUv4pY/duyJ7ZiFuuH2kXIxy/SUrVT/Yd7HtWMNl/tF4i+VIh9XUerRcsnx/MqkqiyP/KBKzQ8R1o6I4JYxKQkXN7vuY6VvF/ekFQW4HtI63gwhRTeMAGIXfLBHtF1ri9iCx/GxLQilm6j5i9oUiwpO5C+x7sKpTBBWhZlKdAP+kYLEA3rH+bi/0O7MFyVESat5g7xLbcY8DPP+95Q2CIW+1tDbvzFRd83YituN9mRmdGUCK8CXZteF2F2VXPyXdfQ1J+Sm4ioFjkKTtVqzdu7MI1dSM4W2h9KlB2KuUO7wIzQ+F+kKzLFQo5SWc1XTX5SxJJo19T+sdSlwm+TNWrO2psDnPGpQnvP755FJHlm+DJF3AjvNTq3mDdzwJ3c4qVGj1RQL8B6dpFGdwPIfDAAAAAElFTkSuQmCC&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;KqW/&quot;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;<br>            t.<span class="hljs-property">exports</span> = <span class="hljs-string">&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA5CAYAAACWJGMLAAAIDUlEQVRoQ+1aa2wc1RX+zt2Z2XVCiUOgoQ2Vyo82bQMVtHm0hN2xIY8SQHjHITQgEahoAi4BVSS0Eqg4rVoTqiSClJAXD6E0paaejZ02lDZhPWsHQh+pCipK6UOqSqBJCKTKyzuzc081TmPZ63nt2nEM4v6z73fPOd89Z86599wlfAgHfQg54SNSHxSvjlpPKXnzSpFAExgZABcAOARCQbpYV6o3usM2ePSRyueVpDjyKBPuAvNg+4iYGE8UZe29qK8v+ZEbdaSSVu5xBjdFhTqB1hX17LdGPalTIUcFXw+VW0/E0uWMXyiOKk9phdxWMC+M8lLfPOFndsa4eRDf2AJGAKhZ5lsAJlWgar+tGxedeVLbt4/RxpXmAGhgxtcIPAZE7Qrk/Scyje+EGaxZZhGAFp8UFW09mzozpLp+OV6Fcx1JzgKYC2BMuSIGjoBwv5M2NoPAfoafdU/VvLx9knScBknUQMw6ADXODjOhU7BcXNTn/60cf/a+qRefHaulztkAwkIwRBwiPpiTgFhhy3Gr+teas5b9kl3mepZYUiWZsmX0JyZ5h5Np3Ht64qzUKdUy3yNg/PCQ6pVSAtFqW3GaccWCk6jgRKGJ9z/DwE8ImAbCm0ImlvfU3ZCvuE6plvkfAiaGkWLgKIF2MMmdxLQYntLIwX8XrCz2jPKg/w/FJjD3O/tRQbrce/bTrG2XMqRVtsEnSODyikklLXMZAz/2yW4HBaEDLHLF49ouzJvnpWegtTWR/IRyL0v6PsBjI7gxCC12xnggDJfK5z4tBe8G8Ekf3IMVk/KEqF1tTSRxO0AaM3YxRK6k37AbRDLImJTVcbFL7kZinhXlNAlcXdKNl3xxhdYLNFa8U/pnA+RURyrKqLB5tZC7DcyrCDgvGEcrbD3bPGi+u/1jmitfAnhqwNoeUuiSqjw1FFLIt16oCeUFAJcFyWFBS5x0dqPa2TGNyL3TFieW4Tz1uHpY/VWgpwkSoEV2JrtlREklu9snsytfAPjikI3ZZ9eOnar8t+cyYncHAeeC6N8A3gCzd1rxHcS4r1hnrPYmR4yUUmibSUztBEwIIbTXlqVrU0L5gsvcQURRieW0qJW2bnz39B8jQkqzTAPAFgA1gYQIv7bd0o1JUtNM3BaK7S+E8LSdMb4x8F9D+kCiF6uF3FJiXgMgEYgW9JRdql2CQ4eEdqHyChhfipbcG2cddrpkgBa4I0OKmbSu9pVguTzYO8SQ/AO7znioD5N/OqWKcQ8TcE/Y50GE7qJSmtN7CikbZyb8/tKqaYfVZyJusSUG3eno2Sf9SCe722ez6z4TUGBftyVlUJ894rd2+En9oXVc8riSY6A+MGUDxwTETUW9YUdomO00J2gqbwCosR/uDbtYnI05C98OzISxYjcuqNcIygN8aQihAxB0rZPO/jGuWKVg6gLQmWm/03P0Ocy99XjY2mH1VLLT3MSEO0IUvikEX9OTbvxnXELV4IaVlFbI7QPz5BAvHRSCHinWKE9g6vUnqjE4zpphJaVa5i4CropSzIwDEFjpKKX1ftkran3U/PCQ2mlOwCzjcKpg6hL4DTh2R+gdBq10ZO0G1Nf3RBkbd37IpFTLXARgLQE/so+n1qjnnJwCiJVxrhj9jHybiVqcY8lNffewuAx8cEMiVZNvu6gk6HUCantlE/4B4D47Y7QrndvSJGQzcXQ49rPrLRaixak5sAlTlzjV8qqeFIPUgvkiAbPLlTPot07P0ayXer10TIwVBHhttFiDgK5iz7FrolL3sNepZCG3lJkf8xVMeM7OGAN64oplXkWgZgKnYzFj/o5d1/hILGwZqCpPaZb5eQBe8Rx06mbgoCPVKai//l0/g5R82yxKkBeWMyMMNm3d6H+SiM2vclKtrZo2MbEHoMv9vSRutDMNv4iyQLFycwR4bUiv4Ye2bjwYJcdvvjJSe3acqxV7PENuDQi75+2MsSCWIV7/XRb/SiDv6XPA8PrujoLJmGkcjCWrqvBjJrVr2yJIfpjIv+fHwCGHUlOQmXcojiHJQm4dM9/lh2Xgbkc3Ho8jpypPqbs7plHJWQvQjHAl/HVbb/x5HEPUrtyXSfKrARfHvfaB0nQsGHjxiyP3NCY4/HabH9dKaAFwGxDxEEDUZmey82Mpbm4WWv0XXwEwfRCeINnlmU59455YsgJAg0l5vezEe3dLpof6imqYBsK/7ASmx41/1cotJnh3pMGDGJuLdcY3h0LIWzuAVKqQu1qCHwVjSgzBDKItdoKXxSWE/NbzVZHa59dRYuCwk8JkzDAOx9AdCuklVWNt+5QLd03ZDTNs4V4JsbSkN7xciQHJgrmJ2f++xaAljp7dWIm8ICx5DUbput7rQehLhieAgXch6AHnyj9vBjUH9s39lKndbV8hSbsDHup+Z+df+yqaK5MZSEormFvAuCV8h6hEhPVFUr+H9HXvV7ybra0JbWLi9wEF22VBMyq53kfpJ81q85QFNdw971hE8h47M/+1KGFB85q17WZA/tS/pgT/cqVafaRZuScBHtDhPCXM61/TcltviFV7wgxQO83VRPh2Oab3nChOfg7pWyr3fohCQn77+VrC6eyX8bwb6Cq751hLtUf/cn1BJ3omut3JZL3e3rCOUyn9VG2ayxDjE4qTP3nFgv3DqqX3Xcn1MuUlfXIJz9tp46ag31QMRX9lB9qhaMrnarWEbGIWkyDoVac0bmvQT9uGoqb3wxmqgNG4/iNSo9Er/mXig2JpBXb+D/IhGoNB6t74AAAAAElFTkSuQmCC&quot;</span><br>    &#125;,<br>    <span class="hljs-title class_">Lrnc</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e</span>) &#123;&#125;,<br>    <span class="hljs-title class_">NHnr</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">t, e, s</span>) &#123;<br>            <span class="hljs-string">&quot;use strict&quot;</span>;<br>            <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(e, <span class="hljs-string">&quot;__esModule&quot;</span>, &#123;<br>                    <span class="hljs-attr">value</span>: !<span class="hljs-number">0</span><br>            &#125;);<br>            <span class="hljs-keyword">var</span> a = <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;7+uW&quot;</span>),<br>            i = &#123;<br>                    <span class="hljs-attr">render</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                            <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$createElement</span>,<br>                            e = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_self</span>.<span class="hljs-property">_c</span> || t;<br>                            <span class="hljs-keyword">return</span> <span class="hljs-title function_">e</span>(<span class="hljs-string">&quot;div&quot;</span>, &#123;<br>                                    <span class="hljs-attr">staticClass</span>: <span class="hljs-string">&quot;app&quot;</span>,<br>                                    <span class="hljs-attr">attrs</span>: &#123;<br>                                            <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;app&quot;</span><br>                                    &#125;<br>                            &#125;,<br>                            [<span class="hljs-title function_">e</span>(<span class="hljs-string">&quot;router-view&quot;</span>)], <span class="hljs-number">1</span>)<br>                    &#125;,<br>                    <span class="hljs-attr">staticRenderFns</span>: []<br>            &#125;;<br>            <span class="hljs-keyword">var</span> n = <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;VU/8&quot;</span>)(&#123;<br>                    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;App&quot;</span>,<br>                    <span class="hljs-attr">data</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                            <span class="hljs-keyword">return</span> &#123;<br>                                    <span class="hljs-attr">aaa</span>: <span class="hljs-number">111</span><br>                            &#125;<br>                    &#125;,<br>                    <span class="hljs-attr">created</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;&#125;,<br>                    <span class="hljs-attr">methods</span>: &#123;&#125;<br>            &#125;,<br>            i, !<span class="hljs-number">1</span>,<br>            <span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) &#123;<br>                    <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;rueH&quot;</span>)<br>            &#125;,<br>            <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>).<span class="hljs-property">exports</span>,<br>            r = <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;/ocq&quot;</span>),<br>            o = (<span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;Yq4J&quot;</span>), <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;+BTi&quot;</span>), <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;qubY&quot;</span>)),<br>            l = s.<span class="hljs-title function_">n</span>(o),<br>            c = <span class="hljs-keyword">new</span> a.<span class="hljs-property">default</span>,<br>            h = (<span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;I4nB&quot;</span>), <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;STLj&quot;</span>)),<br>            u = s.<span class="hljs-title function_">n</span>(h),<br>            d = (<span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;cDSy&quot;</span>), <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;e0Bm&quot;</span>)),<br>            f = s.<span class="hljs-title function_">n</span>(d),<br>            p = <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;//Fk&quot;</span>),<br>            v = s.<span class="hljs-title function_">n</span>(p),<br>            m = <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;mtWM&quot;</span>),<br>            g = s.<span class="hljs-title function_">n</span>(m),<br>            b = <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;Zrlr&quot;</span>),<br>            w = s.<span class="hljs-title function_">n</span>(b),<br>            S = <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;wxAW&quot;</span>),<br>            C = s.<span class="hljs-title function_">n</span>(S),<br>            x = <span class="hljs-title function_">s</span>(<span class="hljs-string">&quot;NC6I&quot;</span>),<br>            y = s.<span class="hljs-title function_">n</span>(x),<br>            A = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                    <span class="hljs-keyword">function</span> <span class="hljs-title function_">t</span>(<span class="hljs-params">e, s, a</span>) &#123;<br>                            <span class="hljs-title function_">w</span>()(<span class="hljs-variable language_">this</span>, t),<br>                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">bicode</span> = e,<br>                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">password</span> = s,<br>                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeDifference</span> = a<br>                    &#125;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-title function_">C</span>()(t, [&#123;<br>                            <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;guid&quot;</span>,<br>                            <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = [], e = <span class="hljs-number">0</span>; e &lt; <span class="hljs-number">36</span>; e++) t[e] = <span class="hljs-string">&quot;0123456789abcdef&quot;</span>.<span class="hljs-title function_">substr</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-number">16</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()), <span class="hljs-number">1</span>);<br>                                    <span class="hljs-keyword">return</span> t[<span class="hljs-number">14</span>] = <span class="hljs-string">&quot;4&quot;</span>,<br>                                    t[<span class="hljs-number">19</span>] = <span class="hljs-string">&quot;0123456789abcdef&quot;</span>.<span class="hljs-title function_">substr</span>(<span class="hljs-number">3</span> &amp; t[<span class="hljs-number">19</span>] | <span class="hljs-number">8</span>, <span class="hljs-number">1</span>),<br>                                    t[<span class="hljs-number">8</span>] = t[<span class="hljs-number">13</span>] = t[<span class="hljs-number">18</span>] = t[<span class="hljs-number">23</span>] = <span class="hljs-string">&quot;-&quot;</span>,<br>                                    t.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&quot;</span>)<br>                            &#125;<br>                    &#125;,<br>                    &#123;<br>                            <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;getDateString&quot;</span>,<br>                            <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                                    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>).<span class="hljs-title function_">getTime</span>()<br>                            &#125;<br>                    &#125;,<br>                    &#123;<br>                            <span class="hljs-attr">key</span>: <span class="hljs-string">&quot;make&quot;</span>,<br>                            <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                                    <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">guid</span>(),<br>                                    e = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getDateString</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeDifference</span>,<br>                                    s = t + e + <span class="hljs-variable language_">this</span>.<span class="hljs-property">password</span>,<br>                                    a = <span class="hljs-title function_">y</span>()(s);<br>                                    <span class="hljs-keyword">return</span> &#123;<br>                                            <span class="hljs-attr">authguid</span>: t,<br>                                            <span class="hljs-attr">authtimestamp</span>: e,<br>                                            <span class="hljs-attr">authbizcode</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">bicode</span>,<br>                                            <span class="hljs-attr">authtokenOrigin</span>: s,<br>                                            <span class="hljs-attr">authtoken</span>: a<br>                                    &#125;<br>                            &#125;<br>                    &#125;]),<br>                    t<br>            &#125; (),<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>HTTP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>安全教育平台完成脚本</title>
    <link href="/40e0e0a573ca/"/>
    <url>/40e0e0a573ca/</url>
    
    <content type="html"><![CDATA[<h1>LOGIN</h1><p>提交方式：GET</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-link">https://fujianlogin.xueanquan.com/LoginHandler.ashx?&amp;userName=</span>[<span class="hljs-string">明文账号</span>]&amp;password=[明文密码]&amp;checkcode=&amp;type=login&amp;loginType=1&amp;r=0.8298471421981155&amp;_=[时间戳]<br></code></pre></td></tr></table></figure><h1>安全教育平台一键完成</h1><p>很简单的抓包练习</p><p>每个月学校都有这个破作业</p><p>没有人想做又要有指标</p><p>一个一个帮同学点过去实在是麻烦</p><p>还好这个安全教育平台抓包难度没有智学网难，基本都是明文，post都用不上</p><p>需要在根目录附带一个accounts.txt，里面每行一个账号</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> re<br>file_object = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;accounts.txt&#x27;</span>)<br>line = file_object.readline()<br>num=<span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;开始自动化任务&quot;</span>)<br><span class="hljs-keyword">while</span>(line):<br>    num+=<span class="hljs-number">1</span><br>    tot=<span class="hljs-number">1</span><br>    <span class="hljs-comment"># 登录账号</span><br>    t=time.time()<br>    timestamp=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">round</span>(t*<span class="hljs-number">1000</span>))<br>    url_login=<span class="hljs-string">&#x27;https://fujianlogin.xueanquan.com/LoginHandler.ashx?jsoncallback=&amp;userName=&#x27;</span>+line.strip()+<span class="hljs-string">&#x27;&amp;password=123456&amp;checkcode=&amp;type=login&amp;loginType=1&amp;r=&amp;_=&#x27;</span>+<span class="hljs-built_in">str</span>(timestamp)<br>    r_login=requests.get(url_login)<br>    result=re.findall(<span class="hljs-string">&quot;TrueName:&#x27;(.+?)&#x27;&quot;</span>, r_login.text)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(result)&gt;<span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;序号:&#x27;</span>+<span class="hljs-built_in">str</span>(num)+<span class="hljs-string">&#x27;   账号:&#x27;</span>+line.strip()+<span class="hljs-string">&#x27;   姓名:&#x27;</span>+result[<span class="hljs-number">0</span>])<br>        cookies=r_login.cookies<br>        <span class="hljs-comment"># 完成作业</span><br>        <span class="hljs-keyword">while</span> tot&lt;=<span class="hljs-number">2</span>:<br>            url_ac=<span class="hljs-string">&#x27;https://fuzhou.xueanquan.com/WebApi/Holiday/FinishWork?jsoncallback=&amp;r=&amp;sportYear=2019&amp;semester=1&amp;workStep=&#x27;</span>+<span class="hljs-built_in">str</span>(tot)+<span class="hljs-string">&#x27;&amp;_=&#x27;</span>+<span class="hljs-built_in">str</span>(timestamp)<br>            r_ac=requests.get(url_ac,cookies=cookies)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[&#x27;</span>+<span class="hljs-built_in">str</span>(tot)+<span class="hljs-string">&#x27;]&#x27;</span>+r_ac.text)<br>            tot+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>: <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;账号:&quot;</span>+line+<span class="hljs-string">&quot;登录失败&quot;</span>)<br>    line=file_object.readline()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>HTTP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/360da5c1aff2/"/>
    <url>/360da5c1aff2/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start">Quick Start</h2><h3 id="Create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>未分类</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
